канальный уровень (иногда его также называют уровнем передачи данных)

**Канальный уровень  отвечает за** надежную передачу данных между непосредственно связанными устройствами. Основная функция канального уровня заключается в обеспечении корректности передачи битов, что включает в себя:
1. Управление доступом к среде передачи:
	 Канальный уровень определяет, как устройства получают доступ к физическому каналу и как они могут передавать данные, чтобы избежать коллизий.
2. Обнаружение и коррекция ошибок: 
	В процессе передачи данных могут возникать ошибки.
    Канальный уровень использует различные методы для обнаружения (например, контрольные суммы) и коррекции ошибок, чтобы гарантировать, что данные доходят до получателя без искажений.
3. Упорядоченность передачи: 
	Канальный уровень обеспечивает, чтобы биты передавались и принимались в правильном порядке, что критично для корректной интерпретации данных на уровне выше.
4. Контроль потока: 
	 Это необходимо для управления скоростью передачи данных между отправителем и получателем, чтобы избежать перегрузки.

Так же задача канального уровня заключается в предоставлении служб сетевому. На сетевом уровне отправителя находится некая сущность (назовем ее процессом), которая передает пакеты на канальный уровень для их дальнейшей отправки по назначению. Канальный уровень должен отправить данные адресату так, чтобы они достигли его сетевого уровня.  Сетевой уровень не может распознать потерю или дублирование пакета, поэтому канальный уровень должен гарантировать надёжность.


канальный уровень берет пакеты, полученные с сетевого уровня, и вставляет их в специальные **фреймы (frames)**, также называемые кадрами, для передачи. В каждом фрейме содержатся поля
	Header (Заголовок),
	Payload (Пользовательские данные)
	Trailer (Трейлер).

**Управление фреймами — это основная задача канального уровня.**

Канальный уровень может предоставлять [[Службы предоставляющие канальный уровень|различные службы]]. Их набор может отличаться в разных протоколах. Как правило, встречаются следующие варианты
	1. Служба без подтверждений и без установки соединения.
	2. Служба с подтверждениями и без установки соединения.
	3. Служба с подтверждениями, ориентированная на установление соединения.

****
# Формирование фрейма

Обычно канальный уровень разделяет поток битов на отдельные фреймы и вычисляет для каждого из них короткий маркер, называемый **контрольной суммой**. 
	Контрольная сумма добавляется во фрейм перед тем, как он пересылается дальше. Когда целевое устройство получает фрейм, контрольная сумма вычисляется заново на его основе. Если она отличается от содержащейся во фрейме, то канальный уровень понимает, что при передаче произошла ошибка, и принимает меры (например, игнорирует испорченный фрейм и посылает отправляющему устройству сообщение об ошибке).

- [[Формирование фрейма#Разбиение потока битов на отдельные фреймы|Разбиение потока битов на отдельные фреймы]]

****
# ОБРАБОТКА ОШИБОК

Как гарантировать сетевому уровню принимающего устройства доставку всех фреймов и при этом расположить их в правильном порядке.

**Для надежной доставки отправитель получает информацию о статусе фреймов**. Получатель отправляет управляющие фреймы с позитивными (успешно получен) или негативными (нужно повторить) сообщениями. 

**Если фрейм теряется, используются таймеры канального уровня.** После отправки фрейма включается таймер на время, необходимое для получения и подтверждения. Если подтверждение не приходит вовремя, отправитель повторяет отправку фрейма. 

**Чтобы избежать дублирования фреймов на целевом устройстве, фреймы должны быть пронумерованы.**

****
# УПРАВЛЕНИЕ ПОТОКАМИ

Что делать с отправителем, постоянно передающим фреймы быстрее, чем получатель способен их получать.

**В настоящее время применяются два подхода.** 

Первый это **правление потоком с обратной связью (feedback-based flow control):** 
	Получатель отсылает отправителю сообщение, в котором разрешает продолжить передачу или просто сообщает о своем состоянии.
		Управление потоком с обратной связью осуществляется на канальном уровне, но чаще — на более высоких. При этом оборудование канального уровня работает достаточно быстро, чтобы информация не терялась. **Канальный уровень не отвечает за переполнение, эта проблема решается на более высоких уровнях.** Существуют различные схемы управления потоком с обратной связью, но большинство из них использует один и тот же принцип. Протокол содержит четко заданные правила, определяющие, когда отправитель может отослать следующий фрейм. Эти правила часто запрещают отправку фрейма до тех пор, пока получатель не даст разрешения, явно или неявно. Например, при установке соединения получатель может сказать: **«Сейчас вы можете отправить мне n фреймов, но не посылайте следующие фреймы, пока я не попрошу вас продолжить».**

Второй подход, **управлении потоком с ограничением (rate-based flow control)**, 
	 в протоколе встраивается механизм, ограничивающий скорость, с которой отправитель может передавать данные. Обратная связь с получателем отсутствует. **данный подход используется исключительно на транспортном уровне**

****

# Обнаружение и коррекция ошибок

В некоторых, например в оптоволоконных каналах телекоммуникационных сетей, вероятность ошибки крайне низкая, поэтому потеря данных происходит редко.

Но количество ошибок в беспроводных или старых локальных сетях в десятки раз больше, и они даже считаются нормой. Для того чтобы полностью исключить их, потребуются слишком большие расходы с точки зрения производительности.
Поэтому нам необходимо изучить методы их обнаружения и устранения.

Разработчики сетей создали **две основные стратегии для борьбы с ошибками**, основанные на добавлении к передаваемым данным некоторой избыточной информации. 
	В одном случае с ее помощью принимающая сторона может определить, какие данные должны были прийти, 
	в другом — это всего лишь оповещение об ошибке (без указания ее типа), после которого получатель запрашивает повторную передачу.
	
	Первая стратегия  корректирующие коды (error-correcting codes).
    Использование корректирующего кода часто называют упреждающей коррекцией 
    ошибок (Forward Error Correction, FEC). 
	вторая стратегия  коды для обнаружения ошибок (error-detecting codes).

В высоконадежных (например, оптоволоконных) каналах дешевле использовать код для обнаружения ошибок и просто заново передавать поврежденные блоки. А беспроводные соединения, в которых возникает множество ошибок, чаще используют избыточность информации, позволяющей определить, какие данные должны были прийти.

#### [[Обнаружение и коррекция ошибок#**КОРРЕКТИРУЮЩИЕ КОДА**|КОРРЕКТИРУЮЩИЕ КОДА]]
Коды обнаружения ошибок применяются на канальном, сетевом и транспортном уровнях.
    1. [[Обнаружение и коррекция ошибок#1. Коды Хэмминга|Коды Хэмминга]]
	2. [[Обнаружение и коррекция ошибок#2. Двоичные сверточные коды|Двоичные сверточные коды]]
	3. [[Обнаружение и коррекция ошибок#3. Коды Рида — Соломона|Коды Рида — Соломона]]
	4. [[Обнаружение и коррекция ошибок#4. Коды с малой плотностью проверок на четность (LDPC)|Коды с малой плотностью проверок на четность]]


#### [[Обнаружение и коррекция ошибок#**КОДЫ ДЛЯ ОБНАРУЖЕНИЯ ОШИБОК**|КОДЫ ДЛЯ ОБНАРУЖЕНИЯ ОШИБОК]]
Три кода для обнаружения ошибок. Все они относятся к линейным систематическим блочным кодам:
	1. [[Обнаружение и коррекция ошибок#1. Код с проверкой на четность|Код с проверкой на четность]]
	2. [[Обнаружение и коррекция ошибок#2. Код с контрольными суммами|Код с контрольными суммами]]
	3. [[Обнаружение и коррекция ошибок#3. Циклический избыточный код (CRC)|Циклический избыточный код]]


****

# Методы различных протоколов в передачи данных

Получив пакет от сетевого уровня отправителя, канальный уровень формирует из него фрейм, добавляя заголовок и трейлер. Таким образом, фрейм состоит из встроенного пакета, некоторой служебной информации (в заголовке) и контрольной суммы (в трейлере)

#### [[Методы различных протоколов в передачи данных#**СИМПЛЕКСНЫЕ ПРОТОКОЛЫ КАНАЛЬНОГО УРОВНЯ**|СИМПЛЕКСНЫЕ ПРОТОКОЛЫ КАНАЛЬНОГО УРОВНЯ]]
Тип сетевых протоколов, которые обеспечивают одностороннюю передачу данных.
Это значит, что данные могут передаваться только в одном направлении: от отправителя к получателю, без возможности обратной связи.

##### [[Методы различных протоколов в передачи данных#Протокол «Утопия» без управления потоком и без исправления ошибок|Протокол «Утопия»]]
Данные передаются только в одном направлении, а опасений, что где-то может произойти ошибка, даже не возникает.

##### [[Методы различных протоколов в передачи данных#Протокол «Утопия» без управления потоком и без исправления ошибок|Протокол с остановкой и ожиданием]]
Протокол обеспечивает обратную связь от получателя, который отправляет служебное сообщение, разрешающее отправку следующего фрейма.

##### [[Методы различных протоколов в передачи данных#Протокол с добавляем исправление ошибок порядковые номера и протокол ARQ|Протокол с добавляем исправление ошибок ARQ]]
Протокол, в котором отправитель ожидает положительного подтверждения, прежде чем перейти к пересылке следующего фрейма, часто называется 
**PAR** (Positive Acknowledgement with Retransmission — положительное подтверждение с повторной передачей) или
**ARQ** (Automatic Repeat reQuest — автоматический запрос повторной передачи).
#### [[Методы различных протоколов в передачи данных#**ДУПЛЕКСНЫЕ И ПОЛУДУПЛЕКСНЫЕ ПРОТОКОЛЫ КАНАЛЬНОГО УРОВНЯ**|ДУПЛЕКСНЫЕ И ПОЛУДУПЛЕКСНЫЕ ПРОТОКОЛЫ КАНАЛЬНОГО УРОВНЯ]]
Чаще всего требуется передача в обоих направлениях. Кроме того, канальный уровень работает более эффективно, если по нему можно отправлять сразу несколько фреймов, не дожидаясь, пока придет подтверждение.

##### [[Методы различных протоколов в передачи данных#Двунаправленная передача данных вложенное подтверждение (piggybacking)|Двунаправленная передача данных вложенное подтверждение]]
Вложенное подтверждение это когда получатель откладывает отправку фрейма подтверждения на подтверждения в поле Kind в заголовке фрейма следующего пакета.
##### [[Методы различных протоколов в передачи данных#Протоколы раздвижного окна (sliding window protocols)|Протоколы раздвижного окна (sliding window protocols)]]
Это методы управления потоком данных в сетевых протоколах, которые позволяют отправителю и получателю обмениваться несколькими пакетами данных, не дожидаясь подтверждения каждого из них.

****
# Канальные протоколы и их роль в обеспечении связи в двухточечных каналах интернета

три наиболее распространенных случая использования протоколов канального уровня в двухточечных каналах интернета (точка-точка).
**Оптоволоконный канал SONET**
	 Передача пакетов по оптоволоконным каналам SONET (Synchronous Optical Networking) используется для соединения маршрутизаторов, расположенных в разных точках сети провайдера. Эти каналы обеспечивают высокую скорость передачи данных и надежность.
**Каналы ADSL** 
	Использование каналов ADSL (Asymmetric Digital Subscriber Line) в пределах локального абонентского шлейфа телефонной сети. Это позволяет абонентам получать доступ к интернету через существующие телефонные линии.
**Каналы DOCSIS** 
	Применение каналов DOCSIS (Data Over Cable Service Interface Specification) в локальных шлейфах кабельной сети. С их помощью миллионы пользователей и компаний подключаются к интернету, обеспечивая высокую скорость и стабильность соединения.



#### [[Канальные протоколы и их роль в обеспечении связи в двухточечных каналах интернета#**ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ SONET**|ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ SONET]]

SONET — это протокол физического уровня, наиболее часто используемый в оптоволоконных каналах, которые составляют магистраль различных коммуникационных сетей, включая телефонную. SONET обеспечивает строго определенную скорость передачи данных (например, 2,4 Гбит/с в канале OC-48). Поток битов организован в виде пакетов фиксированного размера, которые посылаются каждые 125 мкс, независимо от наличия в них пользовательских данных.
Чтобы передавать пакеты по таким каналам, **необходим механизм формирования фреймов, способный отличать пакеты от непрерывного потока битов**, в котором они передаются. Для этого на IP-маршрутизаторах работает **протокол PPP.**

#### [[Канальные протоколы и их роль в обеспечении связи в двухточечных каналах интернета#**ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ ADSL**|ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ ADSL]]

 ADSL (Asymmetric Digital Subscriber Line — асимметричная цифровая абонентская линия) соединяет миллионы домашних пользователей с интернетом на скоростях, равных нескольким мегабитам в секунду. 
	 Для этого используются те же телефонные провода, по которым предоставляются услуги традиционной телефонии. **на стороне пользователя устанавливается устройство под названием DSL-модем**. Он отправляет биты по абонентскому шлейфу, адресуя их DSLAM (DSL Access Multiplexer — мультиплексор доступа DSL), установленному в местном офисе телефонной компании.

В разных сетях применяются различные протоколы, пример популярного сценария: 
	•  Домашний компьютер пользователя посылает IP-пакеты DSL-модему, используя канальный уровень, например сеть Ethernet.
    • Затем DSL-модем отправляет IP-пакеты по абонентскому шлейфу на устройство DSLAM с помощью протоколов.
    • На стороне DSLAM или подключенного к нему маршрутизатора (в зависимости от реализации) IP-пакеты извлекаются, поступают в сеть провайдера и достигают точки назначения в интернете.


#### [[Канальные протоколы и их роль в обеспечении связи в двухточечных каналах интернета#**ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ DOCSIS**|ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ DOCSIS]]

стандарт передачи данных по сетям кабельного телевидения по коаксиальному кабелю (Data Over Cable Service Interface Specification, DOCSIS) **подразумевает наличие двух компонентов — физического уровня (PHY) и уровня управления доступом к среде (Media Access Control, MAC)**.

DOCSIS находится выше физического уровня и берет на себя решение таких задач сетевого уровня, как распределение пропускной способности для восходящего и нисходящего потока (управление потоком), формирование фреймов и исправление ошибок.

****
# РЕЗЮМЕ

Задача канального уровня — преобразование необработанного потока битов, поступающего с физического уровня, в поток фреймов, которые могут использоваться сетевым уровнем. Канальный уровень может представлять этот поток с различной степенью надежности, начиная от служб без установки соединения и без подтверждения и заканчивая стабильными службами, ориентированными на установление соединения.

Для формирования фреймов используются разнообразные методы, включая подсчет байтов, байт-стаффинг и бит-стаффинг. Протоколы канального уровня могут обеспечить контроль ошибок для обнаружения и исправления поврежденных и повторной передачи потерянных фреймов. Во избежание перегрузки медленного приемника быстрым отправителем применяется управление потоком.

Популярный механизм «раздвижных окон» — простой способ объединения контроля ошибок и управления потоком. Для окна размером в один пакет применяется протокол с остановкой и ожиданием.

Коды с обнаружением и исправлением ошибок добавляют к сообщениям избыточную информацию с помощью ряда математических методов. Для исправления ошибок широко применяются сверточные коды и коды Рида — Соломона. Все большую популярность завоевывают коды с малой плотностью проверок на четность.
Применяемые на практике коды с обнаружением ошибок включают циклический контроль избыточности и контрольные суммы. Все эти коды можно применять на канальном, а также на физическом и более высоких уровнях.

# [[Подуровень канального уровня MAC (управление доступом к среде)]]