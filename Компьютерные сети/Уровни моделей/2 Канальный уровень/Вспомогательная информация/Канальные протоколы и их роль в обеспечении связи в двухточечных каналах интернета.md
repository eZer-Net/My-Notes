
три наиболее распространенных случая использования протоколов канального уровня в двухточечных каналах интернета (точка-точка).
**Оптоволоконный канал SONET**
	 Передача пакетов по оптоволоконным каналам SONET (Synchronous Optical Networking) используется для соединения маршрутизаторов, расположенных в разных точках сети провайдера. Эти каналы обеспечивают высокую скорость передачи данных и надежность.
**Каналы ADSL** 
	Использование каналов ADSL (Asymmetric Digital Subscriber Line) в пределах локального абонентского шлейфа телефонной сети. Это позволяет абонентам получать доступ к интернету через существующие телефонные линии.
**Каналы DOCSIS** 
	Применение каналов DOCSIS (Data Over Cable Service Interface Specification) в локальных шлейфах кабельной сети. С их помощью миллионы пользователей и компаний подключаются к интернету, обеспечивая высокую скорость и стабильность соединения.


#### **ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ SONET**

SONET — это протокол физического уровня, наиболее часто используемый в оптоволоконных каналах, которые составляют магистраль различных коммуникационных сетей, включая телефонную. SONET обеспечивает строго определенную скорость передачи данных (например, 2,4 Гбит/с в канале OC-48). Поток битов организован в виде пакетов фиксированного размера, которые посылаются каждые 125 мкс, независимо от наличия в них пользовательских данных.

Чтобы передавать пакеты по таким каналам, **необходим механизм формирования фреймов, способный отличать пакеты от непрерывного потока битов**, в котором они передаются. Для этого на IP-маршрутизаторах работает **протокол PPP.**

**PPP — это улучшенный вариант более простого интернет-протокола для последовательной линии SLIP (Serial Line Internet Protocol). Он обнаруживает ошибки, поддерживает несколько протоколов, разрешает аутентификацию и выполняет ряд других задач.** Благодаря широкому набору параметров PPP может использоваться в качестве трех основных методов.
	1. Метод формирования фреймов, однозначно обозначающий конец одного фрейма и начало следующего. Формат фреймов также обеспечивает обнаружение ошибок.
	2. Протокол управления каналом LCP (Link Control Protocol), позволяющий устанавливать соединения, тестировать их, договариваться о параметрах использования и снова отключать их, когда они не нужны.
    3. Способ договориться о параметрах сетевого уровня независимо от используемого в нем протокола. Данный метод состоит в том, что для каждого поддерживаемого сетевого уровня имеется свой сетевой протокол управления NCP (Network Control Protocol).

Чтобы не изобретать велосипед, для PPP был выбран формат фрейма, близкий к формату высокоуровневого протокола управления каналом HDLC (High-level Data Link Control), некогда популярного представителя раннего семейства протоколов.

• PPP (Point-to-Point Protocol) — байт-ориентированный, использует байт-стаффинг.
• HDLC (High-Level Data Link Control) — бит-ориентированный, использует 
бит-стаффинг.

Надежность:
    • HDLC обеспечивает надежную передачу с помощью «раздвижного окна», подтверждений и тайм-аутов.
	• PPP может обеспечить надежность в зашумленной среде (например, в беспроводных сетях), но на практике это редко используется; чаще применяется ненумерованный режим без подтверждений.

Формат фрейма PPP:
        • Все фреймы начинаются с флагового байта 0x7E.
        • Если 0x7E встречается в Payload, он экранируется байтом 0x7D.
		• Структура фрейма:
			Flag
			Address (11111111)
			Control (по умолчанию 00000011 для ненумерованных фреймов)
			Protocol (определяет тип содержимого)
			Payload (переменной длины, по умолчанию 1500 байт)
			Checksum (по умолчанию 2 байта, может быть 4 байта)

Спецификации:
    • Поле Protocol может быть уменьшено до 1 байта по согласованию через LCP.
    • Контрольная сумма может быть двух- или четырехбайтной (CRC).

#### PPP — это механизм формирования фреймов, работающий со многими протоколами в разных физических средах.

Применяется четырехбайтная контрольная сумма, так как она считается основным способом распознавания ошибок передачи на физическом, канальном и сетевом уровнях. 

**Перед тем как попасть в поток данных SONET, полезная информация протокола PPP скремблируется**. При скремблировании данные складываются по модулю 2 с длинной
псевдослучайной последовательностью. Только после этого они пересылаются получателю. Проблема в том, что потоку данных SONET для успешной синхронизации требуется частая смена значений битов. В колебаниях голосового сигнала это происходит естественным образом, но при пересылке данных пользователь сам выбирает, какую информацию передать. Он может, к примеру, отправить **длинную последовательность нулей и вызвать тем самым проблемы. Благодаря скремблированию вероятность такого развития событий ничтожно мала.**
(На стороне получателя данные декодируются, то есть процесс обратного скремблирования выполняется путем повторного сложения с той же псевдослучайной последовательностью. Это восстанавливает оригинальные данные.)

**Перед тем как передавать фреймы PPP по каналу SONET, необходимо установить и настроить соединение PPP**. 
Этапы, через которые проходит линия связи при ее установлении:
	• Изначально линия в состоянии DEAD (отключена), то есть соединения на физическом уровне не существует. 
	• После создания физического соединения линия переходит в состояние ESTABLISH (установление соединения).
		В этот момент начинаются переговоры о параметрах с помощью протокола LCP. Узлы PPP обмениваются пакетами LCP (они содержатся в поле Payload фрейма PPP). Это необходимо для выбора из перечисленных выше параметров PPP. Инициирующий узел предлагает варианты, а отвечающие узлы либо соглашаются с ними, либо отвергают частично или полностью. Они также могут делать свои предложения.
	• При успешном результате переговоров линия переходит в фазу AUTHENTICATE (аутентификация). 
		  Теперь обе стороны по желанию могут проверить, кем является собеседник. После успешной аутентификации в фазе NETWORK (сеть) происходит обмен пакетами NCP для настройки сетевого уровня.
			NCP сложно описать общими словами, так как каждый из них отличается в зависимости от конкретного протокола сетевого уровня и поддерживает конфигурационные запросы, характерные только для него. Например, для IP наиболее важной задачей является назначение IP-адресов собеседникам на обоих концах линии.
	• Когда линия переходит в фазу OPEN (открыть), можно начинать передачу данных. Именно в этой фазе IP-пакеты пересылаются в PPP-фреймах по линии SONET. 
	• Когда передача данных закончена, линия переходит к фазе TERMINATE (завершить), а затем снова в состояние DEAD (выключено), когда физическое соединение разрывается.



#### **ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ ADSL**

 ADSL (Asymmetric Digital Subscriber Line — асимметричная цифровая абонентская линия) соединяет миллионы домашних пользователей с интернетом на скоростях, равных нескольким мегабитам в секунду. 
	 Для этого используются те же телефонные провода, по которым предоставляются услуги традиционной телефонии. **на стороне пользователя устанавливается устройство под названием DSL-модем**. Он отправляет биты по абонентскому шлейфу, адресуя их DSLAM (DSL Access Multiplexer — мультиплексор доступа DSL), установленному в местном офисе телефонной компании.

В разных сетях применяются различные протоколы, пример популярного сценария: 
	•  Домашний компьютер пользователя посылает IP-пакеты DSL-модему, используя канальный уровень, например сеть Ethernet.
    • Затем DSL-модем отправляет IP-пакеты по абонентскому шлейфу на устройство DSLAM с помощью протоколов.
    • На стороне DSLAM или подключенного к нему маршрутизатора (в зависимости от реализации) IP-пакеты извлекаются, поступают в сеть провайдера и достигают точки назначения в интернете.

Под сетевым уровнем IP, находится PPP. Это тот же самый протокол для передачи пакетов по сетям SONET. Он точно так же устанавливает и настраивает связь для передачи IP-пакетов. Между ADSL и PPP находятся ATM и AAL5.

Протокол асинхронной передачи данных ATM (Asynchronous Transfer Mode) - его активно применяют в некоторых линиях широкополосного доступа, таких как DSL, и особенно в WAN-каналах телефонных сетей. 
	представляет собой канальный уровень, основанный на пересылке ячеек (cells) информации фиксированной длины. «Асинхронная передача» означает, что нет необходимости отправлять ячейки постоянно, как это происходит с битами в синхронных линиях типа SONET. 
	Ячейки пересылаются только тогда, когда имеется готовая к передаче информация. технология, ориентированная на установление соединения. В заголовок каждой ячейки встраивается идентификатор виртуального контура (virtual circuit), и устройства используют этот идентификатор для пересылки ячеек по маршрутам внутри установленных соединений.
	`Длина каждой ячейки составляет 53 байта: 48 байт пользовательских данных плюс 5 байт заголовка. Используя ячейки небольшого размера, ATM гибко разделяет полосу пропускания физического канала между разными пользователями.`

Для пересылки данных по сети ATM необходимо преобразовать их в последовательность ячеек. 
	Преобразование выполняется на уровне адаптации протокола ATM путем сегментации и обратной сборки. Для разных служб, пересылающих различную информацию (от периодических голосовых сэмплов до пакетных данных), были определены несколько уровней адаптации. Основной, используемый для пакетных данных — это уровень адаптации ATM 5 (ATM Adaptation Layer 5, AAL5).
	**`Фрейм AAL5`**:` Роль заголовка в нем исполняет трейлер (AAL5 trailer ), содержащий сведения о длине ( Length ), а также 4-байтный код CRC для обнаружения ошибок. Разумеется, это тот же самый CRC, используемый протоколом PPP и сетями стандарта IEEE 802, такими как Ethernet. Помимо пользовательских данных (AAL5 payload), во фрейме AAL5 есть биты заполнения (Pad). Они дополняют общую длину, чтобы она была кратной 48 байтам. Таким образом, фрейм можно поделить на целое число ячеек. Хранить адреса внутри фрейма не нужно, так как идентификатор виртуального контура, имеющийся в каждой ячейке, не даст ей заблудиться и приведет к нужному получателю.
	`Байты 1 или 2     Переменная длина     От 0 до 47     2           2        4
    `PPP protocol       PPP payload           PAD       Не исп.     Length    CRC`

Как ATM задействует протокол PPP при ADSL-подключении:
	делается с помощью еще одного стандарта, который так и называется — PPP с использованием ATM (PPP over ATM, PPPoA) данный стандарт нельзя назвать протоколом. Скорее это спецификация, описывающая, как одновременно применять протокол PPP и фреймы AAL5.

Пользовательские данные AAL5 содержат только два поля PPP: Protocol и Payload. 
	Поле Protocol сообщает устройству DSLAM на другом конце линии, чем являются эти пользовательские данные: пакетом IP, LCP или другого протокола. Принимающая сторона знает, что ячейки содержат информацию PPP, так как виртуальный контур ATM настраивается соответствующим образом. Для фрейма AAL5 механизмы формирования фрейма PPP не требуются, всю работу выполняют ATM и AAL5. Дополнительно создавать фреймы было бы попросту бессмысленно. Код CRC протокола PPP также не нужен, поскольку AAL5 включает такой же CRC. Механизм выявления ошибок дополняет кодирование физического уровня, применяемое в каналах ADSL (код Рида — Соломона для исправления ошибок и 1-байтный CRC для распознавания оставшихся отклонений, не выявленных другими способами). Это куда более сложный механизм устранения ошибок, чем тот, что применяется при пересылке данных в сетях SONET. Причина проста — линии ADSL гораздо зашумленные.



#### **ПЕРЕДАЧА ПАКЕТОВ ПО КАНАЛАМ DOCSIS**

стандарт передачи данных по сетям кабельного телевидения по коаксиальному кабелю (Data Over Cable Service Interface Specification, DOCSIS) **подразумевает наличие двух компонентов — физического уровня (PHY) и уровня управления доступом к среде (Media Access Control, MAC)**.

DOCSIS находится выше физического уровня и берет на себя решение таких задач сетевого уровня, как распределение пропускной способности для восходящего и нисходящего потока (управление потоком), формирование фреймов и исправление ошибок.

Фрейм DOCSIS содержит разнообразную информацию, включая показатели качества обслуживания и служебные данные о фрагментации или конкатенации фреймов. Однонаправленная последовательность фреймов называется служебным потоком (service flow).

Основные служебные потоки передают управляющие сообщения от головной станции кабельных модемов (Cable Modem Termination System, CMTS), расположенной в офисе оператора кабельной сети, к каждому модему.

Служебный поток снабжается уникальным идентификатором и часто ассоциируется с одним из следующих классов обслуживания: «наилучший из возможных», «опрос» (при котором кабельный модем явным образом запрашивает полосу пропускания) и «предоставление сервиса» (модем передает пакеты данных с гарантированным сроком их получения).

Основным является служебный поток по умолчанию, в котором передаются все фреймы, которые не были отнесены к какому-либо другому сервису. Во многих конфигурациях широкополосного доступа используются только исходящий и входящий служебные потоки по умолчанию — между кабельным модемом
и головной станцией, в которых передается весь пользовательский трафик и все управляющие сообщения.

Сети DOCSIS были изначально разработаны с расчетом на то, что данные будут в основном передаваться во входящем направлении.

Канальный уровень DOCSIS организует передачу в соответствии с профилями модуляции (modulation profiles).