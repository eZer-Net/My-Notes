## Брандмауэры

Брандмауэры (firewalls файрволы) — это современная реализация средневекового принципа обеспечения безопасности. Они напоминают ров, вырытый вокруг замка. Суть конструкции в том, что все входящие и выходящие из замка должны проходить по одному подъемному мосту, где полиция ввода/вывода проверяет их личность. Тот же принцип может применяться и в сетях: у компании может быть несколько LAN, соединенных произвольным образом, но весь внешний трафик должен проходить через электронный «подъемный мост» (межсетевой экран).
![[Pasted image 20250109181311.png]]

Брандмауэр работает как пакетный фильтр (packet filter). Он исследует каждый входящий и исходящий пакет. Пакеты, удовлетворяющие определенным критериям, пропускаются. Не сумевшие пройти проверку пакеты удаляются. 

Критерии фильтрации обычно устанавливаются правилами или таблицами, где перечислены допустимые и блокируемые отправители и получатели, а также стандартные правила, описывающие, что делать с исходящими и входящими пакетами.

#### Демилитаризованная зона (DeMilitarized Zone, DMZ)

Это часть сети компании, которая находится за пределами периметра безопасности. 

###### Как это работает?
1. Размещение сервера: Веб-сервер размещается в DMZ. Это значит, что он доступен для всех пользователей интернета.
2. Брандмауэр: Брандмауэр (или межсетевой экран) контролирует входящий и исходящий трафик. Он может быть настроен так, чтобы разрешать или блокировать определенные соединения.
3. Блокировка входящего трафика: Вы можете настроить брандмауэр так, чтобы блокировать входящий трафик на определенные порты (например, порт 80 для HTTP). Это означает, что злоумышленники не смогут использовать этот порт для атаки на внутренние системы.
4. Разрешение исходящего трафика: Брандмауэр может разрешать соединения между веб-сервером в DMZ и компьютерами в вашей внутренней сети. Это позволяет администраторам управлять веб-сервером и получать необходимую информацию.

#### Структура безопасности брандмауэров

**Типы брандмауэров**

• Простые брандмауэры
  - Основываются на наборе правил для каждого пакета.
  - Задача: блокировать нежелательный трафик, сохраняя полезный.

• Брандмауэры с контролем состояния (Stateful Firewalls)
  - Отслеживание соединений с помощью полей TCP/IP-заголовков.
  - Пример: разрешение пакетов от внешнего сервера только после установления соединения внутренним хостом.

**Брандмауэры шлюза прикладного уровня (Application-Level Gateways)**

• Просмотр содержимого пакетов, а не только TCP-заголовков.
• Позволяют различать типы трафика (например, HTTP для серфинга и обмена файлами).

• Возможности:
  - Создание правил, которые запрещают определенные действия (например, обмен файлами), но разрешают другие (например, доступ к рабочим сайтам).
  - Исследование исходящего трафика для предотвращения утечек данных.

**Брандмауэры нарушают стандартную иерархию протоколов.** Они являются устройствами сетевого уровня, но также контролируют транспортный и прикладной уровни, чтобы фильтровать данные. 

## Обнаружение и предотвращение вторжений

системы обнаружения вторжений ==(Intrusion Detection System, IDS)== служат для обнаружения атак в идеале еще до того, как атаки успеют причинить какой-либо урон. 

###### IDS можно классифицировать по тому, где и как они работают.

- Хостовые системы обнаружения вторжений (Host-based IDS, HIDS) 
	Работают непосредственно на конечной точке (ноутбуке или сервере) и отслеживают поведение программного обеспечения или входящий и исходящий трафик веб-сервера только в пределах данного компьютера.

- Сетевые системы обнаружения вторжений (Network IDS, NIDS)
	Проверяют сетевой трафик некоторой группы компьютеров. Обе эти разновидности систем имеют свои преимущества и недостатки.

###### Методы обнаружения

• Сигнатурный анализ:
  - Сравнение сетевого трафика или событий с известными шаблонами атак (сигнатурами).
  - Эффективен для обнаружения известных угроз, но не может выявлять новые или модифицированные атаки.

• Аномалийный анализ:
  - Определение нормального поведения системы и выявление отклонений от этого поведения.
  - Позволяет обнаруживать новые и неизвестные атаки, но может генерировать ложные срабатывания.

**Проблемой при использовании сетевых IDS является шифрование.** Если сетевые байты уже невозможно дешифровать, то системе IDS очень сложно проверить, являются ли они вредоносными.

#### **Система предотвращения вторжений (Intrusion Prevention System, IPS)**

1. Snort
- Описание: Это одна из самых популярных систем обнаружения и предотвращения вторжений с открытым исходным кодом. Snort может работать как IDS и IPS.
- Особенности: Поддерживает сигнатурный, аномалийный и протокольный анализ. Имеет мощное сообщество и множество доступных правил.

2. Suricata
- Описание: Это еще одна система с открытым исходным кодом, которая может выполнять функции как IDS, так и IPS.
- Особенности: Поддерживает многоядерную обработку, что позволяет эффективно обрабатывать большие объемы трафика. Также поддерживает работу с правилами Snort.

3. Cisco Firepower
- Описание: Это коммерческое решение от Cisco, которое включает в себя функции IPS, а также брандмауэр и возможности для анализа угроз.
- Особенности: Интеграция с другими продуктами Cisco, поддержка анализа поведения и автоматизированных ответов на инциденты.

4. Palo Alto Networks Next-Generation Firewall (NGFW)
- Описание: Это решение сочетает в себе функции брандмауэра следующего поколения с IPS.
- Особенности: Обеспечивает глубокую инспекцию пакетов, анализ приложений и интеграцию с облачными сервисами.

5. McAfee Network Security Platform
- Описание: Коммерческое решение для защиты сети от McAfee, которое включает в себя функции IPS.
- Особенности: Высокая производительность, возможность интеграции с другими продуктами McAfee для комплексной защиты.

6. Fortinet FortiGate
- Описание: Устройства FortiGate предлагают функции IPS в рамках решения для обеспечения безопасности сети.
- Особенности: Высокая производительность, возможность интеграции с другими модулями безопасности Fortinet.

7. IBM QRadar
- Описание: Это решение для управления безопасностью и событиями (SIEM), которое также включает в себя функции IPS.
- Особенности: Обеспечивает анализ данных в реальном времени и автоматизацию реагирования на инциденты.

8. Trend Micro Deep Security
- Описание: Это решение предлагает защиту для физических, виртуальных и облачных сред, включая функции IPS.
- Особенности: Интеграция с другими продуктами Trend Micro для комплексной защиты.

9. Check Point IPS
- Описание: Включает в себя функции IPS в рамках решения Check Point для обеспечения безопасности сети.
- Особенности: Поддерживает анализ трафика на уровне приложений и предотвращение атак в реальном времени.

## WAF (Web Application Firewall)

Файрвол веб-приложений используется как наложенное средство защиты. Это значит, что он располагается перед основным веб-приложением и анализирует входящий и исходящий трафик. В режиме реального времени он принимает решение о предоставлении либо отклонении доступа.

#### Принцип работы

WAF активно использует сигнатурный анализ для фильтрации трафика. Сигнатурный метод основан на сравнении входящего трафика с заранее определённым словарём вредоносного трафика. Если в запросе обнаруживается часть, соответствующая известной сигнатуре вредоносного кода, WAF блокирует этот запрос. Это позволяет защитить веб-приложения от известных угроз.

#### Основные функции WAF

1. **Фильтрация трафика на уровне приложений:**
   • Защита от инъекций, таких как SQL-инъекции и XSS (межсайтовый скриптинг), а также других типов атак на веб-приложения.

2. **Мониторинг и анализ трафика:**
   • Ведение журнала всех запросов с последующим анализом на предмет аномального поведения и попыток эксплуатации уязвимостей.

3. **Защита от известных и неизвестных атак:**
   • Возможность обновления базы сигнатур для защиты от новых угроз. Некоторые WAF используют методы машинного обучения для выявления аномалий и неизвестных атак.

4. **Управление доступом и авторизация:**
   • Предоставление возможностей для управления доступом на основе ролей пользователей, что позволяет ограничивать доступ к определённым ресурсам.

5. **Шифрование и дешифрование трафика:**
   • Поддержка работы с SSL-соединениями для защиты передаваемых данных.

6. **Модульная структура:**
   • Позволяет разрабатывать и внедрять новые методики защиты, адаптируя WAF под специфические нужды бизнеса или приложения.

#### Основные уровни

1. **Уровень приложения (Application Layer)**
- Описание: Этот уровень соответствует 7-му уровню модели OSI и включает в себя протоколы, такие как HTTP и HTTPS. WAF анализирует HTTP-запросы и ответы, чтобы выявить и блокировать вредоносный трафик.

- Методы защиты:
  • Фильтрация контента: Проверка входящих и исходящих данных на наличие вредоносных скриптов, SQL-инъекций, XSS и других атак.
  • Сигнатурный анализ: Использование базы данных известных угроз для обнаружения и блокировки атак.
  • Аномалия и поведенческий анализ: Выявление аномального поведения пользователей и трафика, что может указывать на попытку атаки.
  • Правила безопасности: Настройка пользовательских правил для фильтрации трафика в зависимости от специфики приложения.

2. **Уровень транспорта (Transport Layer)**

- Описание: Этот уровень соответствует 4-му уровню модели OSI и включает протоколы TCP и UDP. WAF может использоваться для защиты соединений и управления трафиком.

- Методы защиты:
  • SSL/TLS шифрование: Обработка зашифрованного трафика, включая его дешифрование для анализа содержимого, а затем повторное шифрование перед отправкой к конечному пользователю.
  • Управление сессиями: Защита от атак на уровне сессий, таких как захват сессии (Session Hijacking).
  • Контроль доступа: Ограничение доступа на основе IP-адресов или геолокации.

3. **Уровень сети (Network Layer)**

- Описание: Этот уровень соответствует 3-му уровню модели OSI и включает в себя маршрутизацию и адресацию.

- Методы защиты:
  • Защита от DDoS-атак: Фильтрация трафика на основе объема и типа запросов для предотвращения перегрузки сервера.
  • IP-блокировка и белые/черные списки: Блокировка или разрешение доступа на основе IP-адресов.

**Архитектура WAF**

WAF может быть развернут в различных архитектурных конфигурациях:

1. Программные решения: Устанавливаются на сервере или в облаке, предоставляя гибкость в настройках и правилах. Пример — ModSecurity.

2. Аппаратные решения: Специализированные устройства, которые устанавливаются в центре обработки данных для защиты всех веб-приложений.

3. Облачные WAF: Предоставляются как услуга (WAF as a Service), что позволяет легко масштабировать защиту без необходимости управления физическим оборудованием. Примеры — AWS WAF, Cloudflare WAF.

#### Примеры WAF

1. **AWS WAF:**
   • Облачный WAF от Amazon Web Services, который позволяет пользователям создавать правила для фильтрации HTTP(S) трафика на основе IP-адресов, URL-адресов и других параметров.

2. **Cloudflare WAF:**
   • Интегрированный WAF, который защищает веб-приложения, используя автоматические обновления сигнатур и адаптивные правила безопасности.

3. **Imperva Incapsula:**
   • Платный сервис, который предлагает защиту от DDoS-атак, а также включает в себя функции мониторинга и анализа трафика.

4. **F5 Advanced WAF:**
   • Решение для защиты приложений с расширенными возможностями анализа и управления трафиком, включая защиту от бот-атак и угроз на уровне приложений.

5. **ModSecurity:**
   • Открытый WAF, который может быть интегрирован с различными веб-серверами и предоставляет мощные возможности настройки правил безопасности.

## NGWAF (Next Generation firewall)

Это межсетевой экран нового поколения, сочетающий в себе функции IPS/IDS, Глубокая фильтрация пакетов, Фильтрацию на прикладном уровне пакетов, Proxy сервер, Защиту почты и антивирус

## DLP (Data Leak Prevention)

Это технология предотвращения утечек конфиденциальной информации компании во внешний мир. 

Принцип контроля основан на контроле всех информационных каналов, DLP контролирует в первую очередь электронную почту, месенджеры.

Основной недостаток трудность её внедрения 

