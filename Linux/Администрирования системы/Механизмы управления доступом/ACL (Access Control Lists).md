### **Что это?**

- **ACL** (Access Control Lists) — это механизм управления доступом к файлам и каталогам, который позволяет задавать ==более гибкие права доступа, чем традиционные Unix-права== (rwx для владельца, группы и остальных). ACL позволяет **назначать права доступа для конкретных пользователей и групп**, что делает управление доступом более детализированным.

- ACL используется в файловых системах, таких как ext4, XFS, Btrfs и других, которые поддерживают этот механизм.


### **Как работает ACL?**

- ACL расширяет стандартные права доступа Unix, добавляя возможность назначать права для отдельных пользователей и групп. Каждый файл или каталог может иметь список ACL, который содержит записи (entries) для конкретных пользователей и групп.

- Каждая запись ACL содержит:
    - **Тип записи**: пользователь (user), группа (group), маска (mask) или другие (other).
    - **Идентификатор**: имя пользователя или группы, для которых применяются права.
    - **Права доступа**: набор прав (чтение, запись, выполнение и т.д.).

### **Режимы ACL**

1. **Пользовательские ACL**:
    - Позволяют назначать права доступа для конкретных пользователей, даже если они не являются владельцем файла или членом группы, связанной с файлом.

2. **Групповые ACL**:
    - Позволяют назначать права доступа для конкретных групп.

3. **Маска ACL**:
    - Маска определяет максимальные права, которые могут быть предоставлены через ACL. Она ограничивает права, назначенные через пользовательские и групповые ACL.

4. **Другие ACL**:
    - Права для всех остальных пользователей, которые не указаны в ACL и не являются владельцем файла или членом группы.

### Команды для управления ACL

- **Просмотр ACL**:  
    Чтобы посмотреть ACL для файла или каталога, используется команда `getfacl`:
    `getfacl /path/to/file`

- **Установка ACL**:  
    Для установки ACL используется команда `setfacl`. Например, чтобы дать пользователю `user1` права на чтение и запись файла:
    `setfacl -m u:user1:rw /path/to/file`

- **Удаление ACL**:  
    Чтобы удалить ACL для конкретного пользователя или группы:
    `setfacl -x u:user1 /path/to/file`

- **Рекурсивное применение ACL**:  
    Для применения ACL ко всем файлам и каталогам внутри директории:
    `setfacl -R -m u:user1:rw /path/to/directory`

- **Установка маски ACL**:  
    Маска ACL может быть установлена с помощью:
    `setfacl -m m::r /path/to/file`

### **Как увидеть ACL в системе?**

- **Использование `getfacl`**:  
    Команда `getfacl` позволяет просмотреть ACL для любого файла или каталога. Например:
    `getfacl /etc/passwd`

- **Использование `ls -l`**:  
    Если файл или каталог имеет ACL, в выводе команды `ls -l` будет отображаться знак `+` после прав доступа:
    `ls -l /tmp/testfile`
    
    Вывод:
    `-rw-rw-r--+ 1 root root 0 Oct 10 12:34 /tmp/testfile`

### **Пример работы с ACL**

1. **Создание файла и просмотр стандартных прав**:
    `touch /tmp/testfile`
    `ls -l /tmp/testfile`

2. **Добавление ACL для пользователя `user1`**:
    `setfacl -m u:user1:rw /tmp/testfile`

3. **Просмотр ACL**:
    `getfacl /tmp/testfile`

Вывод может выглядеть так:
```
# file: /tmp/testfile
# owner: root
# group: root
user::rw-
user:user1:rw-
group::r--
mask::rw-
other::r--
```

4. **Удаление ACL для пользователя `user1`**:
    `setfacl -x u:user1 /tmp/testfile`

### **Преимущества ACL**

- **Гибкость**: ACL позволяет назначать права доступа для конкретных пользователей и групп, что невозможно с традиционными Unix-правами.
- **Детализация**: Можно точно настроить права доступа для каждого пользователя или группы.
- **Совместимость**: ACL работает вместе с традиционными правами доступа, что позволяет использовать оба механизма одновременно.

### **Недостатки ACL**

- **Сложность управления**: ACL может усложнить управление правами доступа, особенно в больших системах.
- **Поддержка файловых систем**: Не все файловые системы поддерживают ACL, хотя большинство современных систем (ext4, XFS, Btrfs) поддерживают.

