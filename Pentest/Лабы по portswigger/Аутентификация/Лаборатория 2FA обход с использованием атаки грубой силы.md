
Двухфакторная аутентификация этой лаборатории уязвима для грубой силы. Вы уже получили действительное имя пользователя и пароль, но не имеете доступа к проверке пользователя 2FA. Чтобы решить лабораторию, грубой силой код 2FA и доступ к странице учетной записи Carlos.

Условия жертвы: `carlos:montoya`

##### Примечание
Поскольку код проверки будет сброшен во время атаки, вам может потребоваться повторить эту атаку несколько раз, прежде чем вы добьетесь успеха. Это связано с тем, что новый код может быть номером, которое ваша текущая атака злоумышленников уже предприняла.


## Дано

уязвима для грубой силы в 2FA
учётка жертвы: `carlos:montoya`

## Задача

доступ к странице учетной записи Carlos.

# Решение 

- при входе требует 2Fa код из 4 чисел
- при вводе двух неверных паролей выкидывает из учётки 
- учётка не блокируется и мы можем сразу зайти под учётку и ввести 2FA код

- CSRF токен генерируется каждый раз по пути входа в учётку
- 4 хода до отправки кода 2FA
![[Pasted image 20250130102421.png]]

 
- Заходим в настройки следом в Sessions
![[Pasted image 20250130102845.png]]
указываем на все urls чтоб макрос заходил на учётку указывал пароль а после снова повторял вход и код

- add run a macro 
![[Pasted image 20250130103200.png]]
добавляем 
1. GET /login
2. POST /login
3. GET /login2
![[Pasted image 20250130103452.png]]
- Вход в систему
- Генерация csrf токена

Тестируем macros (Test macro)
![[Pasted image 20250130103609.png]]

- Закидываем в inruder POST /login2

#### Мини итог
- Мы сделали макрос который будет запускаться каждый раз когда будет подбираться код
1. Входим под учётку
2. Вводим код 2FA
3. Заходим под учётку
4. ...

- С одним потоком запускаем атаку
![[Pasted image 20250130133748.png]]
