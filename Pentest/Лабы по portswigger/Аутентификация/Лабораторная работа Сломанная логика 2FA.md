
# Разведка

- При входе в аккаунт мы проходим через:
1. Отправляем логин и пароль
```
POST /login HTTP/1.1
Host: 0a8d00f70450887e82da255800da0009.web-security-academy.net
Cookie: session=WdJdqtZARrdT9lyex8vMKFgLCg5vzv7P
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Origin: https://0a8d00f70450887e82da255800da0009.web-security-academy.net
Referer: https://0a8d00f70450887e82da255800da0009.web-security-academy.net/login
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers
Connection: keep-alive

username=wiener&password=peter
```
2. Получаем куки файлы назначенные для входа в наш аккаунт
```
GET /login2 HTTP/2
Host: 0a8d00f70450887e82da255800da0009.web-security-academy.net
Cookie: session=125GYD0JVuTrYttWAl62nuir4eBPcABw; verify=wiener
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: https://0a8d00f70450887e82da255800da0009.web-security-academy.net/login
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers

```
3. Отправка пароля для "2Fa" аутентификации
```
POST /login2 HTTP/2
Host: 0a8d00f70450887e82da255800da0009.web-security-academy.net
Cookie: session=125GYD0JVuTrYttWAl62nuir4eBPcABw; verify=wiener
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 13
Origin: https://0a8d00f70450887e82da255800da0009.web-security-academy.net
Referer: https://0a8d00f70450887e82da255800da0009.web-security-academy.net/login2
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers

mfa-code=0907
```
4. Получаем доступ к нашему аккаунту
```
GET /my-account?id=wiener HTTP/2
Host: 0a8d00f70450887e82da255800da0009.web-security-academy.net
Cookie: session=exjJhKS6OwlYXJn0ycSAXE4kvk52g3Kk; verify=wiener
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: https://0a8d00f70450887e82da255800da0009.web-security-academy.net/login2
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Priority: u=0, i
Te: trailers
```

- Cookie сессия не привязана к verify и куки возрвращается в ответе при логине

# Атака

1. При изменение запросов и ответов в любой части формировании сессии не увенчались успехом
2. Вариант брута, проверить раз verify не привязан к куки то можно попробовать зайти на 2 часть аутентификации и забрутить все 4-значные числа так как при прошлых проверках данные отправлялись лишь в формате 4-значных чисел
	
	2.1 Зайти под своей учётке 
	2.2 Изменить в GET методе verify=wiener на claros чтоб сформировать код
	2.3 Изменить в POST методе verify=wiener на claros 
	2.4 Через Intruder пробрутить числа вериф

	куки для carlos Kb53kVIljvGt0uT4MdrUDXr0IedV7KgZ
	пароль для carlos 1526
	






