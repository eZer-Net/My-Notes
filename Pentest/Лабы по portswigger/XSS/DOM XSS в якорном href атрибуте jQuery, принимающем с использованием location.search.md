Эта лаборатория содержит уязвимость межсайтового скриптинга на основе DOM на странице обратной связи. Она использует `$`функцию селектора библиотеки jQuery для поиска элемента привязки и изменяет его `href`атрибут, используя данные из `location.search`.

## Дано

библиотека jQuery
селекторная функция

# Задача

сделайте предупреждение о ссылке «обратно» `document.cookie`

# Разведка

![[Pasted image 20250128171312.png]]

- Кнопка редиректит при помощи тега href в котором указан путь /
- `href="/"` - работает от скрипта 
```
<script>
	$(function() {
		$('#backLink').attr("href", (new URLSearchParams(window.location.search)).get('returnPath'));
	});
</scripts>
```
 • jQuery и функция-обертка:

- `$(function() { ... });` — это сокращение для $(document).ready(function() { ... });. Этот код выполняется, когда DOM полностью загружен и готов к манипуляциям.

• Выбор элемента:

- `$('#backLink')` — это селектор jQuery, который выбирает элемент с идентификатором backLink. В лабе это `<a id="backLink" href="/">Назад </a>`.

• Изменение атрибута href:

- `.attr("href", ...)` — это метод jQuery, который изменяет значение атрибута href выбранного элемента.

- `new URLSearchParams(window.location.search)` — создает новый объект URLSearchParams, который позволяет удобно работать с параметрами URL. `window.location.search` содержит часть URL, которая идет после знака вопроса `?`, включая все параметры.

• Получение значения параметра returnPath:

- `.get('returnPath')` — извлекает значение параметра returnPath из объекта URLSearchParams. Если в URL есть параметр returnPath, то его значение будет возвращено; если нет — вернется null.

• Итог:

- В результате выполнения этого скрипта атрибут href элемента с id backLink будет обновлен на значение параметра returnPath, если такой параметр присутствует в URL.

#### Микро вывод

Нету чёткого решения хорошо или плохо структурирован данный код так как 
- В начале пути разработчики кидают всё в 1 файл
- Чутка освоившись им говорят что так делать нельзя и разработчик разделяет данные по файлам: php в php, js в js, html в html...
- Далее разработчик начинает пользоваться фраемворками такими как: Laraval для PHP или Vue.js для JS где есть такое понятие как движки шаблоны которые снова смешивают всё подряд) 


# Атака

формируем js код в строку `?returnPath=javascript:alert(document.cookie)`
![[Pasted image 20250128173727.png]]
