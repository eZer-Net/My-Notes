Эта лаборатория содержит отраженную уязвимость межсайтового скриптинга в функции отслеживания поисковых запросов. Отражение происходит внутри строки JavaScript с экранированными одинарными кавычками и обратными косыми чертами.

Чтобы решить эту лабораторную работу, выполните атаку с использованием межсайтового скриптинга, которая вырывается из строки JavaScript и вызывает `alert`функцию.

## Дано

- Уязвимость отражённая.
- Находится в функции отслеживания поисковых запросов.
- Отражение происходит внутри строки JavaScript с экранированными одинарными кавычками и обратными косыми чертами

## Задача

Вызывать `alert`функцию.


# Решение

В ответе на поиск нашли
```
<script>

	var searchTerms = 'search';
    
    document.write('<img src="/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'">');

</script>
```

`encodeURIComponent` - метод, кодирующий компонент универсального идентификатора ресурса (URI) заменой каждой определённой последовательности символов одной, двумя, тремя или четырьмя последовательностями символов, представленных в кодировке UTF-8 (будет только 4 управляющих последовательности для символов, состоящих из 2 "суррогатных" символов). [ссылка на чтиво](https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)

Полезная нагрузка
```
</script><script>alert(1)</script>
```


## Пояснение

### Почему не вызвалась ошибка

1. **Поведение браузера**:    
    - Браузеры стараются быть "терпимыми" к ошибкам в HTML и JavaScript. Если они встречают что-то, что не соответствует стандартам, они пытаются интерпретировать это наилучшим образом.
    
    - В данном случае, браузер видит `</script>` и считает, что это конец текущего тега `<script>`, даже если кавычка не закрыта.
    
2. **Игнорирование оставшегося кода**:
    
    - После выполнения инъекции, оставшаяся часть кода (`';`) просто игнорируется, так как она находится вне тега `<script>`.

### Как это выглядит в браузере

После подстановки инъекции, браузер видит следующий код:

```
<script>
  var searchTerms = 'search</script><script>alert(1)</script>';
  document.write('<img src="/resources/images/tracker.gif?searchTerms=' + encodeURIComponent(searchTerms) + '">');
</script>

```
Браузер интерпретирует это так:
1. Завершает первый тег `<script>` на `</script>`.
2. Выполняет новый тег `<script>alert(1)</script>`.
3. Игнорирует оставшуюся часть кода (`';`), так как она находится вне тега `<script>`.
