Эта лабораторная работа содержит отраженную уязвимость XSS в функциональности поиска, но использует брандмауэр веб-приложений (WAF) для защиты от распространенных векторов XSS.

Для решения лабораторной работы выполните атаку с использованием межсайтового скриптинга, которая обойдет WAF и вызовет `print()`функцию.

## Дано

Отраженная уязвимость XSS в функциональности поиска
Использует брандмауэр веб-приложений (WAF) для защиты от распространенных векторов XSS.

## Задача

вызвать `print()`функцию

# Решение

#### Первый этап 

Нашли уязвимость а точнее точку входа
![[Pasted image 20250211102837.png]]

При попытке внедрить script тег ответ `"Tag is not allowed"` работает брендмауэр
- попробуем различные кодировки
- при двойной кодировки экранирует символом ' и данные не преобразовываются

#### Микро итог 

Различные кодировки и обрезание кода не помогло


#### Второй этап

Через intruder переберём какие теги нам доступны так как script не вариант
- Заходим в шпаргалку от портсвигер и копируем все теги
	`body` и `custom tags` доступны для инъекций
- Теперь надо определиться какие атрибуты доступны нам
	`onafterprint onafterscriptexecute onanimationcancel onanimationend onclick ...`

Задача чтоб без взаимодействия с пользователем вызвалась функция так что нам надо найти такой атрибут который с этим поможет

По итогу задача имеет сервис эксплоитов то есть жертва должна зайти к нас на сайт и перейти на веб сервис этот тем самым мы вызовем уже атрибут который срабатывает при изменение страницы
```
<iframe src="https://0a0d008f030b125f800f264900ad0085.web-security-academy.net/?search="><body onresize=print()>" onload=this.style.width='1000px'>
```