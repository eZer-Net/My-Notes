
Уязвимость возникает, когда система неправильно реализует контроль доступа, позволяя пользователям выполнять действия или получать доступ к ресурсам, к которым у них нет прав.

# Виды нарушений

##### IDOR (Insecure Direct Object Reference): 
Это уязвимость, при которой пользователь может получить доступ к объектам (например, записям в базе данных) путем изменения параметров запроса (например, идентификаторов). Например, если URL содержит идентификатор пользователя, злоумышленник может изменить его и получить доступ к данным другого пользователя.
##### Privilege Escalation: 
Это ситуация, когда пользователь получает более высокий уровень доступа, чем ему разрешено. Например, обычный пользователь может получить административные права через уязвимость в приложении.
##### Missing Function Level Access Control: 
Это происходит, когда приложение не проверяет, имеет ли пользователь право на выполнение определенной функции. Например, если обычный пользователь может получить доступ к административной панели без соответствующих прав.
##### Forced Browsing: 
Злоумышленник может попытаться получить доступ к защищенным ресурсам или страницам, просто вводя URL-адреса вручную, даже если у него нет прав доступа.
##### Insecure API Endpoints: 
Если API не реализует должный контроль доступа, злоумышленники могут получить доступ к данным или функциям, которые должны быть защищены.
##### Session Fixation
Уязвимость, при которой злоумышленник может установить сессию для пользователя и затем использовать её для получения доступа к его учетной записи.

# Типы нарушений 

Бывает двух типов нарушение: Горизонтальное и Вертикальное

#### Горизонтальное
Данный тип обозначает что мы получаем доступ к данным субъекта такого же уровня как и мы

#### Вертикальное
Вертикальный тип нарушения когда мы при помощи данной уязвимости повышаем доступ привилегий 

# В чём выражаются нарушения

- **Нарушение принципа наименьших привилегий**: Системы могут предоставлять пользователям или компонентам больше прав, чем необходимо, что увеличивает риск несанкционированного доступа. 

- **Можно обойти проверки контроля доступа**

- **Можно повысить свои привилегии в системе**

- **Есть возможность осуществить манипуляцию метаданными веб-токенов или файлов Cookie**

- **Можно получить несанкционированный доступ к API**

- **force-browsing авторизованных страниц**

# Варианты атак

Для эксплуатации данной уязвимости можно выделить такие атаки как 

[[Брутфорс (Brute Force Attack)]] - Для поиска скрытых ссылок или уязвимых конечных точек на сайте.

[[Похищение сеанса (Session Hijacking)]] - Перехватывает идентификатор сеанса пользователя, что позволяет получить доступ к ресурсам от имени этого пользователя

[[Сниффинг (Sniffing)]] - Перехват сетевого трафика для получения конфиденциальной информации, такой как токены аутентификации или идентификаторы сеансов. 

[[Man-in-the-Middle (MitM)]] - Позволяет перехватывать и изменять сообщения между двумя сторонами. Если контроль доступа не реализован должным образом, 

==Атака с использованием предсказуемых URL==
Если приложение использует предсказуемые URL для доступа к защищенным ресурсам (например, /admin, /user/profile), злоумышленник может вручную вводить эти URL в адресной строке браузера, пытаясь получить доступ к страницам, на которые у него нет прав.

[[Анализ API|Уязвимости в API]]
Если API не имеет надлежащего контроля доступа, злоумышленник может отправить запросы к защищенным ресурсам, манипулируя параметрами запроса или заголовками. Это может привести к утечке данных или несанкционированному доступу к ресурсам.

# Варианты решения данной уязвимости

- Реализация принципа наименьших привилегий 

- Реализация и проектирование нужной [[Модели контроля доступа|модели контроля доступа]]

- Проверка доступа при каждом запросе

- Отключение листинга директорий

- Все сбои контроля должны тщательно логироваться

- Функциональное и интеграционное тестирование механизмов управления доступом

- Удаление старых учётных записей

- Удаление не нужных служб

