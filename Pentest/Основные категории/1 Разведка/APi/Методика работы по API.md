
# Варианты нахождения API

В разделе документации; В разделе разработчиков; В API-меню; В настройках аккаунта; На страницах интеграций; В формах обратной связи; В примерах кода; В блогах и статьях; В разделе FAQ; В разделе загрузок и ресурсов

----

# 1. Поиск документации
Документация API часто находится в открытом доступе, особенно если API предназначено для использования внешними разработчиками. Если это так, всегда начинаnm разведку с просмотра документации.

Даже если она не в открытом доступе её можно найти по запросам которые ссылаются на неё
- в структуре URL, например `/api/`
- файлы JavaScript (расширение [[Инструмент Burp Suite#Поиск конечных точек в JS|JS Link Finder]])

Или использовать список общих путей для поиска документации

----
# 2. Определение конечных точек API

Определить, как взаимодействовать. Следует узнать информацию о следующем:
- **Входные данные**, которые обрабатывает API, включая обязательные и необязательные параметры.
- **Типы запросов**, которые принимает API, включая [[Всемирная паутина#Методы|поддерживаемые методы HTTP]] и [[Типы файлов в Content-Type|поддерживаемых типов контента]] (расширение в burp [[Инструмент Burp Suite#Определение поддерживаемых форматов|Content type converter]]).
- Ограничения скорости и механизмы аутентификации.

Изучить сообщения об ошибках и другие ответы. Иногда они включают информацию, которую можно использовать для построения допустимого HTTP-запроса.


----
# 4. Определение поддерживаемых методов HTTP

| Метод   | Описание                                                          |
| ------- | ----------------------------------------------------------------- |
| GET     | Получает данные с сервера без изменения его состояния.            |
| POST    | Отправляет данные на сервер для создания нового ресурса.          |
| PUT     | Обновляет существующий ресурс, заменяя его полностью.             |
| PATCH   | Частично обновляет существующий ресурс, изменяя указанные поля.   |
| DELETE  | Удаляет существующий ресурс на сервере.                           |
| HEAD    | Получает заголовки ответа без тела, проверяя доступность ресурса. |
| OPTIONS | Узнает, какие методы поддерживает сервер для конкретного ресурса. |
| TRACE   | Возвращает содержимое запроса для диагностики и отладки.          |
- `GET /api/tasks` - Получает список задач.
- `POST /api/tasks` - Создает новую задачу.
- `DELETE /api/tasks/1` - Удаляет задачу.

----
# 5. Определение поддерживаемых типов контента

Изменить `Content-Type` заголовок, а затем соответствующим образом переформатировать тело запроса (XML, JSON [[Pentest/Термины#RESTful API|RESTful API]]). 

----
# 6. Поиск  и эксплуатация скрытых конечных точек

#### Определить скрытые конечные точки
Использовать Brute force
	Например конечная точку API для обновления информации о пользователе:
	`PUT /api/user/update` . Чтобы определить скрытые конечные точки таких как `delete` и `add`  указав в `/update` payload.

#### Уязвимости массового присвоения
- Часто можно идентифицировать эти скрытые параметры, вручную исследуя объекты, возвращаемые API.
	`PATCH /api/users/` - запрос позволяет пользователям обновлять свое имя пользователя и адрес электронной почты и включает следующий JSON: 
	`{ "username": "wiener", "email": "wiener@example.com", }`
	`GET /api/users/123` - запрос возвращает следующий JSON:
	`{ "id": 123, "name": "John Doe", "email": "john@example.com", "isAdmin": "false" }`
Это может указывать на то, что скрытый `id` и `isAdmin` параметры привязаны к внутреннему объекту пользователя наряду с обновленными параметрами имени пользователя и электронной почты.

----
# 7. Загрязнение параметров на стороне сервера

Загрязнение параметров на стороне сервера происходит, когда веб-сайт встраивает пользовательский ввод в запрос на стороне сервера к внутреннему API без адекватного кодирования.

#### Поиск на наличие загрязнения параметров
можно поместить символы синтаксиса запроса, например `#`, `&`, и `=` в своем вводе запроса и наблюдать, как реагирует приложение. Так же их закодировать можно [[URL-кодировки|url]]
- `#` - комментирует всё то что после
- `&` - оператор и, объединяет запрос
- `=` - оператор присваивания 

- Обратить внимание на то какие ответы мы получаем при использование `#`, `&`, и `=` 

- Параметры могут быть допустимыми и не допустимыми. Определить можно по ответу (пример "Invalid field" обозначает что переменная field принимает данные) и найти параметры по Brute Force `Server-side variable names`

