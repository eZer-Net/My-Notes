
Когда мы выполняем разведку API, то можем обнаружить недокументированные параметры, которые поддерживает API. Мы можем попытаться эксплуатировать их, чтобы изменить поведение приложения. 
[[Инструмент Burp Suite|Burp]] включает в себя множество инструментов, которые помогут вам выявить скрытые параметры:
- Burp Intruder позволяет автоматически обнаруживать скрытые параметры, используя список слов с общими именами параметров для замены существующих параметров или добавления новых параметров. Убедитесь, что вы также включили имена, которые имеют отношение к приложению, исходя из ваших первоначальных данных.
- [BApp Param Miner](https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943) позволяет автоматически угадывать до 65 536 имен параметров за запрос. Param Miner автоматически угадывает имена, относящиеся к приложению, на основе информации, полученной из области видимости.
- Инструмент [обнаружения контента](https://portswigger.net/burp/documentation/desktop/tools/engagement-tools/content-discovery) позволяет обнаруживать контент, не связанный с видимым контентом, который вы можете просмотреть, включая параметры.

## Уязвимости массового назначения

Массовое назначение (также известное как автоматическое связывание) может непреднамеренно создавать скрытые параметры. Это происходит, когда программные фреймворки автоматически связывают параметры запроса с полями внутреннего объекта. Таким образом, массовое назначение может привести к тому, что приложение будет поддерживать параметры, которые никогда не предназначались для обработки разработчиком.

#### Выявление скрытых параметров
Поскольку массовое назначение создает параметры из полей объекта, мы часто можем определить эти скрытые параметры, вручную проверив объекты, возвращаемые API.

Например, `PATCH /api/users/`запрос, который позволяет пользователям обновить свое имя пользователя и адрес электронной почты и включает следующий JSON:

`{ "username": "wiener", "email": "wiener@example.com", }`

Конкурентный `GET /api/users/123`запрос возвращает следующий JSON:
`{ "id": 123, "name": "John Doe", "email": "john@example.com", "isAdmin": "false" }`

Это может указывать на то, что скрытые параметры `id`и `isAdmin`привязаны к внутреннему объекту пользователя вместе с обновленными параметрами имени пользователя и электронной почты.

Чтобы проверить, можно ли изменить `isAdmin`значение перечисленного параметра, добавьте его в `PATCH`запрос:
`{ "username": "wiener", "email": "wiener@example.com", "isAdmin": false, }`

Кроме того, отправьте `PATCH`запрос с недопустимым `isAdmin`значением параметра:
`{ "username": "wiener", "email": "wiener@example.com", "isAdmin": "foo", }`

Если приложение ведет себя по-другому, это может означать, что недопустимое значение влияет на логику запроса, а допустимое — нет. Это может означать, что параметр может быть успешно обновлен пользователем.

Затем мы можем отправить `PATCH`запрос со `isAdmin`значением параметра, установленным на `true`, чтобы попытаться воспользоваться уязвимостью:
`{ "username": "wiener", "email": "wiener@example.com", "isAdmin": true, }`

Если `isAdmin`значение в запросе привязано к объекту пользователя без адекватной проверки и очистки, пользователю `wiener`могут быть неправильно предоставлены права администратора. 

#### Лаба
[[Лабораторная работа Эксплуатация уязвимости массового назначения]]


==Если приложение ведет себя по-другому, это может означать, что недопустимое значение влияет на логику запроса, а допустимое значение — нет.== Это может указывать на то, что параметр может быть успешно обновлен пользователем.
