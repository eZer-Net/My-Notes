
## **OAST (Out-of-Band Application Security Testing)**

OAST расшифровывается как Out-of-Band Application Security Testing. Это метод, который использует внешние взаимодействия для обнаружения уязвимостей, которые не видны напрямую в ответах приложения.

### **Инструменты для OAST**

1. **Burp Collaborator**:
    - Встроен в Burp Suite Professional.
    - Генерирует уникальные домены для отслеживания запросов.
    - Автоматически детектирует DNS, HTTP и SMTP-взаимодействия.
2. **Interactsh**:
    - Пример домена: `xxxxx.interactsh.com`.
3. **Собственный сервер**:
    - Настройте сервер с логированием всех входящих запросов (например, через Python + Flask).

### **Что ищут:**
- Уязвимости (SQLi, XSS, инъекции).
- Проблемы с безопасностью (жестко закодированные пароли, утечки данных).
- Нарушения стандартов кодирования.

----

## **[[SAST (Static Application Security Testing)]]**

SAST — это **статический анализ кода** без его выполнения. Инструменты анализируют исходный код, бинарные файлы или конфигурации на наличие уязвимостей.

Для анализа кода SAST использует несколько ключевых структур данных:
- **AST (Abstract Syntax Tree) — Абстрактное синтаксическое дерево**
	AST — это дерево, которое отражает структуру кода. Оно строится на этапе компиляции/интерпретации.
- **CFG (Control Flow Graph) — Граф потока управления**
	CFG показывает, как выполняется программа: какие блоки кода выполняются последовательно, а где есть ветвления (if, for, while и т. д.).
- **DFG (Data Flow Graph) — Граф потока данных**
	DFG показывает, как данные перемещаются между переменными и операциями.
- **Taint Analysis — Анализ "заражённых" данных**
	Это расширенный анализ потока данных, который отслеживает **опасные данные** (например, пользовательский ввод) и проверяет, не используются ли они в опасных операциях (SQL-запросах, командах ОС и т. д.) без проверки.

##### **Вывод: как SAST использует эти структуры**
1. **Строит AST** → понимает структуру кода.
2. **Строит CFG** → анализирует возможные пути выполнения.
3. **Строит DFG** → отслеживает передачу данных.
4. **Применяет taint analysis** → ищет опасные данные в уязвимых местах.

- **AST** нужен, чтобы понять, что делает код (без него SAST работал бы как `grep`).
- **CFG** нужен, чтобы учесть все возможные пути выполнения (иначе можно пропустить уязвимость в `else`).
- **DFG** и **taint** нужны, чтобы отследить данные через цепочку вызовов (иначе уязвимость в глубоком коде не найдётся).

### **Примеры инструментов:**

##### **[[SonarQube]]**: Многоязычный анализатор кода.

- **Основные структуры:** AST + CFG + частично DFG.
- **Как работает:**
    - Строит AST и CFG для поиска ошибок в структуре кода.
    - Использует простой анализ потока данных (но не такой глубокий, как Checkmarx).

- **Плюсы:**
    - Находит баги, code smells, уязвимости.
    - Поддерживает много языков.
- **Минусы:**
    - Менее точен в сложных security-уязвимостях (например, SQL-инъекциях с кастомными фильтрами).
##### **Checkmarx**: Enterprise-решение для анализа кода.

- **Основные структуры:** AST + CFG + DFG + taint analysis.
- **Как работает:**
    - Строит полный граф потока данных (DFG).
    - Применяет taint analysis для отслеживания опасных данных.
    - Может найти уязвимость, даже если данные прошли через несколько функций.

- **Плюсы:**
    - Находит сложные уязвимости (например, Second-Order SQLi).
    - Меньше ложных срабатываний.
- **Минусы:**
    - Медленнее Semgrep/SonarQube.
    - Сложнее в настройке.
##### **Bandit**: Специализирован на Python.

##### **[[Semgrep]]**: Универсальный инструмент для статического анализа.

- **Основная структура:** AST (синтаксическое дерево).
- **Как работает:** Ищет шаблоны в AST (например, «вызов `eval()` с аргументом из пользовательского ввода»).

- **Плюсы:**
	- Быстрый, не требует сложного анализа.
	- Хорош для простых правил (например, запрет `md5()`).
	- Не требует taint mode (Это не просто поиск паттерна небезопасного вызова но и определяем источник который подставляется в вызов небезопасный)
- **Минусы:**
	- Не отслеживает поток данных (DFG/taint), поэтому может пропустить сложные уязвимости.

### **Что ищут и как работают:**
- Уязвимости (SQLi, XSS, инъекции).
- Проблемы с безопасностью (жестко закодированные пароли, утечки данных).
- Нарушения стандартов кодирования.

**Пример кода:**
```
String userInput = request.getParameter("id"); // источник
String query = "SELECT * FROM users WHERE id = " + userInput; // уязвимость
```
- **Semgrep:** Найдёт по шаблону `"SELECT ..." + input`.
- **SonarQube:** Заметит конкатенацию SQL-запроса, но может пропустить, если код сложнее.
- **Checkmarx:** Отследит, что `userInput` идёт извне и попадает в SQL без проверки.

----

## **DAST (Dynamic Application Security Testing)**

DAST — это **динамический анализ работающего приложения**. Инструменты имитируют атаки на работающее приложение (как черный ящик) для обнаружения уязвимостей.

### Инструменты для DAST

1. **OWASP ZAP** (бесплатный).
2. **Burp Suite** (Pro-версия для продвинутых тестов).
3. **Acunetix**, **Netsparker** (enterprise-решения).

----

# IAST - Interactive Application Security Testing
- Комбинирует SAST + DAST, внедряя агент в работающее приложение.

# **[[SCA (Software Composition Analysis)]]**

SCA анализирует **зависимости проекта** (библиотеки, пакеты) на наличие известных уязвимостей.

### Этапы работы SCA:  
1. Сбор зависимостей  
   - Анализируются файлы package.json (Node.js), pom.xml (Java), requirements.txt (Python), .csproj (C#) и др.  

2. Создание **SBOM** (Software Bill of Materials)  
   - генерируем **SBOM** (например, через `cyclonedx-bom` или `syft`):   
   - Формируется список всех зависимостей, включая вложенные (транзитивные).  

3. Сравнение с базами уязвимостей  
   - Используются базы данных:  
     - NVD (National Vulnerability Database)  
     - GitHub Advisory Database  
     - OSV (Open Source Vulnerabilities)  
     - Debian Security Advisories  

4. Генерация отчета  
   - Выводятся найденные уязвимости, их критичность (CVSS), рекомендации по обновлению.  
#### Как SCA анализирует вложенные зависимости?  
Многие уязвимости скрыты в транзитивных зависимостях (библиотеки, от которых зависят другие библиотеки).  
```
Наше приложение → Библиотека A v1.0 → Библиотека B v2.1 → Библиотека C v3.0 (CVE-2023-XXX)
```
### **Примеры инструментов:**

- **OWASP Dependency-Check**: Бесплатный инструмент для поиска уязвимостей в зависимостях.

- **Dependency-Track** — это SCA-инструмент с открытым исходным кодом, который анализирует зависимости проекта.
	Dependency-Track автоматически загружает данные из:
		- NVD (NIST National Vulnerability Database)
		- GitHub Advisory Database
		- OSV (Google’s Open Source Vulnerabilities)

### **Какие базы знаний использует SCA**

#### **1. Национальная база уязвимостей (NVD)**
- **Что это?** Официальная база данных уязвимостей от [NIST (National Institute of Standards and Technology)](https://nvd.nist.gov/).
- **Формат:** Данные в формате **CVE (Common Vulnerabilities and Exposures)**.
- **Пример:** `CVE-2021-44228` (Log4Shell в Log4j).
#### **2. GitHub Advisory Database**
- **Что это?** База уязвимостей, поддерживаемая GitHub ([ссылка](https://github.com/advisories)).
- **Особенности:**
    - Включает уязвимости из открытых репозиториев (npm, PyPI, Maven и др.).
    - Часто обновляется.

#### **3. OSV (Open Source Vulnerabilities)**
- **Что это?** Открытая база уязвимостей от Google и других компаний ([osv.dev](https://osv.dev/)).
- **Особенности:**
    - Поддерживает автоматическое сопоставление версий пакетов.

#### **4. Sonatype OSS Index**
- **Что это?** База данных уязвимостей от Sonatype ([ossindex.sonatype.org](https://ossindex.sonatype.org/)).
- **Особенности:**
    - Покрывает Maven, npm, PyPI, NuGet и другие экосистемы.

#### **5. Retire.js (для JavaScript)**
- **Что это?** Специализированная база для уязвимостей в JS-библиотеках ([retirejs.github.io](https://retirejs.github.io/retire.js/)).

#### **6. VulnDB (коммерческая)**
- **Что это?** Расширенная база уязвимостей от Risk Based Security ([vulndb.cyberriskanalytics.com](https://vulndb.cyberriskanalytics.com/)).
- **Особенности:**
    - Включает уязвимости, которых нет в NVD.

### **Что ищут:**

- Уязвимости в сторонних библиотеках (CVE).
	- log4j-core 2021г уязвимость в java
	- атака с подменой имён пакетов
	- кэш го модуль не обновляется
- Устаревшие зависимости.
- Лицензионные риски.

----


# OSA (Open Source Analysis)
- **Что делает**: Подмножество SCA, фокусируется на открытом ПО.
- **Зачем**: Контроль лицензий и уязвимостей в open-source компонентах.

# CNA - Container Native Analysis
Основные инструменты:
    Trivy (Aqua Security)
    Clair (Quay)
    Anchore
    Snyk Container
    Docker Bench for Security (проверка конфигураций)
- Секреты в образе
- Запуск от root - Если злоумышленник вырвется из контейнера (например, через уязвимость в ядре Linux), он получит root-доступ к хосту. Перезапись критических файлов
- Открытые порты
- Небезопасные тома в yaml
- Привилегированные контейнеры


# CNA (Cloud-Native Analysis)
- **Что делает**: Анализ безопасности облачных конфигураций (Kubernetes, Docker).
- **Зачем**: Обнаружение неправильных настроек облачных сервисов.
- **Инструменты**: Aqua Security, Prisma Cloud.

# RASP (Runtime Application Self-Protection)
- **Что делает**: Встроенная защита приложения в runtime (блокирует атаки автоматически).
- **Зачем**: Защита от эксплуатации 0-day уязвимостей.
- **Инструменты**: Imperva RASP, Fortify.

# Fuzz Testing (Fuzzing)
- **Что делает**: Автоматическая отправка случайных/некорректных данных в приложение.
- **Зачем**: Поиск крашей, уязвимостей в обработке ввода.
- **Инструменты**: AFL, libFuzzer, OWASP WSFuzzer, fuff/

# **Сравнение OAST, SAST и DAST**

| **Критерий**            | **OAST**                      | **SAST**             | **DAST**                   |
| ----------------------- | ----------------------------- | -------------------- | -------------------------- |
| **Тип анализа**         | Внеполосный                   | Статический          | Динамический               |
| **Когда проводится**    | На этапе тестирования/прод    | На этапе разработки  | На этапе тестирования/прод |
| **Доступ к коду**       | Не требуется                  | Требуется            | Не требуется               |
| **Примеры уязвимостей** | Слепой XXE, SSRF              | SQLi, XSS (в коде)   | XSS, SQLi (в runtime)      |
| **Инструменты**         | Burp Collaborator, Interactsh | SonarQube, Checkmarx | OWASP ZAP, Burp Suite      |

---

