
**Lynis** — это мощный инструмент для аудита безопасности и сканирования систем на основе Linux/Unix. Он помогает выявлять уязвимости, неправильные настройки и потенциальные угрозы безопасности. Lynis работает как на локальных, так и на удалённых системах, и предоставляет подробный отчёт с рекомендациями по улучшению безопасности.


---

## Основные возможности Lynis

1. **Аудит безопасности**:
    
    - Проверка настроек ядра, прав доступа, сетевых конфигураций, установленных пакетов и других аспектов системы.
        
    - Обнаружение уязвимостей и неправильных настроек.
        
2. **Поддержка различных ОС**:
    
    - Lynis поддерживает множество дистрибутивов Linux, а также Unix-системы (например, FreeBSD, macOS).
        
3. **Гибкость**:
    
    - Возможность использования в различных режимах: локальный аудит, удалённый аудит, анализ Dockerfile и т.д.
        
4. **Подробный отчёт**:
    
    - Lynis предоставляет детализированный отчёт с указанием найденных проблем и рекомендациями по их устранению.
        
5. **Поддержка профилей**:
    
    - Можно использовать предопределённые профили для настройки сканирования под конкретные задачи.


---

## Как работает Lynis

1. **Инициализация**:
    
    - Lynis запускается и проверяет систему на наличие необходимых зависимостей и прав доступа.

2. **Сбор информации**:
    
    - Инструмент собирает информацию о системе, включая:
        
        - Версию ядра.
        - Установленные пакеты.
        - Настройки сети.
        - Права доступа к файлам и директориям.

3. **Проверка безопасности**:
    
    - Lynis выполняет сотни тестов, разделённых на категории, такие как:
        
        - Аутентификация.
        - Файловая система.
        - Сетевые настройки.
        - Логирование.
        - Шифрование.

4. **Формирование отчёта**:
    
    - После завершения сканирования Lynis предоставляет отчёт, который включает:
        
        - Найденные проблемы.
        - Рекомендации по улучшению безопасности.
        - Оценку уровня безопасности системы.

----
## Основные команды и опции

### Команды:

- **`audit system`**: Выполнить локальный аудит системы.
- **`audit system remote <host>`**: Выполнить аудит удалённой системы.
- **`audit dockerfile <file>`**: Проанализировать Dockerfile.
- **`show version`**: Показать версию Lynis.
- **`show help`**: Показать справку.

### Опции:

- **`--forensics`**: Выполнить анализ в режиме форензики.
- **`--pentest`**: Режим пентеста (без привилегий).
- **`--no-colors`**: Отключить цветной вывод.
- **`--quiet (-q)`**: Тихий режим (без вывода на экран).
- **`--debug`**: Включить режим отладки.
- **`--profile <profile>`**: Использовать определённый профиль для сканирования.
- **`--upload`**: Загрузить данные на центральный узел (для Enterprise-версии).

---

# Пример вывода по сканированию

Для большей наглядности Lynis использует условные обозначения в виде цветов:  
  
- зелёный: всё хорошо
- жёлтый: не нашёл всё необходимое, или возникла спорная ситуация
- красный: это проблема, стоит с ней разобраться

Lynis даёт возможность найти дополнительную информацию о каждом предложении по исправлению с помощью команды **show details**, за которой следует номер теста **TEST-ID**:  

```
./lynis show details TEST-ID
```


### 1. **Сервисы и их уровень безопасности**

Lynis проверяет системные сервисы и оценивает их уровень безопасности. В вашем выводе указаны следующие сервисы:

- **`rpc-svcgssd.service: [ НЕБЕЗОПАСНО ]`**:
    
    - Сервис `rpc-svcgssd` используется для работы с GSS-API (Generic Security Services API) в RPC. Он считается небезопасным, так как может быть использован для атак, если не настроен правильно.

- **`rtkit-daemon.service: [ СРЕДНИЙ ]`**:
    
    - `rtkit` (RealtimeKit) — это демон для управления реальным временем. Уровень "Средний" означает, что сервис может представлять определённые риски, но они не критичны.

- **`sddm.service: [ НЕБЕЗОПАСНО ]`**:
    
    - `sddm` — это дисплейный менеджер для KDE. Он считается небезопасным, так как может быть использован для атак, если не настроен правильно.

- **`smartmontools.service: [ НЕБЕЗОПАСНО ]`**:
    
    - `smartmontools` используется для мониторинга состояния жёстких дисков. Он может быть небезопасным, если предоставляет доступ к данным диска без должной защиты.

- **`ssh.service: [ НЕБЕЗОПАСНО ]`**:
    
    - Сервис SSH считается небезопасным, если используются слабые настройки (например, разрешён вход по паролю, используется устаревшая версия протокола и т.д.).

- **`systemd-ask-password-*.service: [ НЕБЕЗОПАСНО ]`**:
    
    - Эти сервисы используются для запроса паролей в системе. Они могут быть небезопасными, если не настроены правильно.

- **`systemd-bsod.service: [ НЕБЕЗОПАСНО ]`**:
    
    - Сервис для отображения "синего экрана" (BSOD) в Linux. Он может быть небезопасным, если используется неправильно.

- **`systemd-hostnamed.service: [ ЗАЩИЩЕНО ]`**:
    
    - Сервис для управления именами хостов. Уровень "Защищено" означает, что сервис настроен правильно и не представляет угроз.


---

### 2. **Права доступа к файлам**

Lynis проверяет права доступа к критически важным файлам:

- **`/boot/grub/grub.cfg: [ ОК ]`**:
    
    - Файл конфигурации GRUB имеет правильные права доступа.

- **`/etc/crontab: [ ПРЕДЛОЖЕНИЕ ]`**:
    
    - Файл `/etc/crontab` может иметь неправильные права доступа. Lynis предлагает проверить и исправить их.


---

### 3. **Сетевые настройки**

Lynis проверяет параметры ядра, связанные с сетью:

- **`net.ipv4.tcp_timestamps: [ ОК ]`**:
    
    - Параметр `tcp_timestamps` настроен правильно.

- **`net.ipv6.conf.all.accept_redirects: [ ОТЛИЧАЕТСЯ ]`**:
    
    - Параметр `accept_redirects` для IPv6 отличается от ожидаемого значения. Lynis рекомендует проверить и исправить его.

---

### 4. **Усиление безопасности**

Lynis проверяет, установлены ли компиляторы и антивирусные сканеры:

- **`Installed compiler(s): [ Найдено ]`**:
    
    - На системе установлены компиляторы (например, GCC). Это может быть небезопасно, так как злоумышленник может использовать их для компиляции вредоносного кода.

- **`Installed malware scanner: [ НЕ НАЙДЕНО ]`**:
    
    - На системе не установлен антивирусный сканер. Lynis рекомендует установить его для повышения безопасности.

- **`Non-native binary formats: [ Найдено ]`**:
    
    - На системе найдены бинарные файлы, которые не являются нативными для данной архитектуры. Это может быть признаком потенциальной угрозы.

---

### 5. **Пользовательские тесты**

Lynis поддерживает выполнение пользовательских тестов, но в вашем случае они отсутствуют:

- **`Running custom tests... [ Отсутствует ]`**.

---

### 6. **Предупреждения и рекомендации**

Lynis предоставляет список предупреждений и рекомендаций:

- **`Warnings (1):`**:
    
    - **`iptables module(s) loaded, but no rules active [FIRE-4512]`**:
        
        - Модули iptables загружены, но не настроены правила. Это может сделать систему уязвимой для сетевых атак.

- **`Suggestions (51):`**:
    
    - Lynis предлагает 51 рекомендацию по улучшению безопасности. Например:
        
        - Обновить систему, если она устарела.
        - Проверить настройки брандмауэра.
        - Установить антивирусный сканер.


---

### 7. **Результаты сканирования**

Lynis предоставляет сводку результатов сканирования:

- **`Hardening index: 62 [############ ]`**:
    
    - Индекс усиления безопасности системы составляет 62 из 100. Это означает, что система частично защищена, но есть возможности для улучшения.
        
- **`Tests performed: 274`**:
    
    - Lynis выполнил 274 теста.
        
- **`Plugins enabled: 1`**:
    
    - Использовался 1 плагин.
        
- **`Components:`**:
    
    - **`Firewall: [V]`** — брандмауэр проверен.
        
    - **`Malware scanner: [X]`** — антивирусный сканер не найден.
        
- **`Scan mode:`**:
    
    - Сканирование выполнено в обычном режиме (`Normal [V]`).
        

---

### 8. **Файлы и логи**

Lynis сохраняет результаты сканирования в файлы:

- **`/var/log/lynis.log`** — подробный лог сканирования.
    
- **`/var/log/lynis-report.dat`** — данные отчёта.
    

---

### 9. **Рекомендации по улучшению**

Lynis предлагает:

- Просмотреть детали тестов с помощью команды `lynis show details TEST-ID`.
    
- Проверить лог-файл для получения дополнительной информации.
    
- Использовать опцию `--upload` для загрузки данных в центральную систему (для Enterprise-пользователей).
