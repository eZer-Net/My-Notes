
# Установка

#### 0. Создаём виртуальное окружение
```
python3 -m venv ~/semgrep_venv  # создаём в домашней директории
```

#### 1. Активируем его (в каждом новом терминале):
```
source ~/semgrep_venv/bin/activate
```
После активации приглашение командной строки изменится, например:
```
(semgrep_venv) user@kali:~$ 
```

#### 2. Устанавливаем semgrep (если ещё не установлен):
```
pip install semgrep
```

Проверяем установку
```
semgrep -h
```
#### 3. Деактивация виртуального окружения

Когда закончим работу:
```
deactivate
```
Приглашение вернётся к обычному виду, и `semgrep` перестанет быть доступен.

# Изучение инструмента

**Semgrep** — это статический анализатор кода, который ищет уязвимости, баги и антипаттерны по заданным правилам. Поддерживает *Python, JavaScript, Go, Java, SQL, PHP, C/C++* и другие языки.

#### 0. Основные команды
| Команда                      | Описание                                                      |
| ---------------------------- | ------------------------------------------------------------- |
| `semgrep scan --config auto` | Автоматический анализ кода (использует правила с semgrep.dev) |
| `semgrep ci`                 | Проверка изменений в Git (CI/CD)                              |
| `semgrep login`              | Вход в аккаунт semgrep.dev (чтобы загружать свои правила)     |
| `semgrep publish`            | Загрузить своё правило на semgrep.dev                         |
| `semgrep --version`          | Проверить версию                                              |
#### 1. Объяснение semgrep.dev

**semgrep.dev** — это:
- **Облачная платформа** для хранения правил (аналог GitHub для Semgrep).
- **Готовые шаблоны** (`p/security-audit`, `p/python`, `p/javascript` и др.).
- **Возможность публиковать свои правила** (аналог "модов" для анализа кода).

**Как зарегистрироваться?**
```
semgrep login   # Откроет браузер для входа через
```

#### 2. Как писать свои правила/шаблоны?

Правила пишутся в **YAML**.
- Пример: Поиск `eval()` в JavaScript
```
rules:
  - id: dangerous-eval
    pattern: eval(...)
    message: "Найден опасный eval()!"
    languages: [javascript]
    severity: ERROR
```
Как запустить:
```
semgrep scan --config rule.yaml /путь/к/коду
```

#### 3. Где брать шаблоны?
1. **Официальные правила**: [semgrep.dev/explore](https://semgrep.dev/explore)
2. **Примеры на GitHub**: [github.com/returntocorp/semgrep-rules](https://github.com/returntocorp/semgrep-rules)

#### 4. Тестирование локального проекта**

**Пример 1: Проверка Python-кода на уязвимости кастом шаблон**
```
semgrep scan --config "p/security-audit" --lang python /путь/к/проекту
```

**Пример 2: Проверка локального проекта**
```
semgrep scan --config auto /путь/к/папке
```


# ==Базовые команды с фичами==

0. Без знаний проекта так сказать первый раз увидел и вывод работы в консоль
```
semgrep scan --config auto .
```

1. Вывод в формат `sarif` для анализа ответа в удобной форме
```
semgrep scan --config auto --sarif --output semgrep.sarif
```

2. Для visual studio code расширение `SARIF Viewer`


3. При работе с расширение  `SARIF Viewer` искать такие слова как 
```
secrets; sql; injection; xss; rce; hardcoded; auth; misconfiguration; unsafe
```

4. На офф сайте semgrep есть такие полезные ссылки как
- `https://semgrep.dev/explore` - готовые конфиги(правила)
- `https://semgrep.dev/docs/writing-rules/rule-syntax` - описание синтаксиса для yaml формата правил
- `https://semgrep.dev/playground/new?view=code` - конструктор своих правил
- `https://github.com/search?q=semgrep-rules&type=repositories` - поиск правил на гитхабе

4. При базовом аккаунте запуск сканера происходит в такой форме 
	- **✔ Semgrep OSS** – активирован базовый набор правил Semgrep (бесплатный, открытый).
	- **✘ Semgrep Code (SAST)** – _не активирован_ расширенный анализ кода (требуется подписка Semgrep Pro/Teams).
	- **✘ Semgrep Supply Chain (SCA)** – _не активирован_ анализ зависимостей (SCA, требуется подписка).


