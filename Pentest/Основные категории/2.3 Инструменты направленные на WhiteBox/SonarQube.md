Идеальный разбор работы инструмента 
`https://youtu.be/LI36tWHd-Tc?si=ePz4mzOc5ScUt6Ll`

##### Расширение для IDE **SonarLint**
Поддерживаемые IDE:
- IntelliJ IDEA (Community & Ultimate)
- Visual Studio Code (VS Code)
- Eclipse
- Visual Studio (для C#, C++, VB.NET)
Возможности:
- Локальный анализ кода (без сервера SonarQube) или привязка к серверу (для синхронизации правил).
- Подсветка уязвимостей в реальном времени (SQLi, XSS, инъекции, криптографические уязвимости и др.).
- Автоматические исправления (для некоторых языков).
- Интеграция с SonarQube/SonarCloud (если настроен сервер).

### 1. Запускаем докер ([[Контейнеризация|работа с докером]])
```
docker run --name sonarqube-custom -p 9000:9000 sonarqube:community
```

### 2. Регистрируемся
	`http://localhost:9000`
	- admin:admin -для первого входа

### 3. Выбираем проект
- Локальный или подключаем репозиторий

### 4. Работа с SonarScanner
**SonarScanner** — это официальный инструмент от SonarQube, который анализирует исходный код проекта и отправляет результаты на сервер SonarQube для дальнейшей обработки.

#### **Для чего он нужен?**
- **Автоматизирует анализ кода**: проверяет код на ошибки, уязвимости и "запахи" (code smells).
- **Интегрируется в CI/CD**: может запускаться в пайплайнах (Jenkins, GitLab CI, GitHub Actions).
- **Поддерживает множество языков**: Java, JavaScript, Python, C#, Go и др.
- **Генерирует отчеты**: после проверки вы получаете детальный отчет в веб-интерфейсе SonarQube.


# Основные преимущества перед semgrep

- Обширный функционал для внедрения в CI/CD с рассылкой на почту и тп..
- Анализ стиля проекта (как в код ревью)
- Внедрение требований по используемым библиотека\классам\методам
- Минимизация рутиных задач.

# Основные недостатки сканера

- При бесплатной версии SonarQube CE нет анализа веток, только 1 ветку основную анализировать.
	- Решение: плагин sonarqube-community-branch-plugin который анализирует ветки.
- Очень долгий анализ кода, 
	15к строк на TLS 8,9 - 90 секунд, 420к строк на TLS 8,9 - 116 минут
	- Решение: обновлять версии 

# Категория нарушений или их приоритетность

В **SonarQube** каждому нарушению (issue) назначается **приоритет**, который помогает разработчикам понять, насколько критична проблема.

1. **Blocker** (Критический)
    - Очень опасные ошибки, которые **могут сломать систему** или привести к серьезным уязвимостям.
    - **Пример**: Утечка памяти, SQL-инъекция, NullPointerException в критическом коде.

2. **Critical** (Высокий)
    - Серьезные баги или уязвимости, **требующие срочного исправления**.
    - **Пример**: Небезопасное хранение паролей, потенциальный отказ сервиса.

3. **Major** (Существенный)
    - Проблемы, **влияющие на качество и поддерживаемость кода**, но не приводящие к явным сбоям.
    - **Пример**: Дублирование кода, нарушение SOLID-принципов, избыточная сложность метода.

4. **Minor** (Незначительный)
    - Небольшие недочеты, **не влияющие на функциональность**, но ухудшающие читаемость.
    - **Пример**: Неиспользуемые переменные, избыточные проверки, опечатки в комментариях.

5. **Info** (Информационный)
    - Рекомендации и замечания, **не являющиеся ошибками**.
    - **Пример**: Неоптимальный форматирование, предложения по рефакторингу.

# Как настраивается проект в SonarQube

1. Набор правил Quality Profile 
2. Набор условий для нового и всего кода Quality Gate
Анализируемый проект

### Правила в SonarQube/Quality Profile 
**Sonar Way** — это стандартный набор правил (quality profile) в **SonarQube**, который определяет рекомендуемые критерии качества кода для различных языков программирования.
![[Pasted image 20250507094426.png]]
Правила в SonarQube имеет подкатегории 
- Баги/дефекты
- Уязвимости
- "Запахи кода"
-  Потенциальные точки уязвимостей

##### 1. Дефекты (Bug)
![[Pasted image 20250507100105.png]]
- В опшионе null, он не предназначен для этого

##### 2. Уязвимости
![[Pasted image 20250507100152.png]]
- Предсказуемое значение

##### 3. Code Smell
![[Pasted image 20250507100322.png]]
- Сюда попадают все остальные правила в сонаркубе, в коде не очень понятно что написано.

##### 4. Потенциальные уязвимости
![[Pasted image 20250507100426.png]]
- Здесь отклчается csrf защита и сонаркуб говорит поверить место на потецииальную уязвимость


#### Итог по правилам
![[Pasted image 20250507101728.png]]

### Quality Gate
Работает над результатами анализа проекта, проверяется на новом коде (не весь существующий код) 
![[Pasted image 20250507102023.png]]
- Анализирует покрытие проекта
- Не слишком много дублирующихся строк кода
- Нет дефектов
- Все хотспоты про ревьюлери
- И у нас нет уязвимостей

#### Информация при изменении правил
![[Pasted image 20250507102252.png]]


