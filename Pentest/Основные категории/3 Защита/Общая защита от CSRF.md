В настоящее время успешный поиск и использование CSRF-уязвимостей часто предполагает обход мер по борьбе с CSRF, применяемых целевым веб-сайтом, браузером жертвы или тем и другим. Наиболее распространенные способы защиты, с которыми вы столкнетесь, следующие:

- **[[Токен CSRF|Токены CSRF]]** . Токен CSRF — это уникальное, секретное и непредсказуемое значение, которое генерируется серверным приложением и передается клиенту. При попытке выполнить конфиденциальное действие, например отправить форму, клиент должен включить в запрос правильный токен CSRF. Из-за этого злоумышленнику очень сложно составить действительный запрос от имени жертвы.

- **Файлы cookie SameSite** . SameSite — это механизм безопасности браузера, который определяет, когда файлы cookie веб-сайта включаются в запросы, исходящие с других веб-сайтов. Поскольку для запросов на выполнение конфиденциальных действий обычно требуется файл cookie сеанса с проверкой подлинности, соответствующие ограничения SameSite могут помешать злоумышленнику инициировать эти действия между сайтами. С 2021 года Chrome применяет `Lax` Ограничения SameSite по умолчанию. Поскольку это предлагаемый стандарт, мы ожидаем, что другие основные браузеры примут такое поведение в будущем.

- **Проверка на основе Referer** . Некоторые приложения используют заголовок HTTP Referer для защиты от атак CSRF, обычно путем проверки того, что запрос исходит из собственного домена приложения. Обычно это менее эффективно, чем проверка токена CSRF.