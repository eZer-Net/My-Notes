## Для поставщиков услуг OAuth

- Требовать от клиентских приложений регистрации белого списка допустимых `redirect_uris`. По возможности используйте строгое побайтовое сравнение для проверки URI во всех входящих запросах. Разрешайте только полные и точные совпадения, а не используйте сопоставление с шаблоном. Это не позволит злоумышленникам получить доступ к другим страницам на доменах из белого списка.

- Принудительное использование параметра `state`. Его значение также должно быть привязано к сеансу пользователя путем включения некоторых неугадываемых, специфичных для сеанса данных, таких как хэш, содержащий cookie сеанса. Это помогает защитить пользователей от атак типа CSRF. Это также значительно затрудняет злоумышленнику использование любых украденных кодов авторизации.

- На сервере ресурсов убедитесь, что вы проверили, что токен доступа был выдан тому же `client_id`, кто делает запрос. Вам также следует проверить запрашиваемую область, чтобы убедиться, что она соответствует области, для которой токен был изначально выдан.

## Для клиентских приложений OAuth

- Убедитесь, что полностью понимаем детали работы OAuth, прежде чем внедрять его. Многие уязвимости вызваны простым непониманием того, что именно происходит на каждом этапе и как это может быть потенциально использовано.

- Использовать `state` параметр, даже если он не является обязательным.

- Отправлять `redirect_uri`параметр не только в `/authorization`конечную точку, но и в `/token`конечную точку.

- При разработке мобильных или собственных клиентских приложений OAuth для настольных компьютеров часто невозможно сохранить `client_secret`конфиденциальность. В таких ситуациях механизм `PKCE`( `RFC 7636`) может использоваться для обеспечения дополнительной защиты от перехвата или утечки кода доступа.

- Если используется OpenID Connect `id_token`, убедитесь, что он правильно проверен в соответствии со спецификациями JSON Web Signature, JSON Web Encryption и OpenID.

- Будьте осторожны с кодами авторизации — они могут просочиться через `Referer`заголовки при загрузке внешних изображений, скриптов или CSS-контента. Также важно не включать их в динамически генерируемые файлы JavaScript, поскольку они могут быть выполнены с внешних доменов через `<script>`теги.