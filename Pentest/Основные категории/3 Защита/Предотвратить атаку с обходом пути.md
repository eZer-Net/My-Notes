Самый эффективный способ предотвратить уязвимости обхода пути — вообще избегать передачи вводимых пользователем данных в API файловой системы. Многие функции приложения, которые делают это, можно переписать, чтобы обеспечить то же поведение более безопасным способом.

Если вы не можете избежать передачи введенных пользователем данных в API файловой системы, мы рекомендуем использовать два уровня защиты для предотвращения атак:

- Проверьте введенные пользователем данные перед их обработкой. В идеале **сравните вводимые пользователем данные с белым списком разрешенных значений**. Если это невозможно, убедитесь, что входные данные содержат только разрешенное содержимое, например только буквенно-цифровые символы.
- После проверки предоставленных входных данных добавьте их в базовый каталог и используйте API файловой системы платформы для канонизации пути. Убедитесь, что канонизированный путь начинается с ожидаемого базового каталога.

Ниже приведен пример простого кода Java для проверки канонического пути к файлу на основе пользовательского ввода:
```
File file = new File(BASE_DIRECTORY, userInput); 
if (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) 
{
	// process file 
}
```