

### 1. Использовать параметризованные запросы
Параметризованные запросы, также известные как подготовленные утверждения, позволяют отделить данные от структуры SQL-запроса. Это предотвращает возможность злоумышленника вмешиваться в запрос, так как пользовательский ввод не может изменить его структуру.

##### Пример уязвимого кода
Следующий код уязвим для SQL-инъекции, потому что пользовательский ввод объединяется непосредственно в запрос:

```
String query = "SELECT * FROM products WHERE category = '" + input + "'";
Statement statement = connection.createStatement();
ResultSet resultSet = statement.executeQuery(query);
```

Исправленный код
```
PreparedStatement statement = connection.prepareStatement("SELECT * FROM products WHERE category = ?");
statement.setString(1, input);
ResultSet resultSet = statement.executeQuery();
```


### 2. Использовать ORM (Object-Relational Mapping)
ORM-библиотеки автоматически обрабатывают создание SQL-запросов и используют параметры, что значительно снижает риск инъекций.

##### Пример
Использование Hibernate в Java:

```
List<Product> products = session.createQuery("FROM Product WHERE category = :category", Product.class)
	  .setParameter("category", input)
	  .getResultList();
```


### 3. Применение белых списков
Создание белого списка допустимых значений для пользовательского ввода помогает ограничить возможные варианты ввода и предотвращает инъекции.

##### Пример
Если ожидается, что категория будет одной из фиксированных значений:
```
List<String> allowedCategories = Arrays.asList("electronics", "books", "clothing");
if (!allowedCategories.contains(input)) {
    throw new IllegalArgumentException("Invalid category");
}
```

### 4. Экранирование пользовательского ввода
Если по какой-то причине невозможно использовать параметризованные запросы, экранирование специальных символов в пользовательском вводе может помочь избежать инъекций.

##### Пример
```
String safeInput = escape(input); // Реализуйте функцию escape для экранирования специальных символов
String query = "SELECT * FROM products WHERE category = '" + safeInput + "'";
```

**экранирование недостаточно надежный методом защиты**. Если экранирование реализовано неправильно или не учитывает все возможные сценарии и специальные символы, это может привести к инъекциям. Кроме того, экранирование не всегда является надежным решением, особенно в сложных запросах.

### 5. Ограничение прав доступа
Минимизируйте права доступа к базе данных для приложения, чтобы даже в случае успешной атаки злоумышленник не получил полный доступ к данным.
```
CREATE USER 'app_user'@'localhost' IDENTIFIED BY 'password';
GRANT SELECT ON database_name.products TO 'app_user'@'localhost';
```


