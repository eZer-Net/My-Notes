Чтобы снизить риск подобных атак существует несколько принципов, которым всегда должны следовать.

## Будьте осторожны с учетными данными пользователя

Даже самые надежные механизмы аутентификации будут неэффективны, если мы невольно раскроем злоумышленнику действительный набор учетных данных для входа. Само собой разумеется, что мы никогда не должны отправлять данные для входа в систему по незашифрованным соединениям. Если внедрить HTTPS для своих запросов на вход, убедится, также перенаправлять любые попытки HTTP-запросов на HTTPS.

Также следует провести аудит своего веб-сайта, чтобы убедиться, что никакое имя пользователя или адреса электронной почты не раскрываются ни через общедоступные профили, ни, например, не отражаются в ответах HTTP.

## Не рассчитывайте на безопасность пользователей

Строгие меры аутентификации часто требуют от пользователей дополнительных усилий. Человеческая природа делает почти неизбежным то, что некоторые пользователи найдут способы избавить себя от этих усилий. Поэтому необходимо обеспечить безопасное поведение везде, где это возможно.

Самый очевидный пример — реализация эффективной политики паролей. Некоторые из более традиционных политик терпят неудачу, потому что люди встраивают в политику свои собственные предсказуемые пароли. Вместо этого может оказаться более эффективным реализовать какую-нибудь простую программу проверки паролей, которая позволит пользователям экспериментировать с паролями и предоставит информацию об их надежности в режиме реального времени. Популярный пример — ==библиотека JavaScript. `zxcvbn`==, разработанный Dropbox. Разрешив использовать только те пароли, которые имеют высокий рейтинг при проверке паролей, мы можем обеспечить более эффективное использование безопасных паролей, чем при использовании традиционных политик.

## Запретить перечисление имен пользователей

Злоумышленнику значительно легче взломать механизмы аутентификации, если он обнаружит, что в системе существует пользователь. Существуют даже определенные ситуации, когда из-за особенностей веб-сайта знание о том, что у конкретного человека есть учетная запись, само по себе является конфиденциальной информацией.

Независимо от того, является ли введенное имя пользователя действительным, важно использовать одинаковые общие сообщения об ошибках и убедиться, что они действительно идентичны. Всегда возвращать один и тот же код состояния HTTP при каждом запросе на вход и, наконец, ==сделать время ответа в разных сценариях как можно более неразличимым.==

## Внедрить надежную защиту от грубой силы

Учитывая, насколько простой может быть организация атаки методом перебора, крайне важно принять меры для предотвращения или, по крайней мере, пресечения любых попыток перебора входа в систему.

Одним из наиболее эффективных методов является внедрение ==строгого ограничения скорости пользователей на основе IP.== Это должно включать меры, предотвращающие манипулирование злоумышленниками своим очевидным IP-адресом. В идеале вы должны требовать от пользователя прохождения ==теста CAPTCHA при каждой попытке входа в систему== после достижения определенного предела.

Имейте в виду, что это не гарантирует полного устранения угрозы брутфорса. Однако если сделать этот процесс как можно более утомительным и ручным, увеличивается вероятность того, что любой потенциальный злоумышленник сдастся и вместо этого отправится на поиски более слабой цели.

## Логика проверки.

Простые логические ошибки при обработки аутентификации или авторизации, могут полностью скомпрометировать веб-сайт и пользователей==. Тщательный аудит любой логики проверки или проверки для устранения недостатков является абсолютным ключом к надежной аутентификации.== Проверка, которую можно обойти, в конечном счете, ненамного лучше, чем полное отсутствие проверки.

## Не забывать о дополнительных функциях

==Не сосредотачиваться только на центральных страницах входа и не упускать из виду дополнительные функции, связанные с аутентификацией.== Это особенно важно в тех случаях, когда злоумышленник может зарегистрировать собственную учетную запись и изучить эту функцию. Помнить, что сброс или изменение пароля — это такая же действительная поверхность атаки, как и основной механизм входа в систему, и, следовательно, он должен быть столь же надежным.

## Внедрить правильную многофакторную аутентификацию

Хотя многофакторная аутентификация может оказаться нецелесообразной для каждого веб-сайта, при правильном выполнении она гораздо безопаснее, чем вход в систему только с помощью пароля. Помнить, что **проверка нескольких экземпляров одного и того же фактора не является настоящей многофакторной аутентификацией.** Отправка кодов подтверждения по электронной почте — это, по сути, просто более сложная форма однофакторной аутентификации.

2FA на основе SMS технически проверяет два фактора (то, что вы знаете, и то, что у вас есть). Однако возможность злоупотреблений, например, при замене SIM-карты, означает, что эта система может быть ненадежной.

==В идеале 2FA должна быть реализована с использованием специального устройства или приложения, которое напрямую генерирует код подтверждения.== Поскольку они созданы специально для обеспечения безопасности, они обычно более безопасны.

Наконец, как и в случае с основной логикой аутентификации, убедится, что логика проверок 2FA верна, чтобы ее нельзя было легко обойти.

