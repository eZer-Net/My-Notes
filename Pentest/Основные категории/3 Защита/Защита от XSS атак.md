
# Хранимые

## Обнаружение

Обнаружить сохраненные вредоносные сценарии достаточно просто. Хотя выполняется он на стороне клиента (в браузере), но хранится в базе данных, то есть на стороне сервера. Дешевый и эффективный способ снижения рисков — регулярное сканирование записей БД в поисках признаков хранимых сценариев.

Для противодействия такой атаке достаточно простого регулярного выражения, запрещающего теги script, или политики защиты содержимого (CSP).

## Защита

- Экранировать ввод 
- Для защиты куки можно использовать [[Cookies файлы#Защита Cookies|http-only Cookies]] а так же [[Всемирная паутина#**CORS**|CORS]]
- Сигнатурного анализа в [[Брандмауэры и системы обнаружения вторжения#WAF (Web Application Firewall)|WAF]] для фильтрации пользовательских данных не особо помогает так как есть "[[Хранимый XSS#От сигнатурного анализа XSS|обход]]" 

----
# Отраженные XSS (Reflected XSS)

## Обнаружение:

Отраженные XSS возникают, когда вредоносный код передается через URL или параметры запроса и немедленно выполняется без сохранения на сервере. Обнаружить такие атаки можно с помощью:

• Анализа логов сервера на наличие подозрительных запросов.

• Использования инструментов для тестирования безопасности, которые могут автоматически проверять наличие уязвимостей.

## Защита:

• Экранирование выходных данных: Все данные, выводимые на страницу, должны быть экранированы. Например, использование функций для безопасного вывода в HTML.

• Валидация входных данных: Проверка и фильтрация всех входных данных на стороне сервера перед обработкой.

• Использование токенов CSRF: Токены могут помочь предотвратить атаки, так как они требуют подтверждения от пользователя.

----
# Мутации XSS (Mutation XSS)

## Обнаружение:

Мутационные XSS-атаки происходят, когда вредоносный код изменяется или модифицируется на этапе выполнения в браузере. Это может произойти из-за динамического изменения DOM или использования библиотек, которые неправильно обрабатывают данные. Обнаружение таких атак может быть сложным, так как они могут не проявляться сразу.

## Защита:

• Использование безопасных методов работы с DOM: Избегайте использования методов, которые могут выполнять HTML-код напрямую (например, innerHTML). Вместо этого используйте методы, которые безопасно добавляют элементы в DOM, такие как textContent или createElement.

• Соблюдение принципа "наименьших привилегий": Ограничьте доступ к данным и функциональности приложения, чтобы минимизировать потенциальные уязвимости.

• Постоянный аудит и тестирование: Регулярное тестирование безопасности приложения поможет выявить новые уязвимости и мутации кода.