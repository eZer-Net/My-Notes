На веб-сайтах, использующих процесс входа на основе пароля, пользователи либо самостоятельно регистрируют учетную запись, либо администратор назначает им учетную запись. Эта учетная запись связана с уникальным именем пользователя и секретным паролем, который пользователь вводит в форму входа для аутентификации.

В этом сценарии тот факт, что они знают секретный пароль, считается достаточным доказательством личности пользователя. Это означает, что безопасность веб-сайта будет поставлена ​​под угрозу, если злоумышленник сможет получить или угадать учетные данные другого пользователя.

Этого можно добиться несколькими способами. В следующих разделах показано, как злоумышленник может использовать атаки методом перебора, а также некоторые недостатки защиты методом перебора. Вы также узнаете об уязвимостях базовой аутентификации HTTP.

## Атаки грубой силы Brute Force

Атака методом перебора — это когда злоумышленник использует систему проб и ошибок, чтобы угадать действительные учетные данные пользователя. Эти атаки обычно автоматизируются с использованием списков имен пользователей и паролей. Автоматизация этого процесса, особенно с использованием специальных инструментов, потенциально позволяет злоумышленнику совершать огромное количество попыток входа в систему на высокой скорости.

Брутфорс – это не всегда просто случайный подбор имен пользователей и паролей. Используя базовую логику или общедоступные знания, злоумышленники могут точно настроить атаки методом перебора, чтобы сделать гораздо более обоснованные предположения. Это значительно повышает эффективность подобных атак. Веб-сайты, которые используют вход на основе пароля в качестве единственного метода аутентификации пользователей, могут быть очень уязвимыми, если они не реализуют достаточную защиту от перебора.

### Брутфорс имен пользователей

Имена пользователей особенно легко угадать, если они соответствуют узнаваемому шаблону, например адресу электронной почты. Например, очень часто можно увидеть бизнес-логины в формате `firstname.lastname@somecompany.com`. Однако даже если очевидной закономерности нет, иногда даже учетные записи с высокими привилегиями создаются с использованием предсказуемых имен пользователей, например `admin` или `administrator`.

Во время аудита проверьте, раскрывает ли сайт публично потенциальные имена пользователей. Например, можете ли вы получить доступ к профилям пользователей без входа в систему? Даже если фактическое содержимое профилей скрыто, имя, используемое в профиле, иногда совпадает с именем пользователя для входа. Вам также следует проверить ответы HTTP, чтобы узнать, раскрыты ли какие-либо адреса электронной почты. Иногда ответы содержат адреса электронной почты пользователей с высокими привилегиями, например администраторов или сотрудников ИТ-поддержки.

### Подбор паролей

Пароли также могут быть подобраны методом перебора, причем сложность зависит от сложности пароля. **Многие веб-сайты применяют ту или иную форму политики паролей**, которая вынуждает пользователей создавать пароли с высокой энтропией, которые, по крайней мере теоретически, труднее взломать, используя только грубую силу. Обычно это включает в себя принудительное использование паролей с помощью:
- Минимальное количество символов
- Смесь строчных и прописных букв
- Хотя бы один специальный символ

Однако, хотя пароли с высокой энтропией сложно взломать только компьютерам, мы можем использовать базовые знания о человеческом поведении, чтобы использовать уязвимости, которые пользователи невольно привносят в эту систему. Вместо того, чтобы создавать надежный пароль со случайной комбинацией символов, пользователи часто берут пароль, который они могут запомнить, и пытаются взломать его, чтобы он соответствовал политике паролей. Например, если `mypassword` запрещено, пользователи могут попробовать что-то вроде `Mypassword1!` или `Myp4$$w0rd` вместо.

В тех случаях, когда политика требует, чтобы пользователи регулярно меняли свои пароли, пользователи также обычно вносят незначительные, предсказуемые изменения в свой предпочтительный пароль. Например, `Mypassword1!` становится `Mypassword1?` или `Mypassword2!.`

Знание вероятных учетных данных и предсказуемых шаблонов означает, что атаки методом перебора часто могут быть гораздо более изощренными и, следовательно, эффективными, чем простое перебор всех возможных комбинаций символов.

### Перечисление имени пользователя

Перечисление имен пользователей — это когда мы можем наблюдать изменения в поведении веб-сайта, чтобы определить, действительно ли данное имя пользователя.

Перечисление имени пользователя обычно происходит либо на странице входа, например, когда вводится действительное имя пользователя, но неверный пароль, либо в формах регистрации, когда вводится уже занятое имя пользователя. Это значительно сокращает время и усилия, необходимые для подбора логина, поскольку можно быстро создать короткий список действительных имен пользователей.

**При попытке перебора страницы входа следует обратить особое внимание на любые различия в:**

- **Коды состояния** . Во время атаки методом перебора возвращаемый код состояния HTTP, скорее всего, будет одинаковым для подавляющего большинства предположений, поскольку большинство из них будут неверными. Если предположение возвращает другой код состояния, это является убедительным признаком того, что имя пользователя было правильным. Лучше всего, чтобы веб-сайты всегда возвращали один и тот же код состояния независимо от результата, но эта практика не всегда соблюдается.

- **Сообщения об ошибках** : иногда возвращаемое сообщение об ошибке различается в зависимости от того, неверны ли имя пользователя и пароль или неверен только пароль. На веб-сайтах рекомендуется использовать одинаковые общие сообщения в обоих случаях, но иногда случаются небольшие ошибки при вводе. Даже один неуместный символ делает два сообщения разными, даже в тех случаях, когда символ не виден на отображаемой странице.

- **Время ответа** : если большинство запросов были обработаны с одинаковым временем ответа, любое отклонение от этого значения предполагает, что за кулисами происходило что-то другое. Это еще один признак того, что угаданное имя пользователя может быть правильным. Например, веб-сайт может проверять правильность пароля только в том случае, если имя пользователя действительно. Этот дополнительный шаг может привести к небольшому увеличению времени ответа. Это может быть незаметно, но злоумышленник может сделать эту задержку более очевидной, введя слишком длинный пароль, на обработку которого веб-сайту потребуется заметно больше времени.

#### Лабы
- [[Лабораторная работа Перечисление имен пользователей по времени ответа]]
- [[Лабораторная работа Перечисление имен пользователей с помощью блокировки учетной записи]]

## Недостаточная защита от грубой силы

Весьма вероятно, что атака методом перебора потребует множества неудачных догадок, прежде чем злоумышленник успешно скомпрометирует учетную запись. Логично, что защита от грубой силы заключается в попытках максимально усложнить автоматизацию процесса и замедлить скорость, с которой злоумышленник может попытаться войти в систему. Двумя наиболее распространенными способами предотвращения атак грубой силы являются:

- **Блокировка учетной записи**, к которой пытается получить доступ удаленный пользователь, если он делает слишком много неудачных попыток входа в систему.
- **Блокировка IP-адреса удаленного пользователя**, если он делает слишком много попыток входа в систему в быстрой последовательности.

Оба подхода предлагают разную степень защиты, но ни один из них не является неуязвимым, особенно если он реализован с использованием ошибочной логики.

#### Блокировка IP-адреса

Например, иногда вы можете обнаружить, что ваш IP-адрес заблокирован, если вам не удается войти в систему слишком много раз. В некоторых реализациях счетчик количества неудачных попыток сбрасывается, если владелец IP успешно входит в систему. Это означает, что злоумышленнику просто придется входить в свою учетную запись каждые несколько попыток, чтобы предотвратить достижение этого предела.

В этом случае простого включения ваших собственных учетных данных через регулярные промежутки времени в список слов достаточно, чтобы сделать эту защиту практически бесполезной.

==При блокировке на кол. запросов попробовать заголовок `X-Forwarded-For`== работает как подмена айпи адреса.
##### Лаба
[[Лабораторная работа Взлом защиты от перебора, блокировка IP]]

#### Блокировка учётки

Блокировка учетной записи обеспечивает определенную степень защиты от целенаправленного перебора конкретной учетной записи. Однако этот подход не может адекватно предотвратить атаки методом перебора, при которых злоумышленник просто пытается получить доступ к любой случайной учетной записи, которую он может.

Для обхода защиты можно использовать следующий метод:

1. Создать список имен пользователей-кандидатов, которые могут оказаться действительными. Это может быть посредством перечисления имен пользователей или просто на основе списка общих имен пользователей.

2. Определить очень небольшой список паролей, которые, по вашему мнению, могут быть у хотя бы одного пользователя. Важно отметить, что количество выбранных паролей не должно превышать количество разрешенных попыток входа в систему. Например, если установлено, что ограничение составляет 3 попытки, вам нужно выбрать максимум 3 попытки угадать пароль.

Блокировка учетной записи также не может защитить от атак с подтасовкой учетных данных. Это предполагает использование огромного словаря `username:password` пары, состоящие из подлинных учетных данных для входа, украденных в результате утечки данных.

##### Лаба
[[Лабораторная работа Перечисление имен пользователей с помощью блокировки учетной записи]]

## Базовая HTTP-аутентификация

Довольно старый, его относительная простота и легкость реализации означают, что иногда он встречается в использование базовой аутентификации HTTP. При базовой аутентификации [[Всемирная паутина#HTTP и HTTPS|HTTP]] клиент **получает от сервера токен аутентификации, который создается путем объединения имени пользователя и пароля и их кодирования в Base64.** Этот токен хранится и управляется браузером, который автоматически добавляет его в `Authorization` заголовок каждого последующего запроса следующим образом:
`Authorization: Basic base64(username:password)`

По ряду причин этот метод обычно не считается безопасным методом аутентификации. Во-первых, он предполагает повторную отправку учетных данных пользователя при каждом запросе. Если на веб-сайте также не реализован [[Pentest/Термины#HSTS (HTTP Strict Transport Security)|HSTS]], учетные данные пользователя могут быть перехвачены в результате атаки «человек посередине».

Кроме того, реализации базовой аутентификации HTTP часто не поддерживают защиту от перебора. Поскольку токен состоит исключительно из статических значений, это может сделать его уязвимым для грубого взлома.

Базовая аутентификация HTTP также особенно уязвима для эксплойтов, связанных с сеансом, в частности [[Cross-Site Request Forgery, CSRF|CSRF]], от которых она сама по себе не обеспечивает защиты.

В некоторых случаях использование уязвимой базовой аутентификации HTTP может предоставить злоумышленнику доступ только к, казалось бы, неинтересной странице. Однако, помимо предоставления дополнительной поверхности для атаки, предоставленные таким образом учетные данные могут быть повторно использованы в других, более конфиденциальных контекстах.

#### Лаба
[[Лабораторная работа Взлом паролей в автономном режиме]]