
# Уязвимости Аутентификации делятся на 3 вида:

- Уязвимости входа в систему по паролю
- Уязвимости в многофакторной аутентификации
- Уязвимости в других механизмах аутентификации

# Уязвимости входа в систему по паролю. Атака brute force 

Слабое звено либо пользователь либо пользователь и система защиты от брутфорса

## 1. Пароль пользователя слаб по причине отсутствия форм политик паролей 

Обычно это включает в себя принудительное использование паролей с помощью:
- Минимальное количество символов
- Смесь строчных и прописных букв
- Хотя бы один специальный символ

пользователи обычно вносят незначительные, предсказуемые изменения в свой предпочтительный пароль. Например, `Mypassword` становится `Mypassword1!` или `Mypassword2?.`

## 2. Изменения поведения объекта при перечисления имён пользователей 

Это может быть 
- Коды состояния
- Сообщения об ошибках
- Время ответа: при верном логине обработка длинного пароля может занять больше времени

## 3. Недостаточная защита от грубой силы

- **Блокировка учетной записи**, к которой пытается получить доступ удаленный пользователь, если он делает слишком много неудачных попыток входа в систему.
- **Блокировка IP-адреса удаленного пользователя**, если он делает слишком много попыток входа в систему в быстрой последовательности.

#### 3.1 Обход блокировки IP-адреса

- Вход в свою учётку каждую n попытку
- Заголовок X-Forwarded-For
- Список proxy
- Массив паролей за раз
#### 3.2 Обход блокировки учетной записи

- Сделать разведку выявив точные логины и оформить список из минимального кол. паролей которые точно у кого то встретятся

## 4. Базовая HTTP-аутентификация

- хранит хэш пароля пользователя в файле cookie в простой форме: base64(username:MD5(password))


----
# Уязвимости в многофакторной аутентификации

Все преимущества многофакторной аутентификации достигаются только за счет проверки нескольких различных факторов.Проверка одного и того же фактора двумя разными способами не является настоящей двухфакторной аутентификацией. 
	2FA на основе электронной почты — один из таких примеров. Хотя пользователь должен предоставить пароль и код подтверждения, доступ к коду зависит только от того, что он знает учетные данные для входа в свою учетную запись электронной почты. Таким образом, фактор аутентификации знаний просто проверяется дважды.


## Неверная логика двухфакторной проверки

Если пользователю сначала предлагается ввести пароль, а затем на отдельной странице предлагается ввести код подтверждения, пользователь фактически находится в состоянии «вошел в систему» ​​до того, как ввел код подтверждения

- Cookie аутентификации назначаются после ввода пароля а не 2FA, тем самым можно войти в свой аккаунт с 2FA а после заменить Cookie 

- Brute Force 2FA кода если он не имеет защиты и имеет простую форму 4/6-значные числа

- Слабая защита от брута 2FA (выход из учётки без блока). Использовать макросы

----
# Уязвимости в других механизмах аутентификации

- Удержание пользователей в системе
- Сброс паролей пользователей: по почте, с помощью URL-адреса
- Изменения пароля 
## Удержание пользователей в системе

- Уязвимая шифровка cookie файлов "Запомнить меня", разобраться как генерируется и создать свой собственный

- Уязвимость к xss атаке или csrf. В зависимости от настроек передачи cookie файлов, httpOnly [[Обход ограничений файлов cookie SameSite|SameSite]]


## Сброс паролей пользователей: по почте

- отправка пароля по незащищённому каналу, MITM
- Пароль для сброса не имеет короткого период времени действия

## Сброс паролей с помощью URL-адреса

- URL-адрес с легко угадываемым параметром
- Неверная проверка токена для сброса в системе
- Если URL-адрес в электронном письме для сброса генерируется динамически, то вариант переадресации отправки при помощи заголовка X-Forwarded-Host

## Изменения пароля 

- Смена пароля не привязана к сессии пользователя 
- Смена пароля имеет различные ответы на вводные данные: 
	верный_пароль:одинаковые_пароли1_2 - ответ 200
	верный_пароль:разные_пароли1_2 - ответ "New passwords do not match"
	не_верный_пароль:разные_пароли1_2 - ответ "Current password is incorrect"


