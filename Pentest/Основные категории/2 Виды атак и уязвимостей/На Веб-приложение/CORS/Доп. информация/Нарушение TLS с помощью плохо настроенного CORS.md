Предположим, что приложение, которое строго использует HTTPS, также вносит в белый список доверенный поддомен, использующий обычный HTTP. Например, когда приложение получает следующий запрос:

```
GET /api/requestApiKey HTTP/1.1 
Host: vulnerable-website.com 
Origin: http://trusted-subdomain.vulnerable-website.com 
Cookie: sessionid=...
```

Приложение отвечает:
```
HTTP/1.1 200 OK 
Access-Control-Allow-Origin: http://trusted-subdomain.vulnerable-website.com Access-Control-Allow-Credentials: true
```

В этой ситуации злоумышленник, который имеет возможность перехватить трафик пользователя-жертвы, может использовать конфигурацию CORS для компрометации взаимодействия жертвы с приложением. Эта атака включает в себя следующие шаги:

- Пользователь-жертва выполняет любой простой HTTP-запрос.
- Злоумышленник внедряет перенаправление на:
    `http://trusted-subdomain.vulnerable-website.com`
- Браузер жертвы следует перенаправлению.
- Злоумышленник перехватывает простой HTTP-запрос и возвращает поддельный ответ, содержащий CORS-запрос на: 
    `https://vulnerable-website.com`
- Браузер жертвы отправляет запрос CORS, включая источник:
    `http://trusted-subdomain.vulnerable-website.com`
- Приложение разрешает запрос, поскольку это источник из белого списка . Запрошенные конфиденциальные данные возвращаются в ответе.
- Поддельная страница злоумышленника может считывать конфиденциальные данные и передавать их на любой домен, находящийся под контролем злоумышленника.

Эта атака эффективна, даже если уязвимый веб-сайт в остальном надежно использует HTTPS, не имеет конечной точки HTTP и все файлы cookie помечены как безопасные.