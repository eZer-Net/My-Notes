# Что такое отравление веб-кэша?

Отравление веб-кэша — это техника, при которой злоумышленник использует поведение веб-сервера и кэша, чтобы отправить другим пользователям вредоносный HTTP-ответ.

По сути, отравление веб-кэша включает в себя два этапа. 
1. Во-первых, злоумышленник должен выяснить, как получить ответ от внутреннего сервера, который непреднамеренно содержит какую-то опасную полезную нагрузку. 
2. После успеха им нужно убедиться, что их ответ кэшируется и впоследствии доставляется предполагаемым жертвам.

Зараженный веб-кэш может стать потенциально разрушительным средством распространения множества различных атак, эксплуатирующих такие уязвимости, как XSS, инъекции JavaScript, открытое перенаправление и т. д.


# Каковы последствия атаки отравления веб-кэша?

Влияние отравления веб-кэша во многом зависит от двух ключевых факторов:

- **Что именно атакующий может успешно кэшировать**  
    Поскольку ==отравленный кэш является средством распространения==, чем отдельной атакой, воздействие отравления веб-кеша неразрывно связано с тем, насколько вредоносна внедренная полезная нагрузка. Как и в случае с большинством видов атак, отравление веб-кеша также может использоваться в сочетании с другими атаками для еще большего усиления потенциального воздействия.
- **Объем трафика на затронутой странице**  
	Отравленный ответ будет показан только пользователям, которые посещают затронутую страницу, пока кэш отравлен. В результате воздействие может варьироваться от несуществующего до огромного в зависимости от того, популярна страница или нет. Если злоумышленнику удалось отравить кэшированный ответ на домашней странице крупного веб-сайта, например, атака может затронуть тысячи пользователей без какого-либо последующего взаимодействия со стороны злоумышленника.

**Обратитm внимание**, что длительность записи в кэше не обязательно влияет на воздействие отравления веб-кэша. Атака обычно может быть написана таким образом, что она будет повторно отравлять кэш бесконечно.

# Создание атаки отравления веб-кэша

В общем случае построение базовой атаки отравления веб-кэша включает в себя следующие этапы:

1. Определить и оценить неиспользуемые входные данные
2. Вызвать вредоносный ответ от внутреннего сервера
3. Получить кэшированный ответ

### Определить и оценить неиспользуемые входные данные
Любая атака отравления веб-кэша основана на манипуляции неключевыми входными данными, такими как заголовки. Веб-кэши игнорируют неключевые входные данные при принятии решения о том, предоставлять ли пользователю кэшированный ответ. Такое поведение означает, что вы можете использовать их для внедрения своей полезной нагрузки и получения «отравленного» ответа, который, если он кэширован, будет предоставлен всем пользователям, чьи запросы имеют соответствующий ключ кэша. Поэтому первым шагом при построении атаки отравления веб-кэша является определение неключевых входных данных, которые поддерживаются сервером.

Вы можете вручную идентифицировать неключевые входы, добавляя случайные входы к запросам и наблюдая, оказывают ли они влияние на ответ. Это может быть очевидным, например, прямое отражение ввода в ответе или запуск совершенно другого ответа. Однако иногда эффекты более тонкие и требуют некоторой детективной работы, чтобы выяснить их. Вы можете использовать такие инструменты, как Burp Comparer, чтобы сравнить ответ с введенным вводом и без него, но это все еще требует значительного объема ручных усилий.