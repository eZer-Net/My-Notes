## Как проверить уязвимости раскрытия информации

Вообще говоря, важно не развивать «туннельное зрение» во время тестирования. Другими словами, вам следует избегать слишком узкой фокусировки на конкретной уязвимости. Конфиденциальные данные могут утекать в самых разных местах, поэтому важно не упустить ничего, что может оказаться полезным позже. Вы часто будете находить конфиденциальные данные во время тестирования чего-то другого. Ключевой навык — способность распознавать интересную информацию, когда и где бы вы с ней ни сталкивались.

Ниже приведены некоторые примеры высокоуровневых методов и инструментов, которые можно использовать для выявления уязвимостей раскрытия информации во время тестирования.

- [[Как найти и использовать уязвимости раскрытия информации#Фаззинг|Фаззинг]]
- [[Как найти и использовать уязвимости раскрытия информации#Использование инструментов взаимодействия Burp|Использование инструментов взаимодействия Burp]]
- [[Как найти и использовать уязвимости раскрытия информации#Разработка информативных ответов|Разработка информативных ответов]]

### Фаззинг

Если мы определили интересные параметры, то можем попробовать отправить неожиданные типы данных и специально созданные строки fuzz, чтобы увидеть, какой эффект это даст. **Обратить пристальное внимание**; хотя ответы иногда явно раскрывают интересную информацию, они также могут намекать на поведение приложения более тонко. Например, **это может быть небольшая разница во времени, затраченном на обработку запроса**. Даже если **содержание сообщения об ошибке ничего не раскрывает, иногда тот факт, что был обнаружен один случай ошибки вместо другого, сам по себе является полезной информацией.**

Мы можем автоматизировать большую часть этого процесса с помощью таких инструментов, как Burp Intruder или FUZZ. Это дает несколько преимуществ. В частности, вы можете:

- Добавить позиции полезной нагрузки к параметрам и используйте готовые списки слов нечетких строк для тестирования большого объема различных входных данных в быстрой последовательности.
- Легко выявляйте различия в ответах, сравнивая коды статуса HTTP, время ответа, длину и т. д.
- Использовать правила сопоставления grep для быстрого определения вхождений ключевых слов, таких как `error`, `invalid`, `SELECT`, `SQL`и т. д.
- Применять правила извлечения grep для извлечения и сравнения содержимого интересных элементов в ответах.

Мы также можем использовать расширение [Logger++](https://portswigger.net/bappstore/470b7057b86f41c396a97903377f3d81) , доступное в магазине BApp. Помимо регистрации запросов и ответов от всех инструментов Burp, оно позволяет определять расширенные фильтры для выделения интересных записей. Это лишь одно из многих расширений Burp, которые могут помочь найти любые конфиденциальные данные, которые были украдены веб-сайтом.

### Использование инструментов взаимодействия Burp

Burp предоставляет несколько инструментов взаимодействия, которые мы можем использовать для более легкого поиска интересной информации на целевом веб-сайте. Мы можем получить доступ к инструментам взаимодействия из контекстного меню — просто щелкнув правой кнопкой мыши по любому HTTP-сообщению, записи Burp Proxy или элементу на карте сайта и перейдите в "Engagement tools".

В этом контексте особенно полезны следующие инструменты.

#### Search

Мы можем использовать этот инструмент для поиска любого выражения в выбранном элементе. Мы можем точно настроить результаты, используя различные расширенные параметры поиска, такие как ==поиск по регулярным выражениям== или отрицательный поиск. Это полезно для быстрого поиска вхождений (или отсутствия) определенных ключевых слов, представляющих интерес.

#### Find comments

Можно использовать этот инструмент для быстрого извлечения любых комментариев разработчиков, найденных в выбранном элементе. Он также предоставляет вкладки для мгновенного доступа к циклу HTTP-запроса/ответа, в котором был найден каждый комментарий.
#### Discover content

Этот инструмент используется для определения дополнительного контента и функциональности, которые не связаны с видимым контентом веб-сайта. Это может быть полезно для поиска дополнительных каталогов и файлов, которые не обязательно будут автоматически отображаться на карте сайта.

### Разработка информативных ответов

Подробные сообщения об ошибках иногда могут раскрывать интересную информацию, пока мы занимаемся обычным рабочим процессом тестирования. Однако, ==изучая, как сообщения об ошибках меняются в зависимости от нашего ввода, мы можем сделать еще один шаг вперед.== В некоторых случаях мы сможем манипулировать веб-сайтом, чтобы извлечь произвольные данные с помощью сообщения об ошибке.

Существует множество методов сделать это в зависимости от конкретного сценария, с которым мы сталкиваемся. Одним из распространенных примеров является попытка логики приложения выполнить недопустимое действие с определенным элементом данных. Например, отправка недопустимого значения параметра может привести к трассировке стека или ответу отладки, содержащему интересные подробности. Иногда мы можем заставить сообщения об ошибках раскрывать значение желаемых нами данных в ответе.

## Распространенные источники раскрытия информации

Раскрытие информации может происходить в самых разных контекстах на веб-сайте. Ниже я привел некоторые общие примеры мест, где можно проверить, раскрыта ли конфиденциальная информация.

- [[Как найти и использовать уязвимости раскрытия информации#Файлы для веб-сканеров|Файлы для веб-сканеров]]
- [[Как найти и использовать уязвимости раскрытия информации#Списки каталогов|Списки каталогов]]
- [[Как найти и использовать уязвимости раскрытия информации#Комментарии разработчиков|Комментарии разработчиков]]
- [[Как найти и использовать уязвимости раскрытия информации#Сообщения об ошибках|Сообщения об ошибках]]
- [[Как найти и использовать уязвимости раскрытия информации#Отладка данных|Отладка данных]]
- [[Как найти и использовать уязвимости раскрытия информации#Страницы учетной записи пользователя|Страницы учетной записи пользователя]]
- [[Как найти и использовать уязвимости раскрытия информации#Раскрытие исходного кода через файлы резервных копий|Резервные файлы]]
- [[Как найти и использовать уязвимости раскрытия информации#Раскрытие информации из-за небезопасной конфигурации|Небезопасная конфигурация]]
- [История контроля версий]

### Файлы для веб-сканеров

Многие веб-сайты предоставляют файлы на `/robots.txt`и `/sitemap.xml`для помощи сканерам в навигации по сайту. Помимо прочего, эти файлы часто содержат список определенных каталогов, которые сканеры должны пропускать, например, потому что они могут содержать конфиденциальную информацию.

Поскольку эти файлы обычно не связаны с сайтом, они могут не сразу появиться на карте сайта Burp. Тем не менее, стоит попробовать перейти к `/robots.txt`или `/sitemap.xml`вручную, чтобы посмотреть, найдем ли мы что-нибудь полезное.

### Списки каталогов

Веб-серверы можно настроить на автоматическое перечисление содержимого каталогов, в которых отсутствует индексная страница. Это может помочь злоумышленнику, позволяя ему быстро идентифицировать ресурсы по заданному пути и перейти непосредственно к анализу и атаке на эти ресурсы. Это особенно увеличивает уязвимость конфиденциальных файлов в каталоге, которые не предназначены для доступа пользователей, таких как временные файлы и аварийные дампы.

Сами по себе списки каталогов не обязательно являются уязвимостью безопасности. Однако если веб-сайт также не реализует надлежащий контроль доступа, утечка существования и местоположения конфиденциальных ресурсов таким образом, несомненно, является проблемой.

### Комментарии разработчиков

В процессе разработки в разметку иногда добавляются встроенные комментарии HTML. Эти комментарии обычно удаляются перед тем, как изменения будут развернуты в рабочей среде. Однако комментарии иногда могут быть забыты, пропущены или даже оставлены намеренно, потому что кто-то не был полностью осведомлен о последствиях для безопасности. Хотя эти комментарии не видны на визуализированной странице, к ним можно легко получить доступ с помощью Burp или даже встроенных в браузер инструментов разработчика.

Иногда эти комментарии содержат информацию, полезную для нас. Например, они могут намекать на существование скрытых каталогов или давать подсказки о логике приложения.

### Сообщения об ошибках

Одной из наиболее распространенных причин ==раскрытия информации являются подробные сообщения об ошибках==. Как правило, следует уделять пристальное внимание всем сообщениям об ошибках, с которыми мы сталкиваемся во время аудита.

Содержание сообщений об ошибках может раскрыть информацию о том, какой ввод или тип данных ожидается от данного параметра. Это может помочь сузить атаку, определив эксплуатируемые параметры. Это может даже просто уберечь от траты времени на попытки внедрить полезные нагрузки, которые просто не будут работать.

Подробные сообщения об ошибках также могут предоставлять информацию о различных технологиях, используемых веб-сайтом. Например, они могут явно указывать шаблонизатор, тип базы данных или сервер, который использует веб-сайт, а также номер его версии. Эта информация может быть полезна, поскольку мы можем легко найти любые задокументированные эксплойты, которые могут существовать для этой версии. Аналогичным образом можно проверить, есть ли какие-либо распространенные ошибки конфигурации или опасные настройки по умолчанию, которые мы можем использовать. Некоторые из них могут быть выделены в официальной документации.

Также можно обнаружить, что веб-сайт использует какой-то фреймворк с открытым исходным кодом. В этом случае мы можем изучить общедоступный исходный код, который является бесценным ресурсом для создания собственных эксплойтов.

Различия между сообщениями об ошибках также могут выявить различное поведение приложения, которое происходит за кулисами. Наблюдение за различиями в сообщениях об ошибках является важнейшим аспектом многих методов, таких как SQL-инъекция, перечисление имен пользователей и т. д.

### Отладка данных

Для целей отладки многие веб-сайты генерируют пользовательские сообщения об ошибках и журналы, которые содержат большой объем информации о поведении приложения. Хотя эта информация полезна во время разработки, она также чрезвычайно полезна для злоумышленника, если она просочится в производственную среду.

Отладочные сообщения иногда могут содержать важную информацию для разработки атаки, в том числе:

- Значения ключевых переменных сеанса, которыми можно манипулировать с помощью пользовательского ввода
- Имена хостов и учетные данные для внутренних компонентов
- Имена файлов и каталогов на сервере
- Ключи, используемые для шифрования данных, передаваемых через клиент

Отладочная информация иногда может регистрироваться в отдельном файле. Если злоумышленник сможет получить доступ к этому файлу, он может послужить полезным справочником для понимания состояния выполнения приложения. Он также может дать несколько подсказок относительно того, как они могут поставлять созданные входные данные для манипулирования состоянием приложения и контролировать полученную информацию.

### Страницы учетной записи пользователя

По своей природе профиль пользователя или страница учетной записи обычно содержат конфиденциальную информацию, такую ​​как адрес электронной почты пользователя, номер телефона, ключ API и т. д. Поскольку пользователи обычно имеют доступ только к своей странице учетной записи, это само по себе не является уязвимостью. Однако некоторые веб-сайты содержат [[Уязвимости бизнес-логики|логические изъяны]] (к примеру IDOR), которые потенциально позволяют злоумышленнику использовать эти страницы для просмотра данных других пользователей.

### Раскрытие исходного кода через файлы резервных копий

Конфиденциальные данные иногда даже жестко закодированы в исходном коде. Типичными примерами этого являются ключи API и учетные данные для доступа к внутренним компонентам.

Если мы можем определить, что используется конкретная технология с открытым исходным кодом, это обеспечивает легкий доступ к ограниченному объему исходного кода.

Иногда даже возможно заставить веб-сайт раскрыть свой собственный исходный код. При составлении карты веб-сайта мы можем обнаружить, что некоторые файлы исходного кода явно указаны. К сожалению, запрос их обычно не раскрывает сам код. Когда сервер обрабатывает файлы с определенным расширением, например `.php`, , он обычно выполняет код, а не просто отправляет его клиенту в виде текста. Однако в некоторых ситуациях вы можете обмануть веб-сайт, заставив его вернуть содержимое файла. Например, текстовые редакторы ==часто создают временные файлы резервных копий, пока исходный файл редактируется==. Эти временные файлы обычно **указываются каким-либо образом, например, путем добавления тильды ( `~`) к имени файла или добавления другого расширения файла**. Запрос файла кода с использованием расширения файла резервной копии иногда может позволить вам прочитать содержимое файла в ответе.

### Раскрытие информации из-за небезопасной конфигурации

Веб-сайты иногда уязвимы из-за неправильной конфигурации. Это особенно распространено из-за широкого использования сторонних технологий, широкий спектр конфигурационных опций которых не всегда хорошо понятен тем, кто их реализует.

В других случаях разработчики могут забыть отключить различные параметры отладки в производственной среде. Например, `TRACE`метод HTTP предназначен для диагностических целей. Если он включен, веб-сервер будет отвечать на запросы, использующие этот `TRACE`метод, повторяя в ответе точный запрос, который был получен. Такое поведение часто безвредно, но иногда приводит к раскрытию информации, например имени внутренних заголовков аутентификации, которые могут быть добавлены к запросам обратными прокси-серверами.

### История контроля версий

Практически все веб-сайты разрабатываются с использованием какой-либо системы контроля версий, например Git. По умолчанию проект Git хранит все данные контроля версий в папке с именем `.git`. Иногда веб-сайты выставляют этот каталог в производственной среде. В этом случае мы можем получить к нему доступ, просто перейдя по адресу `/.git`.

Хотя часто непрактично вручную просматривать структуру и содержимое необработанных файлов, существуют различные методы загрузки всего `.git`каталога. Затем можно открыть его с помощью локальной установки Git, чтобы получить доступ к истории управления версиями веб-сайта. Это может включать журналы, содержащие зафиксированные изменения и другую интересную информацию.

Это может не дать нам доступа к полному исходному коду, но сравнение diff позволит прочитать небольшие фрагменты кода. Как и в случае с любым исходным кодом, мы также можем обнаружить конфиденциальные данные, жестко закодированные в некоторых измененных строках.

#### Исследование каталога

1. Скачиваем репозиторий
```
wget -r https://YOUR-LAB-ID.web-security-academy.net/.git/
```

2. Инициализируем локальный репозиторий:
```
git init
```

3. Добавим загруженные файлы в индекс:
```
git add .
```

4. Проверим статус репозитория:
```
git status
```

5. Исследуем историю коммитов:
```
git log
```

6. Используя команду `git show`, чтобы просмотреть изменения:
```
git show <хэш_коммита>
```