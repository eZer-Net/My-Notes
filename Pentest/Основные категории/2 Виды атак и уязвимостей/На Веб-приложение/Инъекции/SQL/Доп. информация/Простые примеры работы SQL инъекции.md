## Получение скрытых данных

Приложение для покупок, которое отображает товары в разных категориях. Когда пользователь нажимает на **категорию «Подарки»** , его браузер запрашивает URL-адрес:

`https://insecure-website.com/products?category=Gifts`
Это заставляет приложение выполнять SQL-запрос для получения сведений о соответствующих продуктах из базы данных:

`SELECT * FROM products WHERE category = 'Gifts' AND released = 1`
Этот SQL-запрос просит базу данных вернуть:
- все подробности( `*`)
- из `products` стол
- где `category` является `Gifts`
- и `released` является `1`.

Ограничение `released = 1` используется для сокрытия невыпущенных продуктов. Мы могли бы предположить, что для невыпущенных продуктов `released = 0`.

Приложение не реализует никакой защиты от атак SQL-инъекций. Это означает, что злоумышленник может построить следующую атаку, например:
`https://insecure-website.com/products?category=Gifts'--`

В результате получается SQL-запрос:
`SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1`

Важно отметить, что ==`--` — индикатор комментария в SQL.== Это означает, что остальная часть запроса интерпретируется как комментарий и фактически удаляется. В данном примере это означает, что запрос больше не включает `AND released = 1`. В результате отображаются все продукты, включая те, которые еще не выпущены.

Вы можете использовать подобную атаку, чтобы заставить приложение отображать все продукты в любой категории, включая категории, о которых они не знают:
`https://insecure-website.com/products?category=Gifts'+OR+1=1--`

В результате получается SQL-запрос:
`SELECT * FROM products WHERE category = 'Gifts' OR 1=1--' AND released = 1`

Модифицированный запрос возвращает все элементы, в которых либо `category` является `Gifts`, или `1` равно `1`. Как `1=1` всегда верно, запрос возвращает все элементы.

-----

## Подрыв логики приложения

Представьте себе приложение, которое позволяет пользователям входить в систему, используя имя пользователя и пароль. Если пользователь отправляет имя пользователя `wiener` и пароль `bluecheese`, приложение проверяет учетные данные, выполняя следующий SQL-запрос:
`SELECT * FROM users WHERE username = 'wiener' AND password = 'bluecheese'`

Если запрос возвращает сведения о пользователе, вход в систему успешен. В противном случае оно отклоняется.

В этом случае злоумышленник может войти в систему под любым пользователем без необходимости ввода пароля. Они могут сделать это, используя последовательность комментариев SQL. `--` чтобы убрать проверку пароля из `WHERE` пункт запроса. Например, отправив имя пользователя `administrator' --` и пустой пароль приводит к следующему запросу:
`SELECT * FROM users WHERE username = 'administrator' --' AND password = ''`

Этот запрос возвращает пользователя, чей `username` является `administrator` и успешно регистрирует злоумышленника под этим пользователем.