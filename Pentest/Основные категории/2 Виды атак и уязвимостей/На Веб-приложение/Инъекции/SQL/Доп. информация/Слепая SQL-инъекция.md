
## Что такое слепая SQL-инъекция?

Слепая SQL-инъекция происходит, когда приложение уязвимо для SQL-инъекции, но его HTTP-ответы не содержат результатов соответствующего SQL-запроса или сведений об ошибках базы данных.

Многие методы, такие как `UNION` атаки не эффективны при использовании уязвимостей слепого внедрения SQL. Это связано с тем, что они полагаются на возможность видеть результаты внедренного запроса в ответах приложения. Слепую SQL-инъекцию по-прежнему можно использовать для доступа к неавторизованным данным, но для этого необходимо использовать другие методы.

## Использование слепой SQL-инъекции путем запуска условных ответов

Рассмотрим приложение, которое использует файлы cookie отслеживания для сбора аналитики об использовании. Запросы к приложению включают заголовок cookie следующим образом:
`Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4`

Когда запрос, содержащий `TrackingId` cookie обрабатывается, приложение использует SQL-запрос, чтобы определить, является ли это известным пользователем:
`SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'`

Этот запрос уязвим для внедрения SQL, но результаты запроса не возвращаются пользователю. Однако приложение ведет себя по-разному в зависимости от того, возвращает ли запрос какие-либо данные. Если вы представите признанный `TrackingId`, запрос возвращает данные, и в ответ вы получаете сообщение «С возвращением».

Такого поведения достаточно, чтобы иметь возможность использовать уязвимость слепого внедрения SQL. Вы можете получить информацию, вызывая различные реакции по условию, в зависимости от введенного условия.

### Вариант поиска/проверки

Чтобы понять, как работает этот эксплойт, предположим, что отправлены два запроса, содержащие следующее: `TrackingId` значения cookie по очереди:
```
…xyz' AND '1'='1 
…xyz' AND '1'='2
```
**Булевые выражения**

- Первое из этих значений приводит к тому, что запрос возвращает результаты, поскольку введенное `AND '1'='1` условие верное. В результате отображается сообщение «Добро пожаловать обратно».
- Второе значение приводит к тому, что запрос не возвращает никаких результатов, поскольку введенное условие является ложным. Сообщение «С возвращением» не отображается.

Это позволяет нам определить ответ на любое отдельное введенное условие и извлекать данные по частям.

#### Пример

Например, предположим, что существует таблица с именем `Users` с колоннами `Username` и `Password`, и пользователь `Administrator`. Мы можете определить пароль для этого пользователя, отправив серию входных данных для проверки пароля по одному символу.

##### Для этого начнём со следующего ввода:
```
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 'm
```

Данное выражение обозначает:
•  И  извлечь значение пароля из таблицы Users для пользователя с именем Administrator (SUBSTRING - подзапрос в завимимости от бд отличается [подсказка](https://portswigger.net/web-security/sql-injection/cheat-sheet))

•  SUBSTRING(..., 1, 1) - берет результат подзапроса (то есть пароль администратора) и извлекает из него первый символ. Параметры: 
- Первый параметр — строка, из которой нужно извлечь подстроку.
- Второй параметр — начальная позиция (в SQL индексация начинается с 1).
- Третий параметр — длина извлекаемой подстроки (в данном случае 1 символ).

 •   'm' - это сравнение первого символа пароля администратора с буквой 'm'.
   В SQL символы сравниваются по их ASCII-коду или по алфавитному порядку. Если первый символ пароля больше 'm', то условие будет истинным.

###### Далее мы отправляем следующий ввод:
```
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 't
```
Это не возвращает сообщение «Добро пожаловать обратно», указывающее, что введенное условие является ложным, и поэтому первый символ пароля не превышает `t`.

### Пример лабы
[[Лабораторная работа Слепое внедрение SQL с условными ответами]]


### [[SQL-инъекция на основе ошибок#Использование слепой SQL-инъекции путем вызова условных ошибок|Использование слепой SQL-инъекции путем вызова условных ошибок]]










