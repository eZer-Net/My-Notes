
## Что такое небезопасные прямые ссылки на объекты (IDOR)?

Небезопасные прямые ссылки на объекты (IDOR) — это тип уязвимости контроля доступа, которая возникает, когда приложение использует вводимые пользователем данные для прямого доступа к объектам. Термин IDOR стал популярен после его появления в десятке лучших OWASP 2007 года. Однако это всего лишь один пример из множества ошибок реализации контроля доступа, которые могут привести к обходу контроля доступа. Уязвимости IDOR чаще всего связаны с горизонтальным повышением привилегий, но они также могут возникать в связи с вертикальным повышением привилегий.

## Примеры IDOR

Существует множество примеров уязвимостей контроля доступа, когда контролируемые пользователем значения параметров используются для прямого доступа к ресурсам или функциям.

### Уязвимость IDOR с прямой ссылкой на объекты базы данных

Рассмотрим веб-сайт, который использует следующий URL-адрес для доступа к странице учетной записи клиента, извлекая информацию из внутренней базы данных:
```
https://insecure-website.com/customer_account?customer_number=132355
```

Здесь номер клиента используется непосредственно как индекс записи в запросах, которые выполняются в базе данных бэкэнда. Если нет других элементов управления, злоумышленник может просто изменить `customer_number`значение, обойдя элементы управления доступом, чтобы просмотреть записи других клиентов. Это пример уязвимости IDOR, приводящей к горизонтальной эскалации привилегий.

Злоумышленник может иметь возможность выполнять горизонтальное и вертикальное повышение привилегий, изменяя пользователя на пользователя с дополнительными привилегиями, обходя при этом контроль доступа. Другие возможности включают эксплуатацию утечки пароля или изменение параметров, когда злоумышленник попадает на страницу учетных записей пользователя, например.

### Уязвимость IDOR с прямой ссылкой на статические файлы

Уязвимости IDOR часто возникают, когда конфиденциальные ресурсы находятся в статических файлах на файловой системе сервера. Например, веб-сайт может сохранять транскрипты сообщений чата на диске, используя инкрементное имя файла, и позволять пользователям извлекать их, посещая URL-адрес, например, следующий:
```
https://insecure-website.com/static/12144.txt
```

В этой ситуации злоумышленник может просто изменить имя файла, чтобы получить расшифровку, созданную другим пользователем, и потенциально получить учетные данные пользователя и другие конфиденциальные данные.