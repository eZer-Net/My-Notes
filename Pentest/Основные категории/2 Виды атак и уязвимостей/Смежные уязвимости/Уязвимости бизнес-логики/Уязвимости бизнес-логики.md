
# Что такое уязвимости бизнес-логики?

Уязвимости бизнес-логики — это недостатки в разработке и реализации приложения, которые позволяют вызвать непреднамеренное поведение. Это потенциально позволяет манипулировать законными функциями для достижения вредоносных целей. Эти недостатки обычно являются результатом неспособности предвидеть необычные состояния приложения, которые могут возникнуть, и, следовательно, неспособности безопасно их обработать.

Логические ошибки часто незаметны для людей, которые не ищут их явно, поскольку они обычно не обнаруживаются при обычном использовании приложения. Однако злоумышленник может воспользоваться особенностями поведения, взаимодействуя с приложением способами, которые разработчики никогда не планировали.

Одной из основных целей бизнес-логики является обеспечение соблюдения правил и ограничений, которые были определены при разработке приложения или функциональности. Грубо говоря, **бизнес-правила диктуют, как приложение должно реагировать при возникновении определенного сценария.** Это включает в себя запрет пользователям совершать действия, которые окажут негативное влияние на бизнес или просто не имеют смысла.

**Ошибки в логике могут позволить злоумышленникам обойти эти правила.** 
- Например, они могут завершить транзакцию, минуя запланированный рабочий процесс покупки. 

- В других случаях нарушенная или отсутствующая проверка данных, предоставленных пользователем, может позволить пользователям вносить произвольные изменения в критически важные для транзакции значения или отправлять бессмысленные входные данные. 

- Передавая неожиданные значения в логику на стороне сервера, злоумышленник потенциально может заставить приложение сделать что-то, чего оно делать не должно.

Логические уязвимости могут быть чрезвычайно разнообразными и ==часто уникальны для приложения и его конкретных функций==. Их выявление часто требует определенного объема человеческих знаний, например, понимания сферы бизнеса или целей злоумышленника в данном контексте. Это затрудняет их обнаружение с помощью автоматических сканеров уязвимостей. В результате логические ошибки становятся отличной мишенью для охотников за ошибками и ручных тестировщиков в целом.

## Как возникают уязвимости бизнес-логики?

==Уязвимости бизнес-логики часто возникают из-за того, что команды проектирования и разработки делают ошибочные предположения о том, как пользователи будут взаимодействовать с приложением.== Эти плохие предположения могут привести к неадекватной проверке ввода пользователя. Например, если разработчики предполагают, что пользователи будут передавать данные исключительно через веб-браузер, приложение может полностью полагаться на слабые средства контроля на стороне клиента для проверки ввода. Их легко обходит злоумышленник с помощью перехватывающего прокси-сервера.

В конечном итоге это означает, что когда поведение злоумышленника отклоняется от ожидаемого пользователем, приложение не предпринимает соответствующих мер для предотвращения этого и, следовательно, не может безопасно справиться с ситуацией.

==Логические недостатки особенно распространены в чрезмерно сложных системах, которые даже сама команда разработчиков не полностью понимает.== Чтобы избежать логических недостатков, **разработчикам необходимо понимать приложение в целом**. Это включает в себя понимание того, как различные функции могут быть объединены неожиданным образом. Разработчики, работающие с большими базами кода, могут не иметь глубокого понимания того, как работают все области приложения. Кто-то, работающий над одним компонентом, может сделать ошибочные предположения о том, как работает другой компонент, и, как следствие, непреднамеренно внести серьезные логические недостатки. Если разработчики явно не документируют какие-либо сделанные предположения, уязвимости такого рода легко проникают в приложение.

## Каково влияние уязвимостей бизнес-логики?

Влияние уязвимостей бизнес-логики порой может быть довольно тривиальным. Это широкая категория, и влияние сильно варьируется. Однако любое непреднамеренное поведение может потенциально привести к атакам высокой степени серьезности, если злоумышленник сможет правильно манипулировать приложением. По этой причине в идеале причудливую логику следует исправить, даже если вы не можете понять, как ее использовать самостоятельно. Всегда есть риск, что кто-то другой сможет это сделать.

По сути, влияние любого логического недостатка зависит от того, с какой функциональностью он связан. Если недостаток находится, например, в механизме аутентификации, это может серьезно повлиять на вашу общую безопасность. Злоумышленники могут потенциально использовать это для повышения привилегий или для полного обхода аутентификации, получая доступ к конфиденциальным данным и функциональным возможностям. Это также увеличивает поверхность атаки для других эксплойтов.

Ошибочная логика финансовых транзакций, очевидно, может привести к огромным потерям для бизнеса из-за кражи средств, мошенничества и т. д.

Вам также следует отметить, что даже если логические ошибки не позволяют злоумышленнику получить прямую выгоду, они все равно могут позволить злоумышленнику нанести какой-либо ущерб бизнесу.

----
# Примеры логических ошибок включают в себя:

#### [[Чрезмерное доверие к средствам контроля на стороне клиента|Чрезмерное доверие к средствам контроля на стороне клиента]]
- Фундаментально ошибочным предположением является то, что пользователи будут взаимодействовать с приложением только через предоставленный веб-интерфейс. 

#### [[Неспособность обрабатывать нетрадиционный ввод|Невозможность обработки нетрадиционных входных данных]]
- Сюда входят исключительно большие или исключительно низкие числовые входные данные и аномально длинные строки для текстовых полей

#### [[Делать ошибочные предположения о поведении пользователей|Ошибочные предположения о поведении пользователей]]
- Одной из наиболее распространенных причин логических уязвимостей являются ошибочные предположения о поведении пользователей

#### [[Специфические для предметной области недостатки]]
- Домен — это область или сфера деятельности, к которой относится приложение. Определив деятельность мы можем найти критические уязвимости в бизнес процессах.

#### [[Предоставление оракула шифрования]]



#### [[Расхождения в парсере адресов электронной почты|Расхождения в анализаторе адресов электронной почты]]



----
# [[Предотвращение уязвимостей в бизнес-логики]]

----
# Инструменты

[[Инструмент Burp Suite]]

----
# Дополнительная информация

[[Методика поиска и развития уязвимостей в бизнес логике]]