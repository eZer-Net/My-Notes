
#### Виды [[Модели контроля доступа|моделей контроля доступа]]

#### Подробное описание о [[Привилегии|привилегиях]]

#### Подробное описание о [[Процессы|процессах]]

# 1. При контроле доступа

В зависимости от модели контроля доступа Дискретная/Мандатная... могут быть различные уязвимости.

## При модели контроля доступа DAC

1. При данной модели привилегиями распоряжаются сами пользователи и могут быть такие уязвимости как:

	- Запуск файла от root (используется спец бит **(4)SETUID - от пользователя (2)SGID - от группы**) 
		`find / -perm -6000 -type f -exec ls -ld {} \; 2>/dev/null` - 6 это и от пользователей и от групп искать
	
	- Изменение конфигурационного файла `/etc/sudoers` который позволяет от имени root исполнять команды. Возможно просмотреть `sudo -l` сайт **GTFOBins** хранит в себе список двоичных файлов Unix.
	
	- Избыток прав в файлах или директорий `777` 
		`find / -perm -777 -type f -exec ls -ld {} \; 2>/dev/null` - или `-type d`
	
	- Запуск процессов имеющие избыточные привилегии
		`ps -eo pid,uid,euid,suid,comm | awk '$2 != $3 || $2 != $4'`
			`ps -eo pid,uid,euid,suid,comm`: выводит PID, реальный UID, эффективный UID, сохранённый UID и имя процесса.
		    `awk '$2 != $3 || $2 != $4'`: фильтрует процессы, где реальный UID не совпадает с эффективным или сохранённым UID (это может указывать на использование SETUID/SGID).

## При модели контроля доступа MAC

1. При данной модели контроля пользователи/процессы рассматриваются как объект и субъект(файл).  
	 - Ошибки в настройке политик SELinux/AppArmor 



# Ядро системы

### Уязвимости ядра Linux, связанные с DAC

#### Примеры уязвимостей:

1. **Dirty COW (CVE-2016-5195)**:
    - Уязвимость в механизме Copy-On-Write (COW) ядра Linux, позволяющая повысить привилегии.
        
    - Эксплуатация:
        `./dirtycow /etc/passwd /tmp/passwd.bak`
        (Пример использования эксплойта для изменения файла `/etc/passwd`).

2. **Dirty Pipe (CVE-2022-0847)**:
    - Уязвимость в подсистеме pipe ядра Linux, позволяющая перезаписывать файлы с правами root.
    
    - Эксплуатация:
        `./exploit /etc/passwd`
        (Пример использования эксплойта для изменения системных файлов).

3. **Stack Clash (CVE-2017-1000364)**:
    - Уязвимость, связанная с переполнением стека, позволяющая повысить привилегии.

#### Команды для проверки уязвимостей ядра:

- Проверка версии ядра:
    `uname -r`
    
- Поиск известных уязвимостей для текущей версии ядра:
    `grep -i "CVE" /var/log/syslog`
    
- Использование инструментов для сканирования уязвимостей (например, `lynis`):
    `lynis audit system`