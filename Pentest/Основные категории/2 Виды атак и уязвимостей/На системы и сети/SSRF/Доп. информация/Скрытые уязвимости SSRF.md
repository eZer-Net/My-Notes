Скрытые уязвимости SSRF возникают, если вы можете заставить приложение выдать внутренний HTTP-запрос на предоставленный URL-адрес, но ответ внутреннего запроса не возвращается во внешнем ответе приложения.

Слепой SSRF сложнее эксплуатировать, но иногда он приводит к полному удаленному выполнению кода на сервере или других внутренних компонентах.

## Каково влияние скрытых уязвимостей SSRF?

Влияние скрытых уязвимостей SSRF часто ниже, чем полностью информированных уязвимостей SSRF, из-за их одностороннего характера. Их нельзя просто использовать для получения конфиденциальных данных из серверных систем, хотя в некоторых ситуациях их можно использовать для полного удаленного выполнения кода.

## Как найти и использовать слепые уязвимости SSRF

Самый надежный способ обнаружения скрытых уязвимостей SSRF — использование внеполосных методов (OAST). Это предполагает попытку инициировать HTTP-запрос к внешней системе, которой вы управляете, и мониторинг сетевых взаимодействий с этой системой.

Самый простой и эффективный способ использовать внеполосные методы — использовать Burp Collaborator. Можно использовать Burp Collaborator для создания уникальных доменных имен, отправки их в виде полезных данных в приложение и отслеживания любого взаимодействия с этими доменами. Если наблюдается входящий HTTP-запрос от приложения, то оно уязвимо для SSRF.

#### Примечание 
*При тестировании уязвимостей SSRF обычно наблюдается поиск DNS для предоставленного домена Collaborator, но без последующего HTTP-запроса. Обычно это происходит потому, что приложение попыталось отправить HTTP-запрос к домену, что вызвало первоначальный поиск DNS, но фактический HTTP-запрос был заблокирован фильтрацией на уровне сети. В инфраструктуре довольно часто разрешается исходящий DNS-трафик, поскольку это необходимо для многих целей, но блокируются HTTP-соединения к неожиданным местам назначения.*

Простое выявление скрытой уязвимости SSRF, которая может запускать внеполосные HTTP-запросы, само по себе не обеспечивает путь к возможности использования. Поскольку вы не можете просмотреть ответ на внутренний запрос, это поведение нельзя использовать для изучения содержимого в системах, к которым может обратиться сервер приложений. Однако его по-прежнему можно использовать для поиска других уязвимостей на самом сервере или в других серверных системах. Вы можете слепо прочесывать внутреннее пространство IP-адресов, отправляя полезные данные, предназначенные для обнаружения известных уязвимостей. Если в этих полезных нагрузках также используются слепые внеполосные методы, вы можете обнаружить критическую уязвимость на непропатченном внутреннем сервере.

Другой **способ использования скрытых уязвимостей SSRF — заставить приложение подключиться к системе, находящейся под контролем злоумышленника, и вернуть вредоносные ответы HTTP-клиенту, который устанавливает соединение.** Если вы сможете использовать серьезную уязвимость на стороне клиента в реализации HTTP сервера, вы сможете добиться удаленного выполнения кода в инфраструктуре приложения.

#### Лаба
[[Лабораторная работа Слепой SSRF с обнаружением вне диапазона]]