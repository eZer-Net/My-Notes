
# Что такое контроль доступа?

Контроль доступа — это применение ограничений на то, кто или что уполномочено выполнять действия или получать доступ к ресурсам. ==В контексте веб-приложений контроль доступа зависит от аутентификации и управления сеансами:==

- **Аутентификация** подтверждает, что пользователь является тем, за кого себя выдает.
- **Управление сеансами** определяет, какие последующие HTTP-запросы выполняются тем же пользователем.
- **Контроль доступа** определяет, разрешено ли пользователю выполнять действие, которое он пытается выполнить.

Неисправные элементы управления доступом распространены и часто представляют собой критическую уязвимость безопасности. Проектирование и управление элементами управления доступом — сложная и динамическая проблема, которая накладывает деловые, организационные и юридические ограничения на техническую реализацию. **Решения по проектированию элементов управления доступом должны приниматься людьми, поэтому вероятность ошибок высока.**

## Модели безопасности контроля доступа

Это формально определенное определение набора правил контроля доступа, которое не зависит от технологии или платформы реализации.

#### [[Примеры работ моделей контроля доступа|Примеры работы различных контролей доступа]]


## Вертикальный контроль доступа

Вертикальный контроль доступа — это механизмы, которые ограничивают доступ к конфиденциальным функциям для определенных типов пользователей.

С вертикальным контролем доступа разные типы пользователей имеют доступ к разным функциям приложения. Например, администратор может иметь возможность изменять или удалять учетную запись любого пользователя, в то время как обычный пользователь не имеет доступа к этим действиям. Вертикальный контроль доступа может быть более мелкозернистой реализацией моделей безопасности, разработанных для обеспечения соблюдения бизнес-политик, таких как разделение обязанностей и минимальные привилегии.

## Горизонтальный контроль доступа

Горизонтальный контроль доступа — это механизмы, ограничивающие доступ к ресурсам определенным пользователям.

При горизонтальном управлении доступом разные пользователи имеют доступ к подмножеству ресурсов одного и того же типа. Например, банковское приложение позволит пользователю просматривать транзакции и совершать платежи со своих счетов, но не со счетов любого другого пользователя.

## Контекстно-зависимые элементы управления доступом

Контекстно-зависимые элементы управления доступом ограничивают доступ к функциям и ресурсам в зависимости от состояния приложения или взаимодействия пользователя с ним.

Контекстно-зависимые элементы управления доступом не позволяют пользователю выполнять действия в неправильном порядке. Например, розничный веб-сайт может запретить пользователям изменять содержимое своей корзины покупок после совершения оплаты.

# Примеры неисправных средств контроля доступа

### Вертикальное повышение привилегий

Если пользователь может получить доступ к функциям, к которым ему не разрешен доступ, то это вертикальное повышение привилегий. Например, если пользователь, не являющийся администратором, может получить доступ к странице администратора, где он может удалять учетные записи пользователей, то это вертикальное повышение привилегий.

#### Незащищенная функциональность

В своей основе вертикальное повышение привилегий возникает, когда приложение не обеспечивает никакой защиты для конфиденциальной функциональности. Например, административные функции могут быть связаны со страницей приветствия администратора, но не со страницы приветствия пользователя. Однако пользователь может иметь возможность получить доступ к административным функциям, перейдя по соответствующему URL-адресу администратора.

Например, веб-сайт может размещать конфиденциальные функции по следующему URL-адресу:
```
https://insecure-website.com/admin
```

Это может быть доступно любому пользователю, а не только администраторам, у которых есть ссылка на функционал в их пользовательском интерфейсе. В некоторых случаях административный URL может быть раскрыт в других местах, например в `robots.txt`файле:
```
https://insecure-website.com/robots.txt
```
Даже если URL-адрес нигде не раскрыт, злоумышленник может использовать список слов, чтобы методом подбора определить местоположение конфиденциальной функции.


**В некоторых случаях конфиденциальная функциональность скрывается путем присвоения ей менее предсказуемого URL. Это пример так называемой «безопасности через неизвестность».** Однако сокрытие конфиденциальной функциональности не обеспечивает эффективного контроля доступа, поскольку пользователи могут обнаружить замаскированный URL несколькими способами.

Представим себе приложение, которое размещает административные функции по следующему URL-адресу:
```
https://insecure-website.com/administrator-panel-yb556
```

Это может быть не угадываемым напрямую злоумышленником. Однако приложение все равно может передать URL пользователям. URL может быть раскрыт в JavaScript, который создает пользовательский интерфейс на основе роли пользователя:
```
<script> 
	var isAdmin = false; 
	if (isAdmin) 
	{ 
		... 
		var adminPanelTag = document.createElement('a');
		adminPanelTag.setAttribute('href', 'https://insecure-website.com/administrator-panel-yb556'); 
		adminPanelTag.innerText = 'Admin panel'; ... } 
</script>
```

#### Методы контроля доступа на основе параметров

Некоторые приложения определяют права доступа или роль пользователя при входе в систему, а затем сохраняют эту информацию в контролируемом пользователем месте. Это может быть:
- Скрытое поле.
- Cookie.
- Предварительно заданный параметр строки запроса.

Приложение принимает решения по контролю доступа на основе представленного значения. Например:
```
https://insecure-website.com/login/home.jsp?admin=true 
https://insecure-website.com/login/home.jsp?role=1
```

#### Лаба
[[Лабораторная работа Роль пользователя можно изменить в профиле пользователя]]

#### Нарушение контроля доступа из-за неправильной настройки платформы

Некоторые приложения обеспечивают контроль доступа на уровне платформы. Они делают это, ограничивая доступ к определенным URL-адресам и методам HTTP на основе роли пользователя. Например, приложение может настроить правило следующим образом:
```
DENY: POST, /admin/deleteUser, managers
```

Это правило запрещает доступ к `POST`методу URL `/admin/deleteUser`для пользователей в группе менеджеров. В этой ситуации могут возникнуть различные проблемы, что приведет к обходу контроля доступа.

==Некоторые фреймворки приложений поддерживают различные нестандартные заголовки HTTP, которые можно использовать для переопределения URL в исходном запросе, например== `X-Original-URL`и `X-Rewrite-URL`. Если веб-сайт использует строгие элементы управления front-end для ограничения доступа на основе URL, но приложение позволяет переопределять URL через заголовок запроса, то можно обойти элементы управления доступом с помощью запроса, подобного следующему:
```
POST / HTTP/1.1 
X-Original-URL: /admin/deleteUser 
...
```

#### Лаба
[[Лабораторная работа можно обойти контроль доступа на основе URL-адресов]]

Альтернативная атака связана с методом HTTP, используемым в запросе. Элементы управления front-end, описанные в предыдущих разделах, ограничивают доступ на основе URL и метода HTTP. Некоторые веб-сайты допускают различные методы HTTP-запросов при выполнении действия. Если злоумышленник может использовать этот `GET`(или другой) метод для выполнения действий по ограниченному URL, он может обойти контроль доступа, реализованный на уровне платформы.

#### Лаба
[[Лабораторная работа контроль доступа на основе методов можно обойти]]