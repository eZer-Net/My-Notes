Традиционный способ доказать, что мы нашли уязвимость межсайтового скриптинга, — создать всплывающее окно с помощью `alert()`функции.

Чтобы пойти дальше и доказать, что уязвимость XSS представляет собой реальную угрозу, мы должны предоставить полный эксплойт. В этом разделе описаны три самых популярных и мощных способа эксплуатации уязвимости XSS в зависимости от типа уязвимости.

## Использование межсайтового скриптинга для кражи файлов cookie

Кража куки — традиционный способ эксплуатации XSS. Большинство веб-приложений используют куки для обработки сеансов. Мы можем использовать уязвимости межсайтового скриптинга, чтобы отправлять куки жертвы на свой домен, а затем вручную внедрять куки в браузер и выдавать себя за жертву.

На практике этот подход имеет ряд существенных ограничений:

- Жертва, возможно, не вошла в систему.
- Многие приложения скрывают свои файлы cookie от JavaScript с помощью`HttpOnly`флага.
- Сеансы могут быть заблокированы по дополнительным факторам, таким как IP-адрес пользователя.
- Время сеанса может истечь до того, как вы успеете его перехватить.

#### Лаба
[[Лабораторная работа использование межсайтового скриптинга для кражи файлов cookie]]

## Использование межсайтового скриптинга для перехвата паролей

В наши дни у многих пользователей есть менеджеры паролей, которые автоматически заполняют их пароли. Мы можем воспользоваться этим, создав поле ввода пароля, считав автоматически заполненный пароль и отправив его на свой домен. Этот метод позволяет избежать большинства проблем, связанных с кражей файлов cookie, и даже может получить доступ к любой другой учетной записи, где жертва повторно использовала тот же пароль.

Основным недостатком этого метода является то, что **он работает только для пользователей, у которых есть менеджер паролей, выполняющий автоматическое заполнение паролей**. (Конечно, если у пользователя не сохранен пароль, вы все равно можете попытаться получить его пароль с помощью фишинговой атаки на сайте, но это не совсем то же самое.)

#### Лаба
[[Лабораторная работа использование межсайтового скриптинга для перехвата паролей]]

## Использование межсайтового скриптинга для обхода защиты CSRF

XSS позволяет злоумышленнику делать практически все, что может делать на веб-сайте законный пользователь. Выполняя произвольный JavaScript в браузере жертвы, XSS позволяет нам выполнять широкий спектр действий, как если бы мы были пользователем-жертвой. Например, мы можем заставить жертву отправить сообщение, принять запрос на добавление в друзья, зафиксировать бэкдор в репозитории исходного кода или перевести немного биткоинов).

Некоторые веб-сайты позволяют вошедшим в систему пользователям менять свой адрес электронной почты без повторного ввода пароля. Если мы обнаружим уязвимость XSS на одном из этих сайтов, то можем воспользоваться ею, чтобы украсть токен CSRF. С помощью токена мы можем изменить адрес электронной почты жертвы на тот, который мы контролируем. Затем мы можем запустить сброс пароля, чтобы получить доступ к учетной записи.

Этот тип эксплойта сочетает XSS (для кражи токена CSRF) с функциональностью, на которую обычно нацелен CSRF. В то время как традиционный CSRF является «односторонней» уязвимостью, когда злоумышленник может заставить жертву отправлять запросы, но не может видеть ответы, XSS обеспечивает «двустороннюю» связь. Это позволяет злоумышленнику как отправлять произвольные запросы, так и читать ответы, что приводит к гибридной атаке, которая обходит защиту от CSRF.

#### Примечание
Токены CSRF неэффективны против XSS, поскольку XSS позволяет злоумышленникам считывать значения токенов непосредственно из ответов.

#### Лаба
[[Лабораторная работа использование XSS для обхода защиты CSRF]]