Некоторые чисто DOM-уязвимости содержатся в пределах одной страницы. Если скрипт считывает данные из URL и записывает их в опасное место, то уязвимость полностью находится на стороне клиента.

Однако источники данных не ограничиваются только теми, которые непосредственно предоставляются браузерами — они также могут происходить с самого сайта. Например, веб-сайты часто отражают параметры URL в HTML-ответе от сервера. Это обычно ассоциируется с обычным XSS, но также может привести к уязвимостям отраженного DOM XSS.

В уязвимости отраженного DOM XSS сервер обрабатывает данные из запроса и возвращает их в ответе. Отраженные данные могут быть помещены в строковый литерал JavaScript или в элемент данных внутри DOM, такой как поле формы. Скрипт на странице затем обрабатывает отраженные данные небезопасным образом, в конечном итоге записывая их в опасное место.
`eval('var data = "reflected string"');`
#### Что такое элемент данных внутри DOM
Элемент данных внутри DOM — это любой элемент, который содержит информацию, которую можно использовать или изменять. Это могут быть текстовые поля, кнопки, заголовки и т.д. Каждый из этих элементов может содержать данные, которые ты можешь извлекать или изменять с помощью JavaScript.

Пример:
Предположим, у нас есть следующий HTML-код:
`<input type="text" id="username" value="Введите имя">`


Здесь `<input>` — это элемент данных, который представляет текстовое поле. Ты можешь получить его значение через JavaScript:
let username = document.getElementById('username').value; // получаем значение из поля ввода



#### Лаба
[[Лабораторная работа Отраженный DOM XSS]]


Веб-сайты также могут хранить данные на сервере и отражать их в другом месте. В уязвимости DOM XSS, хранимой в сохраненном состоянии, сервер получает данные из одного запроса, сохраняет их, а затем включает данные в более поздний ответ. Скрипт в более позднем ответе содержит приемник, который затем обрабатывает данные небезопасным способом.
`element.innerHTML = comment.author`

#### Лаба
[[Лаборатория сохраненный dom xss]]


## Какие стоки могут привести к уязвимостям DOM-XSS?

Ниже приведены некоторые из основных каналов, которые могут привести к уязвимостям DOM-XSS:
```
document.write() 
document.writeln() 
document.domain 
element.innerHTML 
element.outerHTML 
element.insertAdjacentHTML 
element.onevent
```

Следующие функции jQuery также являются стоками, которые могут привести к уязвимостям DOM-XSS:

```
add() 
after() 
append()
animate()
insertAfter()
insertBefore()
before()
html()
prepend()
replaceAll()
replaceWith()
wrap()
wrapInner()
wrapAll()
has()
constructor()
init()
index()
jQuery.parseHTML()
$.parseHTML()
```