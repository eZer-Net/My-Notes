Отраженный XSS — это простейшая разновидность межсайтового скриптинга. Он возникает, когда приложение получает данные в HTTP-запросе и включает эти данные в немедленный ответ небезопасным способом.

#### Пример обнаружения:
Предположим, у нас есть веб-сайт, который принимает поисковые запросы через URL и отображает их на странице. Например, пользователь может ввести запрос в адресной строке браузера:
`https://example.com/search?query=apple`

Сервер обрабатывает этот запрос и возвращает страницу с заголовком:
Результаты поиска для "apple"

Теперь, если веб-приложение не фильтрует входные данные, злоумышленник может создать специальный URL, чтобы выполнить XSS-атаку:
`https://example.com/search?query=<script>alert('XSS!');</script>`

Когда пользователь перейдет по этому URL, сервер вернет страницу с заголовком:
Результаты поиска для `"<script>alert('XSS!');</script>"`


И если браузер не фильтрует этот код, он выполнит JavaScript-код внутри тега `<script>`, и пользователь увидит результаты поиска и всплывающее окно с сообщением "XSS!" 

# Влияние отраженных XSS-атак

Если злоумышленник может контролировать скрипт, который выполняется в браузере жертвы, то он, как правило, может полностью скомпрометировать этого пользователя. Среди прочего, злоумышленник может:
- Выполнять любые действия в приложении, которые может выполнять пользователь.
- Просмотр любой информации, которую пользователь может просматривать.
- Изменять любую информацию, которую пользователь может изменить.
- Инициировать взаимодействие с другими пользователями приложения, включая вредоносные атаки, которые будут исходить от первоначального пользователя-жертвы.

Существуют различные способы, с помощью которых злоумышленник может заставить пользователя-жертву сделать контролируемый им запрос, чтобы осуществить отраженную атаку XSS. 
- Размещение ссылок на веб-сайте
- Отправка ссылки в электронном письме, твите или в ином месте.

Необходимость внешнего механизма доставки для атаки означает, что **воздействие отраженного XSS, как правило, менее серьезно, чем воздействие сохраненного XSS**, когда автономная атака может быть реализована внутри самого уязвимого приложения.

# Отражённый XSS в разных контекстах

Существует множество различных разновидностей отраженного межсайтового скриптинга. ==Расположение отраженных данных в ответе приложения определяет, какой тип полезной нагрузки требуется для его эксплуатации==, а также может повлиять на воздействие уязвимости.

Кроме того, если приложение выполняет какую-либо проверку или иную обработку отправленных данных перед их отражением, это, как правило, влияет на то, какой тип полезной нагрузки XSS необходим.

- #### XSS между тегами HTML
- #### XSS в атрибутах тега HTML
- #### XSS в JavaScript
	Завершение существующего скрипта
	Вырывание строки JavaScript
	Использование HTML-кодирования
	XSS в литералах шаблонов JavaScript
- #### XSS через внедрение шаблона на стороне клиента

### [[Контексты межсайтового скриптинга]]

# Как найти и протестировать отраженные XSS-уязвимости

- #### Тестировать каждую точку входа.
Тестировать отдельно каждую точку входа для данных в HTTP-запросах приложения. Это включает параметры или другие данные в строке запроса URL и теле сообщения, а также путь к файлу URL. Это также включает заголовки HTTP, хотя поведение, подобное XSS, которое может быть вызвано только через определенные заголовки HTTP, может не поддаваться эксплуатации на практике.

- #### Отправлять случайные буквенно-цифровые значения. 
Для каждой точки входа отправить уникальное случайное значение и определите, отражено ли это значение в ответе. **Значение должно быть разработано так, чтобы выдерживать большинство проверок ввода, поэтому оно должно быть достаточно коротким и содержать только буквенно-цифровые символы.** Но оно должно быть достаточно длинным, чтобы случайные совпадения в ответе были крайне маловероятны. Обычно идеальным вариантом является случайное буквенно-цифровое значение из примерно 8 символов. Можем использовать [числовые полезные нагрузки Burp Intruder со случайно сгенерированными шестнадцатеричными значениями для генерации подходящих случайных значений. И вы можете использовать](https://portswigger.net/burp/documentation/desktop/tools/intruder/payloads/types#numbers) [настройки полезных нагрузок grep](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/settings#grep-payloads) Burp Intruder для автоматической пометки ответов, содержащих отправленное значение.

- #### Определите контекст отражения.
Для каждого места в ответе, где отражается случайное значение, определите его контекст. Это может быть текст между тегами HTML, внутри атрибута тега, который может быть заключен в кавычки, внутри строки JavaScript и т. д.

- #### Тестирование потенциальной полезной нагрузки.
На основе контекста отражения протестировать первоначальную потенциально-полезную нагрузку XSS, которая запустит выполнение JavaScript, если она будет отражена в ответе без изменений. Самый простой способ тестирования полезной нагрузки — отправить запрос в [Burp Repeater](https://portswigger.net/burp/documentation/desktop/tools/repeater) , изменить запрос, чтобы вставить потенциально-полезную нагрузку, выполнить запрос, а затем просмотреть ответ, чтобы увидеть, сработала ли полезная нагрузка. Эффективный способ работы — оставить исходное случайное значение в запросе и поместить потенциально-полезную нагрузку XSS до или после него. Затем установите случайное значение в качестве поискового термина в представлении ответа Burp Repeater. Burp выделит каждое место, где появляется поисковый термин, что позволит вам быстро найти отражение.

- #### Тестировать альтернативные полезные нагрузки. 
Если потенциальная полезная нагрузка XSS была изменена приложением или полностью заблокирована, нужно будет протестировать альтернативные полезные нагрузки и методы, которые могут обеспечить рабочую атаку XSS на основе контекста отражения и типа выполняемой проверки входных данных. Для получения более подробной информации см. [[Контексты межсайтового скриптинга|контексты межсайтового скриптинга]]


- #### Протестировать атаку в браузере. 
Наконец, если удастся найти полезную нагрузку, которая, по-видимому, работает в Burp Repeater, перенесите атаку в реальный браузер (вставив URL в адресную строку или изменив запрос в [представлении перехвата Burp Proxy)](https://portswigger.net/burp/documentation/desktop/tools/proxy/intercept-messages) , и посмотрите, действительно ли выполняется внедренный JavaScript. Часто лучше всего выполнить какой-нибудь простой JavaScript, например, `alert(document.domain)`который вызовет видимое всплывающее окно в браузере, если атака будет успешной.