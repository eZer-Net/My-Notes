На сегодняшний день такие атаки возможны во всех основных браузерах. mXSS, или XSS с мутациями представляет собой тип уязвимости межсайтового скриптинга, который использует мутации DOM для обхода фильтров и механизмов защиты от XSS. Эти атаки могут быть особенно сложными для обнаружения и предотвращения, поскольку они exploit'ят особенности обработки HTML и JavaScript браузерами, а не полагаются на традиционные методы инъекций.


#### Как это работает?
Атака mXSS может происходить в результате того, что некоторые механизмы очистки (например, DOMPurify, OWASP AntiSamy или Google Caja) не учитывают все возможные способы интерпретации и выполнения кода в браузере. При этом злоумышленник может использовать неожиданные конструкции HTML для внедрения вредоносного JavaScript-кода.

#### Пример обнаружения

Исследователь безопасности Масато Кинугава продемонстрировал mXSS-уязвимость в библиотеке Closure, используемой в службе Google Search. Он использовал следующий код:
`<noscript><p title="</noscript><img src=x onerror=alert(1)>"">`

1. Изначальный код: Когда этот код загружается в DOM браузера, происходит оптимизация, и он преобразуется в следующий вид:
```
<noscript><p title="</noscript>
<img src="x" onerror="alert(1)">
"">
"
```
   

2. Обработка тегов: Тег `<noscript>` предназначен для отображения контента, когда сценарии отключены. В случае, если сценарии включены, браузер игнорирует содержимое внутри этого тега.

3. Выполнение скрипта: В процессе очистки DOMPurify использует элемент `<template>`, который анализируется, но не отображается, и выполнение скриптов внутри него отключено. Однако после завершения очистки и перехода к реальному отображению в браузере фрагмент `<p title=`" игнорируется, и фрагмент img onerror становится активным. Это приводит к выполнению JavaScript-кода alert(1).