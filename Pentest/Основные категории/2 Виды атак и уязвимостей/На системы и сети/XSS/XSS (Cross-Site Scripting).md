
XSS это внедрение вредоносного JS скрипта на веб-страницу для выполнения в браузерах других пользователей.
[[Инъекции#Межсайтовый скриптинг (XSS) Cross-Site Scripting (XSS)|Входит в OWASP TOP 10]]


### Основные три вида XSS-атаки:
- [[XSS (Cross-Site Scripting)#Хранимый XSS|Хранимые]] (код хранится в базе данных);
- [[XSS (Cross-Site Scripting)#Отраженный XSS|Отраженные]] (код исполняется серверными сценариями и не хранится в базе данных);
- [[XSS (Cross-Site Scripting)#XSS-атака на базе DOM|Через DOM]] (код сохраняется и выполняется в браузере).

Существуют и другие вариации, но именно эти три вида XSS-атак необходимо регулярно отслеживать большинству современных веб-приложений, потому что такие сообщества, как Open Web Application Security Project (OWASP), считают их наиболее распространенными векторами.

---
# [[Хранимый XSS]]

Хранимые XSS-атаки являются наиболее распространенным типом. С точки зрения разработчика хранимый XSS очень прост для понимания. Клиент отправляет вредоносный код на сервер, обычно через HTTP. Сервер обновляет базу данных, и доступ к этому коду появляется у других пользователей, в результате чего он будет выполнен в их браузерах.

Объект, сохраненный в базе данных, могут просматривать многие. При заражении глобального объекта мишенью XSS-атаки могут стать все пользователи.

## [[Хранимый XSS#Как найти и протестировать сохраненные уязвимости XSS|Варианты поиска хранимой xss]]


## [[Хранимый XSS#XSS (**blind XSS**)|XSS (blind XSS)]]

«слепые» XSS (**blind XSS**) — это вариант хранимой XSS. Суть их работы заключается в том, что мы не можем сразу увидеть результат, или результат работы [[Pentest/Термины#Полезная нагрузка (Payload)|пейлоада]] будет выводиться, например, на какой-то другой странице, вроде формы обратной связи или публикации отзывов с предварительной модерацией сообщений. Payolad можно отследить через [[Встроенный инструмент браузера#Специфические форматы данных|поле Payload]]

Главная проблема поиска blind XSS в том, что необходимо учитывать множество контекстов, в которых может выполняться код, например, внутри одинарных или двойных кавычек, различных атрибутов и т.д. Для примера возьмем один и тот же пейлоад и посмотрим, в каких контекстах он может находиться. Исходный пейлоад опять же будет простым `<script>alert(context)</script>`.

- [[Хранимый XSS#Выход за пределы атрибута в одинарных кавычках|Выход за пределы атрибута в одинарных кавычках]]
- [[Хранимый XSS#Выход за пределы атрибута в одинарных и двойных кавычках|Выход за пределы атрибута в одинарных и двойных кавычках]]
- [[Хранимый XSS#Выход за пределы HTML-комментария|Выход за пределы HTML-комментария]]
- [[Хранимый XSS#Выход за пределы элемента `<textarea>`|Выход за пределы элемента `<textarea>`]]
- [[Хранимый XSS#Выход за пределы элемента `<style>`|Выход за пределы элемента `<style>`]]

### [[Хранимый XSS#XSS-полиглоты|XSS-полиглоты]]

### [[Хранимый XSS#От сигнатурного анализа XSS|Обход сигнатурного анализа XSS]]

----
# [[Отраженный XSS]]

Отраженная XSS-атака происходит, когда отправляем специальный код (обычно JavaScript) через URL или форму, и этот код немедленно возвращается пользователю в ответе от сервера. Это значит, что код не сохраняется на сервере, а просто "отражается" обратно.

- [[Отраженный XSS#Пример обнаружения|Пример обнаружения]]

----
# [[XSS-атака на базе DOM]]

Это может быть вариант как хранимой, так и отраженной XSS-атаки, но для выполнения требуются источник и приемник в [[DOM]] браузера. Из-за различий в реализациях DOM некоторые браузеры оказываются уязвимыми, некоторые — нет. Такую XSS-уязвимость гораздо труднее найти и использовать, поскольку для этого требуются глубокие знания DOM и JavaScript.

## [[DOM|Что такое DOM]]

### [[XSS-атака на базе DOM#Как проверить наличие межсайтового скриптинга на основе DOM|Как найти XSS DOM]]


## [[Источники и приемники в сторонних зависимостях]]

Современные веб-приложения обычно создаются с использованием ряда сторонних библиотек и фреймворков, которые часто предоставляют дополнительные функции и возможности для разработчиков. Важно помнить, что некоторые из них также являются потенциальными источниками и стоками для DOM XSS.

## [[DOM XSS в сочетании с отраженными и сохраненными данными]]

Чисто DOM-уязвимости содержатся в пределах одной страницы. Если скрипт считывает данные из URL и записывает их в опасное место, то уязвимость полностью находится на стороне клиента.
#### Интересная лаба
[[Лабораторная работа Отраженный DOM XSS]]

#### [[DOM XSS в сочетании с отраженными и сохраненными данными#Какие стоки могут привести к уязвимостям DOM-XSS?|Какие стоки могут привести к уязвимостям DOM-XSS?]]

----
# [[XSS с мутациями]]

На сегодняшний день такие атаки возможны во всех основных браузерах. mXSS, или XSS с мутациями представляет собой тип уязвимости межсайтового скриптинга, который использует мутации DOM для обхода фильтров и механизмов защиты от XSS. Эти атаки могут быть особенно сложными для обнаружения и предотвращения, поскольку они exploit'ят особенности обработки HTML и JavaScript браузерами, а не полагаются на традиционные методы инъекций.

- [[XSS с мутациями#Как это работает?|Как это работает]]
- [[XSS с мутациями#Пример обнаружения|Пример обнаружения]]

----
# [[Защита от XSS атак|Варианты защиты от XSS]]
# [[Защита от уязвимости на основе DOM-потока]]


----

# Дополнительная информация

[[Pentest/Основные категории/2 Виды атак и уязвимостей/На системы и сети/XSS/Методика поиска и развития уязвимости XSS]]

[Простенькая статья на hackware.ru](https://hackware.ru/?p=1174)

[Документация по XSS атак на GitHub Wiki **Domxss**](https://github.com/wisec/domxsswiki/wiki)

----
# Инструменты
[[Инструмент Burp Suite]] 
[[Инструмент XSSer]]
[[Инструмент XSStrike]]