
Инъекция внешних сущностей XML (также известная как XXE) — это уязвимость веб-безопасности, которая позволяет вмешиваться в обработку XML-данных приложением. Она позволяет просматривать файлы в файловой системе сервера приложений и взаимодействовать с любыми серверными или внешними системами, к которым может получить доступ само приложение.
[[Инъекции#XML external entity (XXE) injection XML (также известная как XXE)|Входит в OWASP TOP 10]] Формат XML используется в протоколе [[Pentest/Термины#Структура современных веб-приложений Разница SOAP протокола от REST API SOAP (Simple Object Access Protocol)|SOAP]] а так же поддерживается в REST

- [[Возникновение XXE уязвимостей|Как же возникают уязвимости XXE?]]

# Существуют различные типы атак XXE:
- [[Примеры эксплуатации#Использование XXE для извлечения файлов|Использование XXE для извлечения файлов]] , где определяется внешняя сущность, включающая содержимое файла, и возвращается в ответе приложения.

- [[Примеры эксплуатации#Использование XXE для проведения SSRF-атак|Использование XXE для выполнения атак SSRF]] , где внешняя сущность определяется на основе URL-адреса внутренней системы.

- [[Слепая XXE|Слепая XXE]] - инъекция которая напрямую не возвращается. [[Пример Blind XXE]].

- [[Слепая XXE#Использование слепого XXE для извлечения данных за пределы канала|Использование скрытого XXE позволяет извлечь данные за пределы канала]] при котором конфиденциальные данные передаются с сервера приложений в систему, контролируемую злоумышленником. 

- [[Слепая XXE#Использование слепого XXE для извлечения данных через сообщения об ошибках|Использование слепого XXE для извлечения данных с помощью сообщений об ошибках]], при котором злоумышленник может вызвать сообщение об ошибке анализа, содержащее конфиденциальные данные.

----
# XXE не только про явные файлы XML, они могут встречаться

- Векторная графика
- Проектные файлы (.csproj, .vcxproj)
- DOCX (архив с xml внутри)
- логи, настройки и тп с XML внутри

----

# Есть разновидности сканеров которые уязвимы
- [[Разбор сканеров по их уязвимостям#Парсеры с явными настройками|Парсеры с явными настройками]]
- [[Разбор сканеров по их уязвимостям#Парсеры с дефолтными настройками|Парсеры с дефолтными настройками]]
- Парсеры из внешних компонентов (внешние либы,компоненты...)

---

# [[Защита от XXE атак|Защита от атак XXE]]

----

# Инструменты
[[Инструмент Burp Suite]]
[PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection) - репозиторий на github
[[Инструмент Zed Attack Proxy (ZAP)]]
[[Инструмент XXEinjector]]

# Дополнительная информация

- [[Методика поиска и развития уязвимости XXE]]
- [OWASP XXE Cheat Sheet](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing)
- [PortSwigger: XXE Exploitation](https://portswigger.net/web-security/xxe)
- [XML External Entity (XXE) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)