Вместо того, чтобы безоговорочно доверять `Content-Type` указанный в запросе, более безопасные серверы пытаются убедиться, что содержимое файла действительно соответствует ожидаемому.

В случае функции загрузки изображения сервер может попытаться **проверить определенные внутренние свойства изображения, такие как его размеры**. Например, если вы попытаетесь загрузить PHP-скрипт, он вообще не будет иметь никаких размеров. Таким образом, сервер может сделать вывод, что это не может быть изображение, и соответственно отклонить загрузку.

Аналогично, некоторые типы файлов всегда могут содержать определенную последовательность байтов в верхнем или нижнем колонтитуле. Их можно использовать как отпечаток пальца или подпись, чтобы определить, соответствует ли содержимое ожидаемому типу. Например, файлы JPEG всегда начинаются с байтов. `FF D8 FF`.

Это гораздо более надежный способ проверки типа файла, но даже он не является надежным. ==Используя специальные инструменты, такие как ExifTool, можно легко создать многоязычный JPEG-файл, содержащий вредоносный код в своих метаданных.==

#### Лаба
[[Лабораторная работа Удаленное выполнение кода через загрузку полиглотной веб-оболочки]]
