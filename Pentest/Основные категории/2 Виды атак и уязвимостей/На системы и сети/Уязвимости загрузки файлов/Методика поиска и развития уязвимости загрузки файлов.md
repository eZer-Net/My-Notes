
# Варианты поиска

Загрузка аватара; Загрузка документов; Загрузка изображений; Загрузка видеофайлов; Загрузка архивов; Загрузка аудиофайлов; Загрузка резервных копий;   Загрузка пользовательских настроек; Загрузка плагинов или расширений; Загрузка шаблонов или тем.

# 1. Использование неограниченной загрузки файлов для развертывания веб-оболочки

- Данные не фильтруются сервером

# 2. Предотвращение выполнения файлов в каталогах, доступных пользователю

- Найти способ загрузить сценарий в другой каталог, который не должен содержать файлы, предоставленные пользователем, сервер может выполнить там сценарий.
- Использовать "Обход пути"

# 3. Недостаточный черный список опасных типов файлов

#### 3.1 менее известные альтернативные расширения файлов

1. .php4 — старая версия PHP, которая может быть обработана сервером.
2. .phtml — еще одно расширение для PHP-файлов.
3. .phar — архивы PHP, которые могут содержать исполняемый код.
4. .cgi — файлы, исполняемые через Common Gateway Interface.
5. .asp — файлы, исполняемые на серверах с поддержкой Active Server Pages.
6. .aspx — файлы для ASP.NET, которые могут содержать исполняемый код.
7. .jsp — JavaServer Pages, которые также могут содержать исполняемый код.
8. .pl — Perl-скрипты, которые могут быть выполнены на сервере.
9. .rb — Ruby-скрипты, которые могут быть обработаны сервером.
10. .wsf — Windows Script Files, содержащие скрипты на различных языках.
11. .html или .htm с внедрением JavaScript для выполнения кода через браузер.
12. .json или .xml с возможностью включения скриптов через XSS.

#### 3.2 Переопределение конфигурации сервера
Серверы обычно не будут выполнять файлы, если они не настроены для этого.

- **Внедрить файл конфигурации**
	Загрузить файл, который изменяет настройки сервера для выполнения кода.
	
	• Apache: Для изменения настроек на сервере Apache можно использовать файл .htaccess, который обычно находится в корневом каталоге веб-приложения. Для более глобальных изменений можно редактировать основной файл конфигурации, который обычно находится по пути `/etc/apache2/apache2.conf` или `/etc/httpd/conf/httpd.conf`, в зависимости от дистрибутива Linux.
   
   • IIS: В случае с IIS используется файл web.config, который также размещается в корневом каталоге веб-приложения. Основные настройки IIS могут быть изменены через интерфейс управления IIS или редактированием файла applicationHost.config, который обычно находится по пути `C:\Windows\System32\inetsrv\config\applicationHost.config`

- **Добавление MIME-типов**
	Чтобы сервер правильно обрабатывал файлы с нестандартными расширениями, необходимо добавить соответствующие MIME-типы. Это позволяет серверу знать, как обрабатывать файлы определенного типа.

- **Запутывающие расширения файлов**
	Несколько расширений; Добавить конечные символы;  Кодировка URL-адреса; Точки с запятой или нулевые байтовые символы; Многобайтовые символы Юникода.

- **Защиты включают в себя разделение или замену опасных расширений**, чтобы предотвратить выполнение файла. 
	Если это преобразование не применяется рекурсивно, можно позиционировать запрещенную строку таким образом, чтобы удалить ее по -прежнему оставляет действительное расширение файла. Например, если мы разделяеи `.php` из следующего имени файла: 
	`exploit.p.`**php**`hp`

#### 3.3 Неверная проверка содержимого файла

- **Использовать специальные инструменты, такие как ExifTool** которые могут добавить полезную нагрузку в различные типы файлов