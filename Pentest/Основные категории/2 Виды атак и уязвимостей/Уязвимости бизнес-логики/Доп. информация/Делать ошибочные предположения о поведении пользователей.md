
Одной из наиболее распространенных причин логических уязвимостей являются ошибочные предположения о поведении пользователей.

### Доверенные пользователи не всегда остаются заслуживающими доверия

Приложения могут показаться безопасными, поскольку они реализуют, казалось бы, надежные меры по обеспечению соблюдения бизнес-правил. К сожалению, некоторые приложения допускают ошибку, полагая, что, пройдя этот строгий контроль изначально, пользователю и его данным можно доверять бесконечно. С этого момента это может привести к относительно слабому обеспечению соблюдения тех же мер контроля.

### Пользователи не всегда предоставляют обязательную информацию

Одно из заблуждений заключается в том, что пользователи всегда будут указывать значения для обязательных полей ввода.

Это особая проблема в тех случаях, когда в одном серверном скрипте реализовано несколько функций. В этом случае наличие или отсутствие определенного параметра может определить, какой код будет выполнен. Удаление значений параметров может позволить злоумышленнику получить доступ к путям кода, которые должны быть недоступны.

При поиске логических ошибок вам следует попробовать удалить каждый параметр по очереди и посмотреть, какое влияние это окажет на ответ. Вы должны убедиться:

- Удаляйте только один параметр за раз, чтобы обеспечить доступ ко всем соответствующим путям кода.
- Попробуйте удалить имя параметра, а также его значение. Сервер обычно обрабатывает оба случая по-разному.
- Следуйте многоэтапным процессам до их завершения. Иногда изменение параметра на одном этапе может повлиять на другой этап рабочего процесса.

Это относится как к URL, так и к `POST` параметры, но не забудьте также проверить куки. Этот простой процесс может выявить странное поведение приложения, которое можно использовать.


### Пользователи не всегда следуют намеченной последовательности

Многие транзакции основаны на заранее определенных рабочих процессах, состоящих из последовательности шагов. Веб-интерфейс обычно помогает пользователям пройти через этот процесс, переводя их на следующий этап рабочего процесса каждый раз, когда они завершают текущий. Однако злоумышленники не обязательно будут придерживаться этой намеченной последовательности. Игнорирование этой возможности может привести к опасным уязвимостям, которыми сравнительно легко воспользоваться.

Предположения о последовательности событий могут привести к широкому кругу проблем даже в рамках одного и того же рабочего процесса или функциональности. Используя такие инструменты, как Burp Proxy и Repeater, как только злоумышленник увидит запрос, он может воспроизвести его по своему желанию и использовать принудительный просмотр для выполнения любых взаимодействий с сервером в любом порядке. Это позволяет им выполнять различные действия, пока приложение находится в неожиданном состоянии.

==Чтобы выявить подобные недостатки, следует использовать принудительный просмотр для отправки запросов в непредусмотренной последовательности.== Например, можно пропустить определенные шаги, получить доступ к одному шагу более одного раза, вернуться к предыдущим шагам и т. д. Обратить внимание на то, как осуществляется доступ к различным шагам. Хотя вы часто просто отправляете `GET` или `POST` запросить определенный URL-адрес, иногда вы можете получить доступ к шагам, отправив разные наборы параметров на один и тот же URL-адрес. Как и в случае со всеми логическими ошибками, попытайтесь определить, какие предположения сделали разработчики и где находится поверхность атаки. Затем вы можете искать способы нарушения этих предположений.

Обратите внимание, что этот вид тестирования часто вызывает исключения, поскольку ожидаемые переменные имеют нулевые или неинициализированные значения. Прибытие в местоположение в частично определенном или противоречивом состоянии также может привести к возникновению жалоб приложения. В этом случае обязательно ==обращать пристальное внимание на любые сообщения об ошибках или отладочную информацию, с которой сталкиваемся==. Они могут стать ценным источником раскрытия информации, который поможет точно настроить атаку и понять ключевые детали поведения серверной части.

#### Например
многие веб-сайты, реализующие двухфакторную аутентификацию (2FA), требуют, чтобы пользователи вошли в систему на одной странице, прежде чем вводить код подтверждения на отдельной странице. Если предположить, что пользователи всегда будут следовать этому процессу до завершения и, как следствие, не проверять его, это может позволить злоумышленникам полностью обойти этап 2FA.